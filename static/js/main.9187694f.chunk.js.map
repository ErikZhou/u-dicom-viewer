{"version":3,"sources":["components/AboutDlg.js","fs/fs.js","functions.js","constants/settings.js","actions/index.js","components/Dicomdir.js","constants/uids.js","components/OpenUrlDlg.js","components/CinePlayer.js","db/db.js","LinearAlgebra/utils.js","LinearAlgebra/constants.js","LinearAlgebra/Matrix.js","LinearAlgebra/Vector.js","LinearAlgebra/Point.js","LinearAlgebra/Line.js","DicomGeometry/DicomGeometry.js","components/DicomViewer.js","components/DicomHeader.js","components/DownloadZipDlg.js","components/DicomPreviewer.js","components/Explorer.js","components/OpenMultipleFilesDlg.js","components/FsUI.js","components/Histogram.js","components/LayoutTool.js","components/ToolsPanel.js","components/MeasureItem.js","components/Measurements.js","components/Settings.js","App.js","serviceWorker.js","store/index.js","reducers/index.js","index.js"],"names":["AboutDlg","onClose","linkRepository","Typography","variant","Link","href","target","style","color","version","packageJson","Dialog","open","DialogTitle","disableTypography","DialogContent","List","ListItem","ListItemText","primary","secondary","DialogActions","Button","autoFocus","onClick","fs","Dexie","stores","files","getDicomStudyId","image","value","data","string","undefined","getDicomIpp","index","ipp","split","parseFloat","getDicomEchoNumber","getDicomSliceLocation","groupBy","list","keyGetter","map","Map","forEach","item","key","collection","get","push","set","isInputDirSupported","tmpInput","document","createElement","isUrlImage","url","match","isFileImage","file","includes","isFsFileImage","fsItem","console","log","type","toLowerCase","getFileNameCorrect","filename","isAndroid","isFirefox","getFileExt","getFileName","ext","exec","getFileExtReal","name","replace","getSettingsSaveInto","saveInto","localStorage","getItem","setItem","getSettingsOverlay","overlay","getSettingsFsView","view","isMobile","isTablet","getSettingsDicomdirView","getSettingsMprInterpolation","method","toCsvValue","theValue","t","String","fsFileStore","fsFile","filesStore","dcmIsOpen","dcmTool","tool","activeDcm","dcm","activeMeasurements","measurements","explorerActiveSeriesIndex","setZippedFile","fsZippedFile","setDcmEnableTool","dcmEnableTool","styleScrollbar","height","ExpandIcon","expanded","Dicomdir","props","state","buildData","id","output","images","series","study","patient","slice","reverse","obj","i","unshift","path","number","children","setState","buildOutput","dataset","elements","x00041220","items","e","dcmTime","dcmDate","toString","dataSet","Date","substring","toLocaleDateString","year","month","day","pop","openDicomdir","reader","FileReader","onload","arrayBuffer","result","byteArray","Uint8Array","dicomParser","err","readAsArrayBuffer","openDicomdirFs","find","x","dicomdir","origin","onOpenFile","components","fsCurrentDir","parent","join","where","first","setFsFileStore","onOpenFs","studyText","this","classes","styleComponent","marginTop","width","button","listItemText","Collapse","in","dense","className","PureComponent","connect","dispatch","withStyles","theme","paddingLeft","spacing","fontSize","uids","OpenUrlDlg","hide","cancel","window","stop","aria-labelledby","LinearProgress","progress","CinePlayer","firstframe","runCinePlayer","previousframe","play","pause","nextframe","lastframe","inPlay","IconButton","mdiPause","size","mdiPlay","margin","mdiSkipBackward","mdiSkipPrevious","mdiSkipNext","mdiSkipForward","db","measurement","areEqual","one","other","epsilon","Math","abs","sum","arr","reduce","acc","withoutElementAtIndex","Matrix","rows","j","_","r","func","newRows","row","element","componentWiseOperation","a","b","length","Error","columns","column","parts","coef","matrixRows","determinant","dimension","zeros","Array","fill","__","pow","minor","cofactor","transpose","adjugate","scaleBy","Vector","hypot","v","component","round","zero","xabs","yabs","zabs","y","z","n","Point","sqrt","Line","p1","p2","m","c","distance","line","d","isNaN","DicomGeometry","iop","pixelSpacing","spacingY","spacingX","cols","lengthX","lengthY","rowDir","colDir","nrmDir","crossProduct","topLeft","topRight","add","mul","bottomLeft","bottomRight","sub","transformImageToRcs","transformRcsToImage","inverse","p","orientation","scrollToIndex","csTools","cornerstoneTools","cornerstone","cornerstoneMath","cornerstoneFileImageLoader","cornerstoneWebImageLoader","cornerstoneWADOImageLoader","Hammer","globalToolSyncEnabled","DicomViewer","visibleOpenUrlDlg","visibleCinePlayer","errorOnOpenImage","errorOnCors","frame","viewport","handlerMouseScroll","shouldScroll","deltaY","listOpenFilesNextFrame","listOpenFilesPreviousFrame","onOpenUrl","eventData","detail","percentComplete","showOpenUrlDlg","addEventListener","loadImage","hideOpenUrlDlg","measurementSave","measure","measurementClear","splice","measurementRemove","getTransferSyntax","getSopClass","getSopInstanceUID","getPixelRepresentation","uint16","getPlanarConfiguration","getDicomViewerElement","getElementsByClassName","onImageLoaded","onLoadedImage","onImageRendered","str","getElementById","textContent","mprIsOrthogonalView","mprPlane","charAt","toUpperCase","PatientsName","displayedArea","brhc","voi","windowWidth","windowCenter","scale","toFixed","referenceLines","isScoutDraw","referenceLinesDraw","mpr","isSliceLocation","mprSliceLocationDraw","isDicom","numberOfFrames","onRenderedImage","onMeasurementModified","onMeasurementAdded","note","measurementData","setActiveMeasurements","onMeasurementCompleted","setTimeout","onErrorOpenImageClose","onErrorCorsClose","updateImage","dicomImage","displayImageFromFiles","imageId","sliceIndex","onNewImage","sopInstanceUid","stack","currentImageIdIndex","imageIds","intString","mprPlanePosition","enableTool","equals","each","runTool","then","setActiveDcm","setIsOpenStore","loadImageFromCanvas","canvas","addCanvas","loadImageFromCustomObject","pixelData","customObj","originImage","addCustom","localfile","localurl","isOpenStore","addBuffer","fileManager","error","pos","indexOf","toolName","mouseButtonNumber","WwwcTool","LengthTool","PanTool","ZoomTouchPinchTool","ZoomTool","ProbeTool","EllipticalRoiTool","RectangleRoiTool","FreehandRoiTool","AngleTool","MagnifyTool","StackScrollMouseWheelTool","setDcmEnableToolStore","disableAllTools","opt","sliceMax","mouseButtonMask","isTouchActive","invert","activeDcmIndex","zoom","myCanvas","cropCanvas","toDataURL","download","body","appendChild","click","blobUtil","blob","newName","counter","done","fsCurrentList","transaction","byteLength","makeFsRefresh","reset","delete","sopinstanceuid","newCanvas","getContext","drawImage","changeTool","cmdName","defaultViewport","imageOrientation","matrix","Object","keys","colNumber","rowNumber","mprRenderYZPlane","mprData","volume","xSize","ySize","zSize","zDim","xoffset","floor","plane","Int16Array","yzPlane","mprBuildYZPlane","mprRenderXZPlane","trunc","xzPlane","mprBuildXZPlane","layout","mprSliceLocation","sliceLocation","from","p0","zStep","p3","start","ctxH","beginPath","setLineDash","strokeStyle","moveTo","lineTo","lineWidth","stroke","referenceLinesBuild","srcImage","dst","src","isReferenceLine","referenceLinesBuildLine","nP","dotProduct","nA","nB","nC","nD","startPoint","transformDstPatientPointToImage","endPoint","transformed","multiply","referenceLinesBuildPlane","pixel","rotation","toArray","toMatrix","max","line0","line1","line2","line3","min","dicomImageRef","el","onImageClick","isLocalizer","values","findFirstSliceWithIppValue","ippValue","ippPos","increasing","sliceDistance","explorerIndex","layoutIndex","dcmRef","previousProps","isOpen","visible","styleContainer","border","position","DialogContentText","aria-describedby","gutterBottom","textShadow","visibility","onContextMenu","ref","top","left","display","right","bottom","marginLeft","marginRight","textAlign","backgroundColor","React","Component","clearingStore","toolStore","DicomHeader","dcmViewer","header","minPixelValue","maxPixelValue","listItems","Toolbar","title","grow","exportAs","fileData","objArray","cDelimiter","l","nl","names","sDelimiter","hasOwnProperty","toCsv","o","JSON","stringify","Blob","URL","createObjectURL","mdiContentSaveOutline","source","axios","CancelToken","DownloadZipDlg","loading","requestDownloadZip","responseType","cancelToken","token","onDownloadProgress","progressEvent","percentCompleted","loaded","total","response","setFsZippedFile","catch","DicomPreviewer","getSeriesNumber","seriesList","seriesKeys","seriesNumber","getSeriesLength","getSeriesDescription","seriesDescription","padding","styleDicomViewerStack","styleDicomViewer","Explorer","patientName","explorer","studies","seriesActiveIndex","setDcmViewer","dicomViewersRefs","getDcmViewerRef","getDcmViewer","dicomViewers","buildPreviewStack","dicomviewers","previewStackClick","onTouchStart","previewStackTouch","gridTemplateRows","gridTemplateColumns","handlePatientChange","event","patientIndex","filesListForPatient","allFiles","filter","studyList","studyDateTime","studyKeys","setSeriesStore","setExplorerActivePatientIndex","handleStudyChange","studyIndex","studyDate","studyDescription","setExplorerActiveSeriesIndex","onSelectSeries","clear","explorerActivePatientIndex","explorerActiveStudyIndex","seriesIndex","sort","FormControl","formControl","InputLabel","Select","selectText","labelId","onChange","MenuItem","menuItemText","setFilesStore","setExplorer","setExplorerActiveStudyIndex","seriesStore","minWidth","selectEmpty","OpenMultipleFilesDlg","close","count","step","nextProgress","t0","performance","now","getDicomPatientName","studyId","getDicomStudyDate","studyTime","getDicomStudyTime","getDicomStudyDescription","seriesDate","getDicomSeriesDate","seriesTime","getDicomSeriesTime","getDicomSeriesDescription","getDicomSeriesNumber","instanceNumber","getDicomInstanceNumber","topLeftCorner","dist","getDicomSliceDistance","echoNumber","getDicomColumns","getDicomRows","dateTime","date","time","localeDate","dicomDateTimeToLocale","t1","FsUI","textFieldLabel","textFieldValue","selected","selectedCopy","visibleTextField","visibleDeleteDlg","visibleOthers","visibleAlreadyExistDlg","visibleOSaveAsDlg","visibleWaiting","visibleOpenMultipleFilesDlg","doSelectUnselect","newSelected","openSelectedFilesRetrieveItems","startsWithIgnoreCase","openSelectedFiles","hideOpenMultipleFilesDlg","onOpenMultipleFilesCompleted","onOpenImage","createDir","renameItem","lastSelected","previousDir","nextDir","setCurrentDir","fsListDir","confirmText","oldParent","fsBuildParent","newParent","fsCreateDir","cancelDir","saveItem","localFileStore","buffer","copyItem","newSelectedCopy","cutItem","cut","pasteItem","deleteItem","showOthers","exportItem","itemClick","selectedIndex","concat","itemDoubleClick","onOpenDicomdir","onOpen","showDeleteDlg","hideDeleteDlg","confirmDeleteDlg","hideAlreadyExistDlg","hideSaveAs","closeSaveAs","saveAsField","zip","JSZip","folder","generateAsync","saveAs","mouseDown","timer","mouseUp","clearTimeout","itemsCount","createRef","loadAsync","contents","relativePath","zipEntry","dir","async","content","fsAddItem","put","create","sortBy","and","setCurrentList","totalItemsCount","Paper","textPaper","InputBase","textInput","placeholder","defaultValue","textButton","mdiCheck","mdiClose","leftButtons","CircularProgress","Tooltip","mdiChevronLeft","toolbarButtons","mdiCheckBoxOutline","mdiFolderOutline","mdiFolderPlusOutline","mdiSquareEditOutline","mdiDotsHorizontal","mdiContentCut","mdiContentCopy","mdiContentPaste","mdiDeleteOutline","mdiExportVariant","float","TableContainer","Table","table","TableHead","TableRow","TableCell","align","TableBody","isItemSelected","role","hover","onDoubleClick","onTouchEnd","onMouseDown","onMouseUp","scope","tableCellText","bytes","decimals","k","dm","sizes","formatBytes","TextField","inputRef","input","fullWidth","localFile","fsRefresh","setFsCurrentDir","setFsCurrentList","alignItems","flex","styleSlider","styleCanvasGradient","styleTable","borderCollapse","fontFamily","styleTableTd","tableLayout","Histogram","activeDrags","deltaPosition","controlledPosition","histCount","valueScale","minHist","maxHist","mean","stdDev","indexDcm","handleChangeValue","newValue","binSize","hist256","onDrag","ui","deltaX","onStart","onStop","canvasHistogram","canvasGradient","canvasH","current","translate","updateCanvas","evt","rect","getBoundingClientRect","clientX","clientY","getPixelData","storedPixelData","spIndex","red","green","blue","alpha","getRGBPixelsImage","getPixelsImage","intercept","lenHist","zero256","stepWW","stepWC","hist","mo","getPixel","slope","s","binStep","iHist","clearRect","mousePos","getMousePos","fillStyle","fillRect","h","lowX","highX","ctxG","grd","createLinearGradient","addColorStop","cursor","Slider","LayoutTool","initTable","col","tableRef","cells","bgColor","cellClick","parentNode","rowIndex","cellIndex","renderTable","ToolsPanel","colorIcon","toolActive","toolExecute","mdiCursorDefault","mdiArrowSplitHorizontal","mdiVectorLink","seriesLink","mdiArrowAll","mdiCursorPointer","mdiMagnify","mdiCheckboxIntermediate","mdiRuler","mdiEyedropper","mdiAngleAcute","mdiEllipse","mdiRectangle","mdiGesture","MeasureItem","visibleDlgNote","visibleDlgDelete","showDlgNote","hideDlgNote","showDlgDelete","hideDlgDelete","handleOnChangeNote","confirmNote","noteField","confirmDelete","toolRemove","onEdit","onDelete","pText","sText","unit","rAngle","cachedStats","area","meanStdDev","edge","Measurements","visibleClearMeasureDlg","showClearMeasureDlg","hideClearMeasureDlg","confirmClearMeasureDlg","useStyles","makeStyles","appBar","formLabel","radioControl","Settings","getSettingsSaveAs","getSettingsDcmHeader","fsView","dicomdirView","mprInterpolation","useState","fullScreen","AppBar","elevation","aria-label","FormControlLabel","control","Checkbox","checked","label","FormLabel","RadioGroup","Radio","App","anchorElLayout","anchorElToolsPanel","openMenu","openImageEdit","openTools","mprMenu","mprMode","textMessage","titleMessage","visibleMainMenu","visibleHeader","visibleSettings","visibleToolbar","visibleOpenUrl","visibleToolbox","visibleTools","visibleMeasure","visibleAbout","visibleDicomdir","visibleFileManager","visibleZippedFileDlg","visibleDownloadZipDlg","toolState","listOpenFilesScrolling","visibleVolumeBuilding","visibleMprOrthogonal","visibleMprCoronal","visibleMprSagittal","visibleMprAxial","visibleExplorer","visibleMessage","visibleReferenceLines","visibleSeriesLink","dicomViewersRef","crossViewer","isSliceChange","referenceLinesShow","getActiveDcmViewer","handleOpenLocalFs","filesSelected","changeLayout","setLocalFileStore","handleOpenSandboxFs","handleOpenImage","isArray","getOwnPropertyNames","activeDcmViewersNum","getActiveDcmViewers","getActiveDcmViewersSameStudy","getActiveDcmViewersSamePlane","dicomViewersActive","handleOpenFileDicomdir","handleOpenFolder","handleOpenFolderDo","webkitRelativePath","handleOpenDicomdir","datafiles","setDicomdirStore","toggleDicomdir","handleOpenFsDicomdir","showAppBar","scrollTo","toggleMainMenu","showMainMenu","hideMainMenu","handleVisibility","toggleFileManager","toggleExplorer","toggleHeader","toggleToolbox","saveMeasure","toggleMeasure","hideMeasure","handleVisibilityMeasure","clearMeasure","showZippedFileDlg","hideZippedFileDlg","confirmZippedFileDlg","showAbout","showSettings","hideSettings","handleVisibilitySettings","hideDownloadZipDlg","openMultipleFilesCompleted","patientList","patientKeys","showOpenUrl","hideOpenUrl","openDlg","openUrlField","downloadOpenUrl","resetImage","saveShot","cinePlayer","handleLayout","currentTarget","closeLayout","layoutGridClick","isMultipleFiles","setLayoutStore","handleToolsPanel","closeToolsPanel","referenceLinesToggle","seriesLinkToggle","toolChange","toggleOpenMenu","toggleImageEdit","toggleTools","toggleMpr","setActiveDcmIndex","scoutViewer","layoutGridTouch","buildLayoutGrid","styleLayoutGrid","getStringVisiblePlane","appBarTitle","crossMprPlane","openViewers","referenceLinesHide","getImageOrientationZ","mprBuildVolume","xPixelSpacing","getDicomPixelSpacing","spacingBetweenSlice","getDicomSpacingBetweenSlice","sliceThickness","getDicomSliceThickness","zDimMethod2","len","emptyPlane","order","iFile","previous","object","intervals","ceil","interpolationMethod","w","changeToOrthogonalView","changeToSagittalView","changeToCoronalView","changeToAxialView","xzIndex","yzIndex","force","mprOrthogonal","to","mprSagittal","mprCoronal","mprAxial","listOpenFilesFirstFrame","syncActiveDcmViewersSamePlane","listOpenFilesLastFrame","scrolling","clearInterval","timerScrolling","setInterval","handleSliceChange","explorerOnSelectSeries","dicomViewersActiveSameStudy","dicomViewersActiveSamePlane","direction","ippX","ippY","ippZ","fileOpen","showFileOpen","bind","showOpenDicomdir","openFolder","showOpenFolder","primaryClass","isDicomdir","visibleLayout","Boolean","visibleToolsPanel","menuButton","mdiInformationOutline","mdiVideo","mdiRefresh","mdiTools","mdiCamera","mdiFileCad","mdiFileDocument","mdiFolderOpen","mdiAnimationOutline","mdiFileCabinet","Drawer","zIndex","toolbar","ListItemIcon","mdiFolderMultiple","timeout","unmountOnExit","mdiFolder","mdiWeb","mdiDelete","mdiViewGridPlusOutline","mdiCog","Divider","disabled","mdiChartHistogram","mdiAxisArrow","mdiImageEdit","mdiInvertColors","anchor","mdiTrashCanOutline","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","Snackbar","autoHideDuration","message","multiple","webkitdirectory","mozdirectory","directory","setLayout","setDicomdir","setVolumeStore","palette","common","black","flexGrow","root","drawer","transition","transitions","easing","sharp","duration","leavingScreen","appBarShift","enteringScreen","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","mixins","isLocalhost","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","initialState","store","createStore","action","__REDUX_DEVTOOLS_EXTENSION__","WebFontLoader","load","google","families","createMuiTheme","overrides","MuiFormControlLabel","MuiFormLabel","main","ReactDOM","render","process","fetch","contentType","headers","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.9187694f.chunk.js","sourcesContent":["import React from 'react'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport Link from '@material-ui/core/Link'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport packageJson from '../../package.json'\r\n\r\nconst AboutDlg = ({ onClose }) => {\r\n\r\n    const urlRepository = \"https://github.com/webnamics/u-dicom-viewer/\"\r\n\r\n    const linkRepository = (\r\n        <Typography variant='body2'>\r\n            <Link \r\n                href={urlRepository} \r\n                target='_blank'\r\n                style={{ color: '#999999' }}\r\n            >\r\n                https://github.com/webnamics/u-dicom-viewer\r\n            </Link>\r\n        </Typography>\r\n    )\r\n\r\n    const version = (\r\n        <Typography variant='body2' style={{ color: '#999999' }}>\r\n            {packageJson.version}\r\n        </Typography>        \r\n    )\r\n\r\n    return (\r\n      <div>\r\n        <Dialog onClose={onClose} open={true}>\r\n            <DialogTitle onClose={onClose} disableTypography={true}>\r\n                <Typography variant='h6'>\r\n                    About <strong>U</strong> <strong>D</strong>icom <strong>V</strong>iewer\r\n                </Typography>\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <List>\r\n                    <ListItem>\r\n                        <ListItemText \r\n                            primary='Repository URL:' \r\n                            secondary={linkRepository} \r\n                        />\r\n                    </ListItem>    \r\n                    <ListItem>\r\n                        <ListItemText \r\n                            primary='Version:' \r\n                            secondary={version} \r\n                        />\r\n                    </ListItem>                        \r\n                </List>        \r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button autoFocus onClick={onClose}>\r\n                    Close\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default AboutDlg\r\n","import Dexie from 'dexie'\r\n\r\nconst fs = new Dexie('fsDB')\r\n\r\nfs.version(1).stores({ \r\n    files: '[parent+name], parent, name, type' \r\n})\r\n\r\nfs.open()\r\n\r\nexport default fs\r\n","import { \r\n    isAndroid,\r\n    isFirefox,\r\n    isMobile, \r\n    isTablet \r\n  } from 'react-device-detect'\r\nimport { \r\n    SETTINGS_SAVEAS, \r\n    SETTINGS_SAVEINTO,\r\n    SETTINGS_DCMHEADER, \r\n    SETTINGS_OVERLAY, \r\n    SETTINGS_MEASUREMENT,\r\n    SETTINGS_FSVIEW,\r\n    SETTINGS_DICOMDIRVIEW,    \r\n    SETTINGS_MPRINTERPOLATION,\r\n} from './constants/settings'\r\n\r\n\r\n// ---------------------------------------------------------------------------------------------- DICOM\r\n//#region DICOM\r\n\r\nexport function getDicomPatientName(image) {\r\n    const value = image.data.string('x00100010')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\r\n\r\nexport function getDicomStudyId(image) {\r\n    if (image === null) return null\r\n    const value = image.data.string('x00200010')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomStudyDate(image) {\r\n    const value = image.data.string('x00080020')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomStudyTime(image) {\r\n    const value = image.data.string('x00080030')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomStudyDescription(image) {\r\n    const value = image.data.string('x00081030')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomSeriesDate(image) {\r\n    const value = image.data.string('x00080021')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomSeriesTime(image) {\r\n    const value = image.data.string('x00080031')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomSeriesDescription(image) {\r\n    const value = image.data.string('x0008103e')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\r\n\r\nexport function getDicomSeriesNumber(image) {\r\n    const value = image.data.string('x00200011')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return parseFloat(value)\r\n}\r\n\r\nexport function getDicomModality(image) {\r\n    const value = image.data.string('x00080060')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\r\n\r\nexport function getDicomIpp(image, index) {\r\n    const value = image.data.string('x00200032')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    const ipp = value.split('\\\\')\r\n    return parseFloat(ipp[index])\r\n}\r\n\r\nexport function getDicomFrameOfReferenceUID(image) {\r\n    const value = image.data.string('x00200052')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\r\n\r\nexport function getDicomPixelSpacing(image, index) {\r\n    const value = image.data.string('x00280030')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    const pixelSpacing = value.split('\\\\')\r\n    return pixelSpacing[index]\r\n}\r\n\r\nexport function getDicomSpacingBetweenSlice(image) {\r\n    const value = image.data.string('x00180088')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return parseFloat(value)\r\n}\r\n\r\nexport function getDicomSliceThickness(image) {\r\n    const value = image.data.string('x00180050')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return parseFloat(value)\r\n}\r\n\r\nexport function getDicomEchoNumber(image) {\r\n    const value = image.data.string('x00180086')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return parseFloat(value)\r\n}\r\n\r\nexport function getDicomSliceLocation(image) {\r\n    const value = image.data.string('x00201041')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return parseFloat(value)\r\n}\t\r\n\r\nexport function getDicomInstanceNumber(image) {\r\n    const value = image.data.string('x00200013')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value\r\n}\t\r\n\r\nexport function getDicomRows(image) {\r\n    const value = image.data.uint16('x00280010')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value    \r\n}\r\n\r\nexport function getDicomColumns(image) {\r\n    const value = image.data.uint16('x00280011')\r\n    if (value === undefined) {\r\n        return\r\n    }\r\n    return value    \r\n} \r\n\r\nexport function isLocalizer(image) {\r\n    const values = image.data.string('x00080008').split('\\\\')\r\n    console.log('Localizer: ', values)\r\n    return values.length === 3 && values[2] === 'LOCALIZER'\r\n}\r\n\r\n// see https://stackoverflow.com/questions/37730772/get-distance-between-slices-in-dicom\r\n//\r\nexport function getDicomSliceDistance(image) {\r\n    try {\r\n        const ipp = image.data.string('x00200032').split('\\\\') // Image Position Patient\r\n        //console.log(\"imagePosition: \", ipp)\r\n        let topLeftCorner = new Array(3).fill(0)\r\n        topLeftCorner[0] = parseFloat(ipp[0]) // X pos of frame (Top left) in real space\r\n        topLeftCorner[1] = parseFloat(ipp[1]) // Y pos of frame (Top left) in real space\r\n        topLeftCorner[2] = parseFloat(ipp[2]) // Z pos of frame (Top left) in real space\r\n        //console.log(\"topLeftCorner: \", topLeftCorner)\r\n\r\n        const iop = image.data.string('x00200037').split('\\\\') // Image Orientation Patient\r\n        //console.log(\"values: \", iop)\r\n        let v = new Array(3).fill(0).map(() => new Array(3).fill(0))\r\n\r\n        v[0][0] = parseFloat(iop[0]) // the x direction cosines of the first row X\r\n        v[0][1] = parseFloat(iop[1]) // the y direction cosines of the first row X\r\n        v[0][2] = parseFloat(iop[2]) // the z direction cosines of the first row X\r\n        v[1][0] = parseFloat(iop[3]) // the x direction cosines of the first column Y\r\n        v[1][1] = parseFloat(iop[4]) // the y direction cosines of the first column Y\r\n        v[1][2] = parseFloat(iop[5]) // the z direction cosines of the first column Y \r\n\r\n        // calculate the slice normal from IOP\r\n        v[2][0] = v[0][1] * v[1][2] - v[0][2] * v[1][1]\r\n        v[2][1] = v[0][2] * v[1][0] - v[0][0] * v[1][2]\r\n        v[2][2] = v[0][0] * v[1][1] - v[0][1] * v[1][0]\r\n        \r\n        //console.log(\"slice normal from IOP: \", v[2])\r\n\r\n        let dist = 0\r\n        for (let i = 0; i < 3; ++i) \r\n            dist += v[2][i] * topLeftCorner[i]\r\n        \r\n        return dist\r\n    } catch(error) {\r\n        return 0\r\n    }\r\n}\r\n\r\nexport function dicomDateToLocale(dcmDate) {\r\n    const date = new Date(dcmDate.substring(0, 4)+'-'+dcmDate.substring(4, 6)+'-'+dcmDate.substring(6))\r\n    const localeDate = date.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' })\r\n    return localeDate\r\n}\r\n\r\nexport function dicomTimeToStr(dcmTime) {\r\n    const time = dcmTime.substring(0, 2)+':'+dcmTime.substring(2, 4)+':'+dcmTime.substring(4, 6)\r\n    return time\r\n}\r\n\r\nexport function dicomDateTimeToLocale(dateTime) {\r\n    const date = new Date(dateTime.substring(0, 4)+'-'+dateTime.substring(4, 6)+'-'+dateTime.substring(6, 8))\r\n    const time = dateTime.substring(9, 11)+':'+dateTime.substring(11, 13)+':'+dateTime.substring(13, 15)\r\n    const localeDate = date.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' })\r\n    return `${localeDate} - ${time}`\r\n}\r\n\r\n//#endregion  \r\n\r\nexport function groupBy(list, keyGetter) {\r\n    const map = new Map()\r\n    list.forEach((item) => {\r\n        const key = keyGetter(item)\r\n        const collection = map.get(key)\r\n        if (!collection) {\r\n            map.set(key, [item])\r\n        } else {\r\n            collection.push(item)\r\n        }\r\n    })\r\n    return map\r\n}\r\n\r\nexport function objectIsEmpty(obj) {\r\n    if (obj === null || obj === undefined || Array.isArray(obj) || typeof obj !== 'object') {\r\n        return true\r\n    }\r\n    return Object.getOwnPropertyNames(obj).length === 0\r\n}\r\n\r\nexport function capitalize(str) {\r\n    if (str === undefined) \r\n        return ''\r\n    else \r\n        return str.charAt(0).toUpperCase() + str.slice(1)\r\n}\r\n\r\n// To see the console output set the key 'debug-u-dicom-viewer' in \r\n// 'Storage->Local Storage' panel of your browser Develop Tool\r\nexport function log() {\r\n    let log = localStorage.getItem('debug-u-dicom-viewer')\r\n    if (log === null) {\r\n        console.log = function(){}\r\n    }\r\n}\r\n\r\nexport function isInputDirSupported() {\r\n    var tmpInput = document.createElement('input')\r\n    if ('webkitdirectory' in tmpInput \r\n        || 'mozdirectory' in tmpInput \r\n        || 'odirectory' in tmpInput \r\n        || 'msdirectory' in tmpInput \r\n        || 'directory' in tmpInput) return true\r\n    return false\r\n}\r\n\r\nexport function isUrlImage(url) {\r\n    if (url === undefined || url === null) return false\r\n    return(url.match(/\\.(jpeg|jpg|png)$/) != null)\r\n}\r\n\r\nexport function isFileImage(file) {\r\n    if (file === undefined || file === null) return false \r\n    const acceptedImageTypes = ['image/jpeg', 'image/png'] // 'image/gif', \r\n    return file && acceptedImageTypes.includes(file['type'])\r\n}\r\n\r\nexport function isFsFileImage(fsItem) {\r\n    console.log('isFsFileImage: ', fsItem)\r\n    if (fsItem === undefined || fsItem === null) return false\r\n    return fsItem.type.toLowerCase() === 'jpeg' || fsItem.type.toLowerCase() === 'png'\r\n}\r\n\r\nexport function getFileNameCorrect(filename) {\r\n    if (isAndroid && isFirefox) { // possible uncorrect .null extension is found in Android Firefox, it's a bug? CHECK IT\r\n        const ext = getFileExt(filename)\r\n        if (ext === 'null') {\r\n            return getFileName(filename)\r\n        }\r\n    }\r\n    return filename \r\n}\r\n\r\nexport function getFileExt(file) {\r\n    const re = /(?:\\.([^.]+))?$/\r\n    const ext = re.exec(file)[1]\r\n    if (ext === undefined) {\r\n        return 'dcm'\r\n    }\r\n    return ext\r\n}\r\n\r\nexport function getFileExtReal(file) {\r\n    const re = /(?:\\.([^.]+))?$/\r\n    const ext = re.exec(file)[1]\r\n    if (ext === undefined) {\r\n        return ''\r\n    }\r\n    return ext\r\n}\r\n\r\nexport function getFileName(file) {\r\n    const name = file.replace(/\\.[^.$]+$/, '')\r\n    if (name === undefined) {\r\n        return ''\r\n    }\r\n    return name    \r\n}\r\n\r\nexport function formatBytes(bytes, decimals = 2) {\r\n    if (bytes === '') return ''\r\n    if (bytes === 0) return '0 Bytes'\r\n    const k = 1024\r\n    const dm = decimals < 0 ? 0 : decimals\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i]\r\n}\r\n\r\n\r\n// ---------------------------------------------------------------------------------------------- SETTINGS \r\n//#region  SETTINGS\r\n\r\nexport function getSettingsSaveAs() {\r\n    let saveAs = localStorage.getItem(SETTINGS_SAVEAS)\r\n    if (saveAs === null) {\r\n      saveAs = \"png\"\r\n      localStorage.setItem(SETTINGS_SAVEAS, saveAs)\r\n    }\r\n    return saveAs\r\n}\r\n\r\nexport function setSettingsSaveAs(value) {\r\n    localStorage.setItem(SETTINGS_SAVEAS, value)  \r\n}\r\n\r\nexport function getSettingsSaveInto() {\r\n    let saveInto = localStorage.getItem(SETTINGS_SAVEINTO)\r\n    if (saveInto === null) {\r\n        saveInto = \"local\"\r\n      localStorage.setItem(SETTINGS_SAVEINTO, saveInto)\r\n    }\r\n    return saveInto\r\n}\r\n\r\nexport function setSettingsSaveInto(value) {\r\n    localStorage.setItem(SETTINGS_SAVEINTO, value)  \r\n}\r\n\r\nexport function getSettingsDcmHeader() {\r\n    let exportAs = localStorage.getItem(SETTINGS_DCMHEADER)\r\n    if (exportAs === null) {\r\n      exportAs = \"json\"\r\n      localStorage.setItem(SETTINGS_DCMHEADER, exportAs)\r\n    }  \r\n    return exportAs\r\n}\r\n\r\nexport function setSettingsDcmHeader(value) {\r\n    localStorage.setItem(SETTINGS_DCMHEADER, value)  \r\n}\r\n\r\nexport function getSettingsOverlay() {\r\n    let overlay = localStorage.getItem(SETTINGS_OVERLAY)\r\n    if (overlay === null) {\r\n      overlay = \"1\"\r\n      localStorage.setItem(SETTINGS_OVERLAY, overlay)\r\n    }\r\n    return overlay === '1'\r\n}\r\n\r\nexport function setSettingsOverlay(value) {\r\n    localStorage.setItem(SETTINGS_OVERLAY, value ? '1' : '0')  \r\n}\r\n\r\nexport function getSettingsMeasurement() {\r\n    let measurement = localStorage.getItem(SETTINGS_MEASUREMENT)\r\n    if (measurement === null) {\r\n        measurement = '1'\r\n        localStorage.setItem(SETTINGS_MEASUREMENT, measurement)\r\n    }\r\n    return measurement\r\n}\r\n\r\nexport function setSettingsMeasurement(value) {\r\n    localStorage.setItem(SETTINGS_MEASUREMENT, value)  \r\n}\r\n\r\nexport function getSettingsFsView() {\r\n    let view = localStorage.getItem(SETTINGS_FSVIEW)\r\n    if (view === null) {\r\n        view = isMobile && !isTablet ? 'bottom' : 'right'\r\n        localStorage.setItem(SETTINGS_FSVIEW, view)\r\n    }\r\n    return view\r\n}\r\n\r\nexport function setSettingsFsView(value) {\r\n    localStorage.setItem(SETTINGS_FSVIEW, value)  \r\n}\r\n\r\nexport function getSettingsDicomdirView() {\r\n    let view = localStorage.getItem(SETTINGS_DICOMDIRVIEW)\r\n    if (view === null) {\r\n        view = isMobile && !isTablet ? 'bottom' : 'right'\r\n        localStorage.setItem(SETTINGS_DICOMDIRVIEW, view)\r\n    }\r\n    return view\r\n}\r\n\r\nexport function setSettingsDicomdirView(value) {\r\n    localStorage.setItem(SETTINGS_DICOMDIRVIEW, value)  \r\n}\r\n\r\nexport function getSettingsMprInterpolation() {\r\n    let method = localStorage.getItem(SETTINGS_MPRINTERPOLATION)\r\n    if (method === null) {\r\n        method = 'weightedlinear'\r\n        localStorage.setItem(SETTINGS_MPRINTERPOLATION, method)\r\n    }\r\n    return method\r\n}\r\n\r\nexport function setSettingsMprInterpolation(value) {\r\n    localStorage.setItem(SETTINGS_MPRINTERPOLATION, value)  \r\n}\r\n\r\n//#endregion\r\n\r\n/**\r\n * Converts a value to a string appropriate for entry into a CSV table.  E.g., a string value will be surrounded by quotes.\r\n * @param {string|number|object} theValue\r\n */\r\nfunction toCsvValue(theValue) {\r\n    let t = typeof theValue,\r\n        output\r\n\r\n    let sDelimiter = '\"'\r\n\r\n    if (t === 'undefined' || t === null) {\r\n        output = ''\r\n    } else if (t === 'string') {\r\n        output = sDelimiter + theValue.replace(/\"/g, '\"\"') + sDelimiter\r\n    } else {\r\n        output = sDelimiter + String(theValue).replace(/\"/g, '\"\"') + sDelimiter\r\n    }\r\n\r\n    return output\r\n}\r\n\r\n/**\r\n * Converts an array of objects (with identical schemas) into a CSV table.\r\n * @param {Array} objArray An array of objects.  Each object in the array must have the same property list.\r\n * @param {string} cDelimiter The column delimiter.  Defaults to a comma (,) if omitted.\r\n * @return {string} The CSV equivalent of objArray.\r\n */\r\nexport function toCsv(objArray, cDelimiter) {\r\n    var i,\r\n        l,\r\n        names = [],\r\n        name,\r\n        value,\r\n        obj,\r\n        row,\r\n        output = '',\r\n        n,\r\n        nl\r\n\r\n    // Initialize default parameters.\r\n\r\n    let sDelimiter = '\"'\r\n    if (typeof cDelimiter === 'undefined' || cDelimiter === null) {\r\n        cDelimiter = ','\r\n    }\r\n\r\n    for (i = 0, l = objArray.length; i < l; i += 1) {\r\n        // Get the names of the properties.\r\n        obj = objArray[i]\r\n        row = ''\r\n        if (i === 0) {\r\n            // Loop through the names\r\n            for (name in obj) {\r\n                if (obj.hasOwnProperty(name)) {\r\n                    names.push(name)\r\n                    row += [\r\n                        sDelimiter,\r\n                        name.replace(/\"/g, '\"\"'),\r\n                        sDelimiter,\r\n                        cDelimiter,\r\n                    ].join('')\r\n                }\r\n            }\r\n            row = row.substring(0, row.length - 1)\r\n            output += row\r\n        }\r\n\r\n        output += '\\n'\r\n        row = ''\r\n        for (n = 0, nl = names.length; n < nl; n += 1) {\r\n            name = names[n]\r\n            value = obj[name]\r\n            if (n > 0) {\r\n                row += cDelimiter\r\n            }\r\n            row += toCsvValue(value)\r\n        }\r\n        output += row\r\n    }\r\n\r\n    return output\r\n}\r\n\r\n","\r\nexport const SETTINGS_SAVEAS = 'saveAs'\r\nexport const SETTINGS_SAVEINTO = 'saveInto'\r\nexport const SETTINGS_DCMHEADER = 'exportAs'\r\nexport const SETTINGS_OVERLAY = 'overlay'\r\nexport const SETTINGS_MEASUREMENT = 'measurement'\r\nexport const SETTINGS_FSVIEW = 'fsView'\r\nexport const SETTINGS_DICOMDIRVIEW = 'dicomdirView'\r\nexport const SETTINGS_MPRINTERPOLATION = 'mprInterpolation'\r\n","export const CLEAR_STORE = 'CLEAR_STORE'\r\nexport const LOCALFILE_STORE = 'LOCALFILE_STORE'\r\nexport const FSFILE_STORE = 'LOCALFILE_STORE'\r\n//export const ALLFILES_STORE = 'ALLFILES_STORE'\r\nexport const FILES_STORE = 'FILES_STORE'\r\nexport const SERIES_STORE = 'SERIES_STORE'\r\nexport const DCM_IS_OPEN = 'DCM_IS_OPEN'\r\nexport const DCM_TOOL = 'DCM_TOOL'\r\nexport const ACTIVE_DCM_INDEX = 'ACTIVE_DCM_INDEX'\r\nexport const ACTIVE_DCM = 'ACTIVE_DCM'\r\nexport const ACTIVE_MEASUREMENTS = 'ACTIVE_MEASUREMENTS'\r\nexport const EXPLORER_STORE = 'EXPLORER_STORE'\r\nexport const EXPLORER_ACTIVE_PATIENT_INDEX = 'EXPLORER_ACTIVE_PATIENT_INDEX'\r\nexport const EXPLORER_ACTIVE_STUDY_INDEX = 'EXPLORER_ACTIVE_STUDY_INDEX'\r\nexport const EXPLORER_ACTIVE_SERIES_INDEX = 'EXPLORER_ACTIVE_SERIES_INDEX'\r\nexport const LAYOUT = 'LAYOUT'\r\nexport const DICOMDIR = 'DICOMDIR'\r\nexport const FSCURRENTDIR = 'FSCURRENTDIR'\r\nexport const FSCURRENTLIST = 'FSCURRENTLIST'\r\nexport const FSZIPPEDFILE = 'FSZIPPEDFILE'\r\nexport const FSREFRESH = 'FSREFRESH'\r\nexport const VOLUME_STORE = 'VOLUME_STORE'\r\nexport const DCMENABLETOOL_STORE = 'DCMENABLETOOL_STORE'\r\n\r\nexport const clearStore = () => {\r\n    return { \r\n        type: CLEAR_STORE, \r\n    }\r\n}\r\n\r\nexport const localFileStore = (file) => {\r\n    return { \r\n        type: LOCALFILE_STORE, \r\n        localFile: file\r\n    }\r\n}\r\n\r\nexport const fsFileStore = (file) => {\r\n    return { \r\n        type: FSFILE_STORE, \r\n        fsFile: file\r\n    }\r\n}\r\n/*\r\nexport const allFilesStore = (files) => {\r\n    return { \r\n        type: ALLFILES_STORE, \r\n        allFiles: files\r\n    }\r\n}\r\n*/\r\nexport const filesStore = (files) => {\r\n    return { \r\n        type: FILES_STORE, \r\n        files: files\r\n    }\r\n}\r\n\r\nexport const seriesStore = (series) => {\r\n    return { \r\n        type: SERIES_STORE, \r\n        series: series\r\n    }\r\n}\r\n\r\nexport const dcmIsOpen = (value) => {\r\n    return { \r\n        type: DCM_IS_OPEN, \r\n        value: value\r\n    }\r\n}\r\n\r\nexport const dcmTool = (tool) => {\r\n    return { \r\n        type: DCM_TOOL, \r\n        tool: tool \r\n    }\r\n}\r\n\r\nexport const activeDcmIndex = (index) => {\r\n    return { \r\n        type: ACTIVE_DCM_INDEX, \r\n        activeDcmIndex: index \r\n    }\r\n}\r\n\r\nexport const activeDcm = (dcm) => {\r\n    return { \r\n        type: ACTIVE_DCM, \r\n        activeDcm: dcm \r\n    }\r\n}\r\n\r\nexport const activeMeasurements = (measurements) => {\r\n    return { \r\n        type: ACTIVE_MEASUREMENTS, \r\n        measurements: measurements \r\n    }\r\n}\r\n\r\nexport const explorer = (data) => {\r\n    return { \r\n        type: EXPLORER_STORE, \r\n        explorer: data \r\n    }\r\n}\r\n\r\nexport const explorerActivePatientIndex = (index) => {\r\n    return { \r\n        type: EXPLORER_ACTIVE_PATIENT_INDEX, \r\n        explorerActivePatientIndex: index \r\n    }\r\n}\r\n\r\nexport const explorerActiveStudyIndex = (index) => {\r\n    return { \r\n        type: EXPLORER_ACTIVE_STUDY_INDEX, \r\n        explorerActiveStudyIndex: index \r\n    }\r\n}\r\n\r\nexport const explorerActiveSeriesIndex = (index) => {\r\n    return { \r\n        type: EXPLORER_ACTIVE_SERIES_INDEX, \r\n        explorerActiveSeriesIndex: index \r\n    }\r\n}\r\n\r\nexport const setLayout = (row, col) => {\r\n    return { \r\n        type: LAYOUT, \r\n        layout: [row, col]\r\n    }\r\n}\r\n\r\nexport const setDicomdir = (dicomdir) => {\r\n    return { \r\n        type: DICOMDIR, \r\n        dicomdir: dicomdir\r\n    }\r\n}\r\n\r\nexport const setFsCurrentDir = (dir) => {\r\n    return { \r\n        type: FSCURRENTDIR, \r\n        fsCurrentDir: dir\r\n    }\r\n}\r\n\r\nexport const setFsCurrentList = (list) => {\r\n    return { \r\n        type: FSCURRENTLIST, \r\n        fsCurrentList: list\r\n    }\r\n}\r\n\r\nexport const setZippedFile = (file) => {\r\n    return { \r\n        type: FSZIPPEDFILE, \r\n        fsZippedFile: file\r\n    }\r\n}\r\n\r\nexport const doFsRefresh = () => {\r\n    return { \r\n        type: FSREFRESH,\r\n    }\r\n}\r\n\r\nexport const setVolume = (volume) => {\r\n    return { \r\n        type: VOLUME_STORE,\r\n        volume: volume,\r\n    }\r\n}\r\n\r\nexport const setDcmEnableTool = (value) => {\r\n    return { \r\n        type: DCMENABLETOOL_STORE,\r\n        dcmEnableTool: value,\r\n    }\r\n}\r\n","import React, { Fragment, PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport * as dicomParser from 'dicom-parser'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport 'react-perfect-scrollbar/dist/css/styles.css'\r\nimport PerfectScrollbar from 'react-perfect-scrollbar'\r\nimport fs from '../fs/fs'\r\nimport {\r\n  dicomDateToLocale,\r\n  dicomTimeToStr,\r\n  getSettingsDicomdirView,\r\n} from '../functions'\r\nimport {\r\n  fsFileStore,\r\n} from '../actions'\r\n\r\nconst styles = theme => ({\r\n  study: { \r\n    paddingLeft: theme.spacing(3) \r\n  },\r\n  series: { \r\n    paddingLeft: theme.spacing(5) \r\n  },\r\n  images: { \r\n    paddingLeft: theme.spacing(7) \r\n  },  \r\n  listItemText:{\r\n    fontSize:'0.80em',\r\n  }\r\n})\r\n\r\nconst styleScrollbar = {\r\n  height: 'calc(100vh - 48px)',\r\n}\r\n\r\nconst ExpandIcon = ({ expanded }) => expanded ? <ExpandLessIcon /> : <ExpandMoreIcon />\r\n\r\nclass Dicomdir extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.output = null\r\n    }\r\n\r\n    state = {\r\n      data: [],\r\n      expanded: [],\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.dicomdir.origin === 'local')\r\n          this.openDicomdir(this.props.dicomdir.dicomdir)   \r\n        else \r\n          this.openDicomdirFs(this.props.dicomdir.dicomdir)               \r\n    }\r\n\r\n    buildData = (id = null) => {\r\n      let output = this.output\r\n      if (id !== null) {\r\n        output[id].expanded = !output[id].expanded\r\n      }\r\n      let images = []\r\n      let series = []\r\n      let study = []\r\n      let patient = []\r\n      output.slice().reverse().forEach((obj, i) => {\r\n        if (obj.key === 'image') {\r\n          images.unshift({id: obj.id, key: obj.key, path: obj.path, value: obj.value})\r\n        } else if (obj.key === 'series') {\r\n          series.unshift({id: obj.id, key: obj.key, number: obj.number, value: obj.value, expanded: obj.expanded, children: images})\r\n          images = []\r\n        } else if (obj.key === 'study') {\r\n          //console.log('study obj: ', obj)\r\n          study.unshift({id: obj.id, key: obj.key, value: obj.value, expanded: obj.expanded, children: series})\r\n          series = []\r\n        } else if (obj.key === 'patient') {\r\n          patient.unshift({id: obj.id, key: obj.key, value: obj.value, expanded: obj.expanded, children: study})\r\n          study = []\r\n        }\r\n      })\r\n      this.setState({data: patient})\r\n    }\r\n\r\n    buildOutput = (dataset) => {\r\n      //console.log('dataset: ', dataset)\r\n      let data = dataset.elements.x00041220.items\r\n      let output = []\r\n      if (data) {\r\n          data.forEach((e, index) => {\r\n            const id = index.toString()\r\n            if (e.dataSet.string('x00041430') === 'PATIENT') {\r\n                //console.log(\"Patient Name - \"+e.dataSet.string('x00100010'))\r\n                output.push({id: id, key: 'patient', value: e.dataSet.string('x00100010'), expanded: true})\r\n            } else if (e.dataSet.string('x00041430') === 'STUDY') {\r\n                //console.log(\"Study - \"+e.dataSet.string('x00081030'))\r\n                const value = `${dicomDateToLocale(e.dataSet.string('x00080020'))} - ${dicomTimeToStr(e.dataSet.string('x00080030'))}`\r\n                output.push({id: id, key: 'study', value: value, expanded: true})\r\n            } else if (e.dataSet.string('x00041430') === 'SERIES') {\r\n                //console.log(\"Series number - \"+e.dataSet.string('x00200011'))\r\n                output.push({id: id, key: 'series', number: e.dataSet.string('x00200011'), value: e.dataSet.string('x00080060'), expanded: true})\r\n            } else if (e.dataSet.string('x00041430') === 'IMAGE') {\r\n                //console.log(\"Image - \"+e.dataSet.string('x00041500'))\r\n                output.push({id: id, key: 'image', path: e.dataSet.string('x00041500').replace(/\\\\/g, '/'), value: e.dataSet.string('x00041500').split('\\\\').pop(), expanded: true})\r\n            }              \r\n          })\r\n      }\r\n      //console.log('output: ', output)\r\n      return output\r\n    }\r\n\r\n    openDicomdir = (file) => {\r\n        var reader = new FileReader()\r\n        reader.onload = (file) => {\r\n          let arrayBuffer = reader.result\r\n          let byteArray = new Uint8Array(arrayBuffer)\r\n          // Invoke the paresDicom function and get back a DataSet object with the contents\r\n          let dataset = null\r\n          let output = []\r\n          try {\r\n              dataset = dicomParser.parseDicom(byteArray)\r\n              output = this.buildOutput(dataset)\r\n          } catch(err) {\r\n              if (typeof err.dataSet != 'undefined') {\r\n                  output = this.buildOutput(err.dataSet)\r\n              }\r\n          }\r\n          this.output = output\r\n          this.buildData()\r\n        }\r\n\r\n        reader.readAsArrayBuffer(file)\r\n    }\r\n\r\n    openDicomdirFs = (fsItem) => {\r\n      let byteArray = new Uint8Array(fsItem.data)\r\n      let dataset = null\r\n      let output = []\r\n      try {\r\n        dataset = dicomParser.parseDicom(byteArray)\r\n        output = this.buildOutput(dataset)\r\n      } catch(err) {\r\n        if (typeof err.dataSet != 'undefined') {\r\n          output = this.buildOutput(err.dataSet)\r\n        }\r\n      }\r\n      this.output = output\r\n      this.buildData()\r\n    }\r\n\r\n    onClick = (id) => {\r\n      const obj = this.output.find(x => x.id === id)\r\n      if (obj.key === 'image') {\r\n        if (this.props.dicomdir.origin === 'local') { // load it from local\r\n          const file = this.props.dicomdir.files.find(x => x.name === obj.value)\r\n          this.props.onOpenFile(file)\r\n        } else { // load it from sandboxed file system\r\n          let components = obj.path.split('/')\r\n          const name = components.pop()\r\n          components.unshift(this.props.fsCurrentDir)\r\n          const parent = components.join('/')\r\n          fs.files.where({parent: parent, name: name}).first((item) => {\r\n            this.props.setFsFileStore(item)\r\n            this.props.onOpenFs(item)\r\n          })\r\n        }\r\n      } else {\r\n        this.buildData(id)\r\n      }\r\n    }\r\n\r\n    studyText = (study) => {\r\n      //console.log('study: ', study)\r\n      return study.value\r\n    }\r\n\r\n    render() {   \r\n      const { classes } = this.props\r\n\r\n      let styleComponent = null\r\n      if (getSettingsDicomdirView() === 'bottom') {\r\n          styleComponent = {marginTop: '0px', height: '275px'}\r\n      } else {\r\n          styleComponent = {marginTop: '48px', width: '350px'}\r\n      }\r\n\r\n      return (\r\n        <PerfectScrollbar>\r\n        <div style={styleScrollbar}>  \r\n        <div style={styleComponent}>\r\n          \r\n          <List>\r\n            {this.state.data.map(({ ...patient }, index) => (\r\n              <Fragment key={index}>\r\n                <ListItem button onClick={() => this.onClick(patient.id)}>\r\n                  <ListItemText primary={patient.value} secondary={patient.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                  <ExpandIcon expanded={patient.expanded} />\r\n                </ListItem>\r\n                <Collapse in={patient.expanded}>\r\n                  {patient.children.map(study => (\r\n                    <Fragment key={study.id}>\r\n                      <ListItem key={study.id} button dense onClick={() => this.onClick(study.id)} className={classes.study}>\r\n                        <ListItemText primary={this.studyText(study)} secondary={study.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                        <ExpandIcon expanded={study.expanded} />\r\n                      </ListItem>\r\n                      <Collapse in={study.expanded}>\r\n                        {study.children.map(series => (\r\n                          <Fragment key={series.id}>\r\n                            <ListItem key={series.id} button dense onClick={() => this.onClick(series.id)} className={classes.series}>\r\n                              <ListItemText primary={`${series.value} (${series.number})`} secondary={series.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                              <ExpandIcon expanded={study.expanded} />\r\n                            </ListItem>\r\n                            <Collapse in={series.expanded}>\r\n                              {series.children.map(images => (\r\n                                <ListItem key={images.id} button dense onClick={() => this.onClick(images.id)} className={classes.images}>\r\n                                  <ListItemText primary={images.value} secondary={images.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                                </ListItem>\r\n                              ))}\r\n                            </Collapse>\r\n                          </Fragment>\r\n                        ))}\r\n                      </Collapse>\r\n                    </Fragment>\r\n                  ))}\r\n                </Collapse>\r\n              </Fragment>\r\n            ))}\r\n          </List>\r\n        </div>\r\n        </div>\r\n        </PerfectScrollbar>\r\n      )\r\n    }\r\n}   \r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      dicomdir: state.dicomdir,\r\n      fsCurrentDir: state.fsCurrentDir,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setFsFileStore: (file) => dispatch(fsFileStore(file))\r\n  }\r\n}\r\n  \r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(Dicomdir))\r\n","// The table below was generated by running the following javascript in the console window while\n// viewing the HTML version of the standard here:\n// DICOM Standard here: http://dicom.nema.org/medical/dicom/current/output/html/part06.html\n// see the blog post about it here: http://chafey.blogspot.com/2015/08/parsing-dicom-standard-with-javascript.html\n\n/*\n (function () {\n var elements = document.querySelectorAll('#table_A-1 ~ div tbody tr');\n var result = \"\";for(var i=0; i < elements.length; i++) {\n result += \"'\" + elements[i].childNodes[1].childNodes[1].innerText.replace(/[^\\x20-\\x7E]+/g, '')  + \"':'\" +\n elements[i].childNodes[3].childNodes[1].innerText.replace(/[^\\x20-\\x7E]+/g, '') + \"',\\n\";\n }\n return result;\n })();\n */\n\nexport const uids = {\n  '1.2.840.10008.1.1':'Verification SOP Class',\n  '1.2.840.10008.1.2':'Implicit VR Little Endian: Default Transfer Syntax for DICOM',\n  '1.2.840.10008.1.2.1':'Explicit VR Little Endian',\n  '1.2.840.10008.1.2.1.99':'Deflated Explicit VR Little Endian',\n  '1.2.840.10008.1.2.2':'Explicit VR Big Endian (Retired)',\n  '1.2.840.10008.1.2.4.50':'JPEG Baseline (Process 1): Default Transfer Syntax for Lossy JPEG 8 Bit Image Compression',\n  '1.2.840.10008.1.2.4.51':'JPEG Extended (Process 2 & 4): Default Transfer Syntax for Lossy JPEG 12 Bit Image Compression (Process 4 only)',\n  '1.2.840.10008.1.2.4.52':'JPEG Extended (Process 3 & 5) (Retired)',\n  '1.2.840.10008.1.2.4.53':'JPEG Spectral Selection, Non-Hierarchical (Process 6 & 8) (Retired)',\n  '1.2.840.10008.1.2.4.54':'JPEG Spectral Selection, Non-Hierarchical (Process 7 & 9) (Retired)',\n  '1.2.840.10008.1.2.4.55':'JPEG Full Progression, Non-Hierarchical (Process 10 & 12) (Retired)',\n  '1.2.840.10008.1.2.4.56':'JPEG Full Progression, Non-Hierarchical (Process 11 & 13) (Retired)',\n  '1.2.840.10008.1.2.4.57':'JPEG Lossless, Non-Hierarchical (Process 14)',\n  '1.2.840.10008.1.2.4.58':'JPEG Lossless, Non-Hierarchical (Process 15) (Retired)',\n  '1.2.840.10008.1.2.4.59':'JPEG Extended, Hierarchical (Process 16 & 18) (Retired)',\n  '1.2.840.10008.1.2.4.60':'JPEG Extended, Hierarchical (Process 17 & 19) (Retired)',\n  '1.2.840.10008.1.2.4.61':'JPEG Spectral Selection, Hierarchical (Process 20 & 22) (Retired)',\n  '1.2.840.10008.1.2.4.62':'JPEG Spectral Selection, Hierarchical (Process 21 & 23) (Retired)',\n  '1.2.840.10008.1.2.4.63':'JPEG Full Progression, Hierarchical (Process 24 & 26) (Retired)',\n  '1.2.840.10008.1.2.4.64':'JPEG Full Progression, Hierarchical (Process 25 & 27) (Retired)',\n  '1.2.840.10008.1.2.4.65':'JPEG Lossless, Hierarchical (Process 28) (Retired)',\n  '1.2.840.10008.1.2.4.66':'JPEG Lossless, Hierarchical (Process 29) (Retired)',\n  '1.2.840.10008.1.2.4.70':'JPEG Lossless, Non-Hierarchical, First-Order Prediction (Process 14 [Selection Value 1]): Default Transfer Syntax for Lossless JPEG Image Compression',\n  '1.2.840.10008.1.2.4.80':'JPEG-LS Lossless Image Compression',\n  '1.2.840.10008.1.2.4.81':'JPEG-LS Lossy (Near-Lossless) Image Compression',\n  '1.2.840.10008.1.2.4.90':'JPEG 2000 Image Compression (Lossless Only)',\n  '1.2.840.10008.1.2.4.91':'JPEG 2000 Image Compression',\n  '1.2.840.10008.1.2.4.92':'JPEG 2000 Part 2 Multi-component Image Compression (Lossless Only)',\n  '1.2.840.10008.1.2.4.93':'JPEG 2000 Part 2 Multi-component Image Compression',\n  '1.2.840.10008.1.2.4.94':'JPIP Referenced',\n  '1.2.840.10008.1.2.4.95':'JPIP Referenced Deflate',\n  '1.2.840.10008.1.2.4.100':'MPEG2 Main Profile @ Main Level',\n  '1.2.840.10008.1.2.4.101':'MPEG2 Main Profile @ High Level',\n  '1.2.840.10008.1.2.4.102':'MPEG-4 AVC/H.264 High Profile / Level 4.1',\n  '1.2.840.10008.1.2.4.103':'MPEG-4 AVC/H.264 BD-compatible High Profile / Level 4.1',\n  '1.2.840.10008.1.2.4.104':'MPEG-4 AVC/H.264 High Profile / Level 4.2 For 2D Video',\n  '1.2.840.10008.1.2.4.105':'MPEG-4 AVC/H.264 High Profile / Level 4.2 For 3D Video',\n  '1.2.840.10008.1.2.4.106':'MPEG-4 AVC/H.264 Stereo High Profile / Level 4.2',\n  '1.2.840.10008.1.2.5':'RLE Lossless',\n  '1.2.840.10008.1.2.6.1':'RFC 2557 MIME encapsulation',\n  '1.2.840.10008.1.2.6.2':'XML Encoding',\n  '1.2.840.10008.1.3.10':'Media Storage Directory Storage',\n  '1.2.840.10008.1.4.1.1':'Talairach Brain Atlas Frame of Reference',\n  '1.2.840.10008.1.4.1.2':'SPM2 T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.3':'SPM2 T2 Frame of Reference',\n  '1.2.840.10008.1.4.1.4':'SPM2 PD Frame of Reference',\n  '1.2.840.10008.1.4.1.5':'SPM2 EPI Frame of Reference',\n  '1.2.840.10008.1.4.1.6':'SPM2 FIL T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.7':'SPM2 PET Frame of Reference',\n  '1.2.840.10008.1.4.1.8':'SPM2 TRANSM Frame of Reference',\n  '1.2.840.10008.1.4.1.9':'SPM2 SPECT Frame of Reference',\n  '1.2.840.10008.1.4.1.10':'SPM2 GRAY Frame of Reference',\n  '1.2.840.10008.1.4.1.11':'SPM2 WHITE Frame of Reference',\n  '1.2.840.10008.1.4.1.12':'SPM2 CSF Frame of Reference',\n  '1.2.840.10008.1.4.1.13':'SPM2 BRAINMASK Frame of Reference',\n  '1.2.840.10008.1.4.1.14':'SPM2 AVG305T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.15':'SPM2 AVG152T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.16':'SPM2 AVG152T2 Frame of Reference',\n  '1.2.840.10008.1.4.1.17':'SPM2 AVG152PD Frame of Reference',\n  '1.2.840.10008.1.4.1.18':'SPM2 SINGLESUBJT1 Frame of Reference',\n  '1.2.840.10008.1.4.2.1':'ICBM 452 T1 Frame of Reference',\n  '1.2.840.10008.1.4.2.2':'ICBM Single Subject MRI Frame of Reference',\n  '1.2.840.10008.1.5.1':'Hot Iron Color Palette SOP Instance',\n  '1.2.840.10008.1.5.2':'PET Color Palette SOP Instance',\n  '1.2.840.10008.1.5.3':'Hot Metal Blue Color Palette SOP Instance',\n  '1.2.840.10008.1.5.4':'PET 20 Step Color Palette SOP Instance',\n  '1.2.840.10008.1.9':'Basic Study Content Notification SOP Class (Retired)',\n  '1.2.840.10008.1.20.1':'Storage Commitment Push Model SOP Class',\n  '1.2.840.10008.1.20.1.1':'Storage Commitment Push Model SOP Instance',\n  '1.2.840.10008.1.20.2':'Storage Commitment Pull Model SOP Class (Retired)',\n  '1.2.840.10008.1.20.2.1':'Storage Commitment Pull Model SOP Instance (Retired)',\n  '1.2.840.10008.1.40':'Procedural Event Logging SOP Class',\n  '1.2.840.10008.1.40.1':'Procedural Event Logging SOP Instance',\n  '1.2.840.10008.1.42':'Substance Administration Logging SOP Class',\n  '1.2.840.10008.1.42.1':'Substance Administration Logging SOP Instance',\n  '1.2.840.10008.2.6.1':'DICOM UID Registry',\n  '1.2.840.10008.2.16.4':'DICOM Controlled Terminology',\n  '1.2.840.10008.3.1.1.1':'DICOM Application Context Name',\n  '1.2.840.10008.3.1.2.1.1':'Detached Patient Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.1.4':'Detached Patient Management Meta SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.2.1':'Detached Visit Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.3.1':'Detached Study Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.3.2':'Study Component Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.3.3':'Modality Performed Procedure Step SOP Class',\n  '1.2.840.10008.3.1.2.3.4':'Modality Performed Procedure Step Retrieve SOP Class',\n  '1.2.840.10008.3.1.2.3.5':'Modality Performed Procedure Step Notification SOP Class',\n  '1.2.840.10008.3.1.2.5.1':'Detached Results Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.5.4':'Detached Results Management Meta SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.5.5':'Detached Study Management Meta SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.6.1':'Detached Interpretation Management SOP Class (Retired)',\n  '1.2.840.10008.4.2':'Storage Service Class',\n  '1.2.840.10008.5.1.1.1':'Basic Film Session SOP Class',\n  '1.2.840.10008.5.1.1.2':'Basic Film Box SOP Class',\n  '1.2.840.10008.5.1.1.4':'Basic Grayscale Image Box SOP Class',\n  '1.2.840.10008.5.1.1.4.1':'Basic Color Image Box SOP Class',\n  '1.2.840.10008.5.1.1.4.2':'Referenced Image Box SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.9':'Basic Grayscale Print Management Meta SOP Class',\n  '1.2.840.10008.5.1.1.9.1':'Referenced Grayscale Print Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.14':'Print Job SOP Class',\n  '1.2.840.10008.5.1.1.15':'Basic Annotation Box SOP Class',\n  '1.2.840.10008.5.1.1.16':'Printer SOP Class',\n  '1.2.840.10008.5.1.1.16.376':'Printer Configuration Retrieval SOP Class',\n  '1.2.840.10008.5.1.1.17':'Printer SOP Instance',\n  '1.2.840.10008.5.1.1.17.376':'Printer Configuration Retrieval SOP Instance',\n  '1.2.840.10008.5.1.1.18':'Basic Color Print Management Meta SOP Class',\n  '1.2.840.10008.5.1.1.18.1':'Referenced Color Print Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.22':'VOI LUT Box SOP Class',\n  '1.2.840.10008.5.1.1.23':'Presentation LUT SOP Class',\n  '1.2.840.10008.5.1.1.24':'Image Overlay Box SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.24.1':'Basic Print Image Overlay Box SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.25':'Print Queue SOP Instance (Retired)',\n  '1.2.840.10008.5.1.1.26':'Print Queue Management SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.27':'Stored Print Storage SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.29':'Hardcopy Grayscale Image Storage SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.30':'Hardcopy Color Image Storage SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.31':'Pull Print Request SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.32':'Pull Stored Print Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.33':'Media Creation Management SOP Class UID',\n  '1.2.840.10008.5.1.1.40':'Display System SOP Class',\n  '1.2.840.10008.5.1.1.40.1':'Display System SOP Instance',\n  '1.2.840.10008.5.1.4.1.1.1':'Computed Radiography Image Storage',\n  '1.2.840.10008.5.1.4.1.1.1.1':'Digital X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.1.1.1':'Digital X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.1.2':'Digital Mammography X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.1.2.1':'Digital Mammography X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.1.3':'Digital Intra-Oral X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.1.3.1':'Digital Intra-Oral X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.2':'CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.2.1':'Enhanced CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.2.2':'Legacy Converted Enhanced CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.3':'Ultrasound Multi-frame Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.3.1':'Ultrasound Multi-frame Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4':'MR Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4.1':'Enhanced MR Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4.2':'MR Spectroscopy Storage',\n  '1.2.840.10008.5.1.4.1.1.4.3':'Enhanced MR Color Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4.4':'Legacy Converted Enhanced MR Image Storage',\n  '1.2.840.10008.5.1.4.1.1.5':'Nuclear Medicine Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.6':'Ultrasound Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.6.1':'Ultrasound Image Storage',\n  '1.2.840.10008.5.1.4.1.1.6.2':'Enhanced US Volume Storage',\n  '1.2.840.10008.5.1.4.1.1.7':'Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.1':'Multi-frame Single Bit Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.2':'Multi-frame Grayscale Byte Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.3':'Multi-frame Grayscale Word Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.4':'Multi-frame True Color Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.8':'Standalone Overlay Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.9':'Standalone Curve Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.9.1':'Waveform Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.9.1.1':'12-lead ECG Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.1.2':'General ECG Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.1.3':'Ambulatory ECG Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.2.1':'Hemodynamic Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.3.1':'Cardiac Electrophysiology Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.4.1':'Basic Voice Audio Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.4.2':'General Audio Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.5.1':'Arterial Pulse Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.6.1':'Respiratory Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.10':'Standalone Modality LUT Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.11':'Standalone VOI LUT Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.11.1':'Grayscale Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.2':'Color Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.3':'Pseudo-Color Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.4':'Blending Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.5':'XA/XRF Grayscale Softcopy Presentation State Storage',\n  '1.2.840.10008.5.1.4.1.1.12.1':'X-Ray Angiographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.1.1':'Enhanced XA Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.2':'X-Ray Radiofluoroscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.2.1':'Enhanced XRF Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.3':'X-Ray Angiographic Bi-Plane Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.13.1.1':'X-Ray 3D Angiographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.13.1.2':'X-Ray 3D Craniofacial Image Storage',\n  '1.2.840.10008.5.1.4.1.1.13.1.3':'Breast Tomosynthesis Image Storage',\n  '1.2.840.10008.5.1.4.1.1.13.1.4':'Breast Projection X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.13.1.5':'Breast Projection X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.14.1':'Intravascular Optical Coherence Tomography Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.14.2':'Intravascular Optical Coherence Tomography Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.20':'Nuclear Medicine Image Storage',\n  '1.2.840.10008.5.1.4.1.1.30':'Parametric Map Storage',\n  '1.2.840.10008.5.1.4.1.1.66':'Raw Data Storage',\n  '1.2.840.10008.5.1.4.1.1.66.1':'Spatial Registration Storage',\n  '1.2.840.10008.5.1.4.1.1.66.2':'Spatial Fiducials Storage',\n  '1.2.840.10008.5.1.4.1.1.66.3':'Deformable Spatial Registration Storage',\n  '1.2.840.10008.5.1.4.1.1.66.4':'Segmentation Storage',\n  '1.2.840.10008.5.1.4.1.1.66.5':'Surface Segmentation Storage',\n  '1.2.840.10008.5.1.4.1.1.67':'Real World Value Mapping Storage',\n  '1.2.840.10008.5.1.4.1.1.68.1':'Surface Scan Mesh Storage',\n  '1.2.840.10008.5.1.4.1.1.68.2':'Surface Scan Point Cloud Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1':'VL Image Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.77.2':'VL Multi-frame Image Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.77.1.1':'VL Endoscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.1.1':'Video Endoscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.2':'VL Microscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.2.1':'Video Microscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.3':'VL Slide-Coordinates Microscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.4':'VL Photographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.4.1':'Video Photographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.1':'Ophthalmic Photography 8 Bit Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.2':'Ophthalmic Photography 16 Bit Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.3':'Stereometric Relationship Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.4':'Ophthalmic Tomography Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.5':'Wide Field Ophthalmic Photography Stereographic Projection Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.6':'Wide Field Ophthalmic Photography 3D Coordinates Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.6':'VL Whole Slide Microscopy Image Storage',\n  '1.2.840.10008.5.1.4.1.1.78.1':'Lensometry Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.2':'Autorefraction Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.3':'Keratometry Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.4':'Subjective Refraction Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.5':'Visual Acuity Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.6':'Spectacle Prescription Report Storage',\n  '1.2.840.10008.5.1.4.1.1.78.7':'Ophthalmic Axial Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.8':'Intraocular Lens Calculations Storage',\n  '1.2.840.10008.5.1.4.1.1.79.1':'Macular Grid Thickness and Volume Report Storage',\n  '1.2.840.10008.5.1.4.1.1.80.1':'Ophthalmic Visual Field Static Perimetry Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.81.1':'Ophthalmic Thickness Map Storage',\n  '1.2.840.10008.5.1.4.1.1.82.1':'Corneal Topography Map Storage',\n  '1.2.840.10008.5.1.4.1.1.88.1':'Text SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.2':'Audio SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.3':'Detail SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.4':'Comprehensive SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.11':'Basic Text SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.22':'Enhanced SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.33':'Comprehensive SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.34':'Comprehensive 3D SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.35':'Extensible SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.40':'Procedure Log Storage',\n  '1.2.840.10008.5.1.4.1.1.88.50':'Mammography CAD SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.59':'Key Object Selection Document Storage',\n  '1.2.840.10008.5.1.4.1.1.88.65':'Chest CAD SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.67':'X-Ray Radiation Dose SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.68':'Radiopharmaceutical Radiation Dose SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.69':'Colon CAD SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.70':'Implantation Plan SR Storage',\n  '1.2.840.10008.5.1.4.1.1.104.1':'Encapsulated PDF Storage',\n  '1.2.840.10008.5.1.4.1.1.104.2':'Encapsulated CDA Storage',\n  '1.2.840.10008.5.1.4.1.1.128':'Positron Emission Tomography Image Storage',\n  '1.2.840.10008.5.1.4.1.1.128.1':'Legacy Converted Enhanced PET Image Storage',\n  '1.2.840.10008.5.1.4.1.1.129':'Standalone PET Curve Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.130':'Enhanced PET Image Storage',\n  '1.2.840.10008.5.1.4.1.1.131':'Basic Structured Display Storage',\n  '1.2.840.10008.5.1.4.1.1.481.1':'RT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.481.2':'RT Dose Storage',\n  '1.2.840.10008.5.1.4.1.1.481.3':'RT Structure Set Storage',\n  '1.2.840.10008.5.1.4.1.1.481.4':'RT Beams Treatment Record Storage',\n  '1.2.840.10008.5.1.4.1.1.481.5':'RT Plan Storage',\n  '1.2.840.10008.5.1.4.1.1.481.6':'RT Brachy Treatment Record Storage',\n  '1.2.840.10008.5.1.4.1.1.481.7':'RT Treatment Summary Record Storage',\n  '1.2.840.10008.5.1.4.1.1.481.8':'RT Ion Plan Storage',\n  '1.2.840.10008.5.1.4.1.1.481.9':'RT Ion Beams Treatment Record Storage',\n  '1.2.840.10008.5.1.4.1.1.501.1':'DICOS CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.501.2.1':'DICOS Digital X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.501.2.2':'DICOS Digital X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.501.3':'DICOS Threat Detection Report Storage',\n  '1.2.840.10008.5.1.4.1.1.501.4':'DICOS 2D AIT Storage',\n  '1.2.840.10008.5.1.4.1.1.501.5':'DICOS 3D AIT Storage',\n  '1.2.840.10008.5.1.4.1.1.501.6':'DICOS Quadrupole Resonance (QR) Storage',\n  '1.2.840.10008.5.1.4.1.1.601.1':'Eddy Current Image Storage',\n  '1.2.840.10008.5.1.4.1.1.601.2':'Eddy Current Multi-frame Image Storage',\n  '1.2.840.10008.5.1.4.1.2.1.1':'Patient Root Query/Retrieve Information Model - FIND',\n  '1.2.840.10008.5.1.4.1.2.1.2':'Patient Root Query/Retrieve Information Model - MOVE',\n  '1.2.840.10008.5.1.4.1.2.1.3':'Patient Root Query/Retrieve Information Model - GET',\n  '1.2.840.10008.5.1.4.1.2.2.1':'Study Root Query/Retrieve Information Model - FIND',\n  '1.2.840.10008.5.1.4.1.2.2.2':'Study Root Query/Retrieve Information Model - MOVE',\n  '1.2.840.10008.5.1.4.1.2.2.3':'Study Root Query/Retrieve Information Model - GET',\n  '1.2.840.10008.5.1.4.1.2.3.1':'Patient/Study Only Query/Retrieve Information Model - FIND (Retired)',\n  '1.2.840.10008.5.1.4.1.2.3.2':'Patient/Study Only Query/Retrieve Information Model - MOVE (Retired)',\n  '1.2.840.10008.5.1.4.1.2.3.3':'Patient/Study Only Query/Retrieve Information Model - GET (Retired)',\n  '1.2.840.10008.5.1.4.1.2.4.2':'Composite Instance Root Retrieve - MOVE',\n  '1.2.840.10008.5.1.4.1.2.4.3':'Composite Instance Root Retrieve - GET',\n  '1.2.840.10008.5.1.4.1.2.5.3':'Composite Instance Retrieve Without Bulk Data - GET',\n  '1.2.840.10008.5.1.4.31':'Modality Worklist Information Model - FIND',\n  '1.2.840.10008.5.1.4.32':'General Purpose Worklist Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.4.32.1':'General Purpose Worklist Information Model - FIND (Retired)',\n  '1.2.840.10008.5.1.4.32.2':'General Purpose Scheduled Procedure Step SOP Class (Retired)',\n  '1.2.840.10008.5.1.4.32.3':'General Purpose Performed Procedure Step SOP Class (Retired)',\n  '1.2.840.10008.5.1.4.33':'Instance Availability Notification SOP Class',\n  '1.2.840.10008.5.1.4.34.1':'RT Beams Delivery Instruction Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.2':'RT Conventional Machine Verification - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.3':'RT Ion Machine Verification - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4':'Unified Worklist and Procedure Step Service Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.1':'Unified Procedure Step - Push SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.2':'Unified Procedure Step - Watch SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.3':'Unified Procedure Step - Pull SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.4':'Unified Procedure Step - Event SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.5':'UPS Global Subscription SOP Instance',\n  '1.2.840.10008.5.1.4.34.5.1':'UPS Filtered Global Subscription SOP Instance',\n  '1.2.840.10008.5.1.4.34.6':'Unified Worklist and Procedure Step Service Class',\n  '1.2.840.10008.5.1.4.34.6.1':'Unified Procedure Step - Push SOP Class',\n  '1.2.840.10008.5.1.4.34.6.2':'Unified Procedure Step - Watch SOP Class',\n  '1.2.840.10008.5.1.4.34.6.3':'Unified Procedure Step - Pull SOP Class',\n  '1.2.840.10008.5.1.4.34.6.4':'Unified Procedure Step - Event SOP Class',\n  '1.2.840.10008.5.1.4.34.7':'RT Beams Delivery Instruction Storage',\n  '1.2.840.10008.5.1.4.34.8':'RT Conventional Machine Verification',\n  '1.2.840.10008.5.1.4.34.9':'RT Ion Machine Verification',\n  '1.2.840.10008.5.1.4.37.1':'General Relevant Patient Information Query',\n  '1.2.840.10008.5.1.4.37.2':'Breast Imaging Relevant Patient Information Query',\n  '1.2.840.10008.5.1.4.37.3':'Cardiac Relevant Patient Information Query',\n  '1.2.840.10008.5.1.4.38.1':'Hanging Protocol Storage',\n  '1.2.840.10008.5.1.4.38.2':'Hanging Protocol Information Model - FIND',\n  '1.2.840.10008.5.1.4.38.3':'Hanging Protocol Information Model - MOVE',\n  '1.2.840.10008.5.1.4.38.4':'Hanging Protocol Information Model - GET',\n  '1.2.840.10008.5.1.4.39.1':'Color Palette Storage',\n  '1.2.840.10008.5.1.4.39.2':'Color Palette Information Model - FIND',\n  '1.2.840.10008.5.1.4.39.3':'Color Palette Information Model - MOVE',\n  '1.2.840.10008.5.1.4.39.4':'Color Palette Information Model - GET',\n  '1.2.840.10008.5.1.4.41':'Product Characteristics Query SOP Class',\n  '1.2.840.10008.5.1.4.42':'Substance Approval Query SOP Class',\n  '1.2.840.10008.5.1.4.43.1':'Generic Implant Template Storage',\n  '1.2.840.10008.5.1.4.43.2':'Generic Implant Template Information Model - FIND',\n  '1.2.840.10008.5.1.4.43.3':'Generic Implant Template Information Model - MOVE',\n  '1.2.840.10008.5.1.4.43.4':'Generic Implant Template Information Model - GET',\n  '1.2.840.10008.5.1.4.44.1':'Implant Assembly Template Storage',\n  '1.2.840.10008.5.1.4.44.2':'Implant Assembly Template Information Model - FIND',\n  '1.2.840.10008.5.1.4.44.3':'Implant Assembly Template Information Model - MOVE',\n  '1.2.840.10008.5.1.4.44.4':'Implant Assembly Template Information Model - GET',\n  '1.2.840.10008.5.1.4.45.1':'Implant Template Group Storage',\n  '1.2.840.10008.5.1.4.45.2':'Implant Template Group Information Model - FIND',\n  '1.2.840.10008.5.1.4.45.3':'Implant Template Group Information Model - MOVE',\n  '1.2.840.10008.5.1.4.45.4':'Implant Template Group Information Model - GET',\n  '1.2.840.10008.7.1.1':'Native DICOM Model',\n  '1.2.840.10008.7.1.2':'Abstract Multi-Dimensional Image Model',\n  '1.2.840.10008.8.1.1':'DICOM Content Mapping Resource',\n  '1.2.840.10008.15.0.3.1':'dicomDeviceName',\n  '1.2.840.10008.15.0.3.2':'dicomDescription',\n  '1.2.840.10008.15.0.3.3':'dicomManufacturer',\n  '1.2.840.10008.15.0.3.4':'dicomManufacturerModelName',\n  '1.2.840.10008.15.0.3.5':'dicomSoftwareVersion',\n  '1.2.840.10008.15.0.3.6':'dicomVendorData',\n  '1.2.840.10008.15.0.3.7':'dicomAETitle',\n  '1.2.840.10008.15.0.3.8':'dicomNetworkConnectionReference',\n  '1.2.840.10008.15.0.3.9':'dicomApplicationCluster',\n  '1.2.840.10008.15.0.3.10':'dicomAssociationInitiator',\n  '1.2.840.10008.15.0.3.11':'dicomAssociationAcceptor',\n  '1.2.840.10008.15.0.3.12':'dicomHostname',\n  '1.2.840.10008.15.0.3.13':'dicomPort',\n  '1.2.840.10008.15.0.3.14':'dicomSOPClass',\n  '1.2.840.10008.15.0.3.15':'dicomTransferRole',\n  '1.2.840.10008.15.0.3.16':'dicomTransferSyntax',\n  '1.2.840.10008.15.0.3.17':'dicomPrimaryDeviceType',\n  '1.2.840.10008.15.0.3.18':'dicomRelatedDeviceReference',\n  '1.2.840.10008.15.0.3.19':'dicomPreferredCalledAETitle',\n  '1.2.840.10008.15.0.3.20':'dicomTLSCyphersuite',\n  '1.2.840.10008.15.0.3.21':'dicomAuthorizedNodeCertificateReference',\n  '1.2.840.10008.15.0.3.22':'dicomThisNodeCertificateReference',\n  '1.2.840.10008.15.0.3.23':'dicomInstalled',\n  '1.2.840.10008.15.0.3.24':'dicomStationName',\n  '1.2.840.10008.15.0.3.25':'dicomDeviceSerialNumber',\n  '1.2.840.10008.15.0.3.26':'dicomInstitutionName',\n  '1.2.840.10008.15.0.3.27':'dicomInstitutionAddress',\n  '1.2.840.10008.15.0.3.28':'dicomInstitutionDepartmentName',\n  '1.2.840.10008.15.0.3.29':'dicomIssuerOfPatientID',\n  '1.2.840.10008.15.0.3.30':'dicomPreferredCallingAETitle',\n  '1.2.840.10008.15.0.3.31':'dicomSupportedCharacterSet',\n  '1.2.840.10008.15.0.4.1':'dicomConfigurationRoot',\n  '1.2.840.10008.15.0.4.2':'dicomDevicesRoot',\n  '1.2.840.10008.15.0.4.3':'dicomUniqueAETitlesRegistryRoot',\n  '1.2.840.10008.15.0.4.4':'dicomDevice',\n  '1.2.840.10008.15.0.4.5':'dicomNetworkAE',\n  '1.2.840.10008.15.0.4.6':'dicomNetworkConnection',\n  '1.2.840.10008.15.0.4.7':'dicomUniqueAETitle',\n  '1.2.840.10008.15.0.4.8':'dicomTransferCapability',\n  '1.2.840.10008.15.1.1':'Universal Coordinated Time',\n};\n","import React, { PureComponent } from 'react'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\n\r\nclass OpenUrlDlg extends PureComponent {\r\n\r\n  hide = () => {\r\n    this.props.onClose()\r\n  }\r\n\r\n  cancel = () => {\r\n    window.stop()\r\n    this.hide()\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Dialog\r\n            open={true}\r\n            onClose={this.hide}\r\n            aria-labelledby=\"alert-dialog-title\"\r\n        >\r\n            <DialogTitle id=\"alert-dialog-title\">{\"Downloading file ...\"}</DialogTitle>\r\n            <DialogContent>\r\n              <LinearProgress variant=\"determinate\" value={this.props.progress} color='secondary' />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={this.cancel}>\r\n                    Cancel\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default OpenUrlDlg\r\n","import React, { PureComponent } from 'react'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport { \r\n    mdiPlay,\r\n    mdiPause,\r\n    mdiSkipBackward,\r\n    mdiSkipForward,\r\n    mdiSkipNext,\r\n    mdiSkipPrevious,\r\n  } from '@mdi/js'\r\n\r\nconst iconColor = '#FFFFFF'\r\n\r\nclass CinePlayer extends PureComponent {\r\n    firstframe = () => {\r\n        this.props.runCinePlayer('firstframe') \r\n    }\r\n\r\n    previousframe = () => {\r\n        this.props.runCinePlayer('previousframe') \r\n    }\r\n\r\n    play = () => {\r\n        this.props.runCinePlayer('play') \r\n    }\r\n\r\n    pause = () => {\r\n        this.props.runCinePlayer('pause') \r\n    }\r\n\r\n    nextframe = () => {\r\n        this.props.runCinePlayer('nextframe') \r\n    }\r\n\r\n    lastframe = () => {\r\n        this.props.runCinePlayer('lastframe') \r\n    }\r\n\r\n    render() {\r\n        let play = null\r\n        if (!this.props.inPlay) {\r\n            play = <IconButton onClick={this.play}>\r\n                        <Icon path={mdiPlay} size={'1.5rem'} color={iconColor} />\r\n                   </IconButton>          \r\n        } else {\r\n            play = <IconButton onClick={this.pause}>\r\n                        <Icon path={mdiPause} size={'1.5rem'} color={iconColor} />\r\n                   </IconButton>  \r\n        }\r\n        return (\r\n            <div style={{ width:240, margin:'0 auto' }}>\r\n                <IconButton onClick={this.firstframe}>\r\n                    <Icon path={mdiSkipBackward} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n                <IconButton onClick={this.previousframe}>\r\n                    <Icon path={mdiSkipPrevious} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n                {play}\r\n                <IconButton onClick={this.nextframe}>\r\n                    <Icon path={mdiSkipNext} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n                <IconButton onClick={this.lastframe}>\r\n                    <Icon path={mdiSkipForward} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default CinePlayer\r\n","import Dexie from 'dexie'\r\n\r\nconst db = new Dexie('udvDB')\r\n\r\ndb.version(1).stores({ \r\n    measurement: '++id, sopinstanceuid, tool' \r\n})\r\n\r\ndb.open()\r\n\r\nexport default db\r\n","import { EPSILON } from './constants'\n\nexport const areEqual = (one, other, epsilon = EPSILON) => Math.abs(one - other) < epsilon\nexport const isNearlyZero = (v) => Math.abs(v) < EPSILON\nexport const toDegrees = radians => (radians * 180) / Math.PI\nexport const toRadians = degrees => (degrees * Math.PI) / 180\nexport const sum = arr => arr.reduce((acc, value) => acc + value, 0)\nexport const withoutElementAtIndex = (arr, index) => [ ...arr.slice(0, index), ...arr.slice(index + 1) ]\n\n\n","export const EPSILON = 0.000000001\r\n\r\n","import { sum, withoutElementAtIndex } from './utils'\r\n\r\nexport default class Matrix {\r\n\r\n    constructor(...rows) {\r\n        this.rows = rows\r\n    }\r\n\r\n    get(i, j) {\r\n        return this.rows[i][j]\r\n    }\r\n\r\n    columns() {\r\n        return this.rows[0].map((_, i) => this.rows.map(r => r[i]))\r\n    }\r\n\r\n    componentWiseOperation(func, { rows }) {\r\n        const newRows = rows.map((row, i) =>\r\n            row.map((element, j) => func(this.rows[i][j], element))\r\n        )\r\n        return new Matrix(...newRows)\r\n    }\r\n\r\n    add(other) {\r\n        return this.componentWiseOperation((a, b) => a + b, other)\r\n    }\r\n\r\n    subtract(other) {\r\n        return this.componentWiseOperation((a, b) => a - b, other)\r\n    }\r\n    \r\n    scaleBy(number) {\r\n        const newRows = this.rows.map(row => \r\n            row.map(element => element * number)\r\n        )\r\n        return new Matrix(...newRows)\r\n    }\r\n\r\n    multiply(other) {\r\n        if (this.rows[0].length !== other.rows.length) {\r\n            throw new Error('The number of columns of this matrix is not equal to the number of rows of the given matrix.')\r\n        }\r\n        const columns = other.columns()\r\n        const newRows = this.rows.map(row => \r\n            columns.map(column => sum(row.map((element, i) => element * column[i])))\r\n        )\r\n        return new Matrix(...newRows)\r\n    }\r\n\r\n    transpose() {\r\n        return new Matrix(...this.columns())\r\n    }\r\n\r\n    determinant() {\r\n        if (this.rows.length !== this.rows[0].length) {\r\n            throw new Error('Only matrices with the same number of rows and columns are supported.')\r\n        }\r\n        if (this.rows.length === 2) {\r\n            return this.rows[0][0] * this.rows[1][1] - this.rows[0][1] * this.rows[1][0]\r\n        }\r\n\r\n        const parts = this.rows[0].map((coef, index) => {\r\n            const matrixRows = this.rows.slice(1).map(row => [ ...row.slice(0, index), ...row.slice(index + 1)])\r\n            const matrix = new Matrix(...matrixRows)\r\n            const result = coef * matrix.determinant()\r\n            return index % 2 === 0 ? result : -result\r\n        })\r\n\r\n        return sum(parts)\r\n    }\r\n\r\n    toDimension(dimension) {\r\n        const zeros = new Array(dimension).fill(0)\r\n        const newRows = zeros.map((_, i) => zeros.map((__, j) => {\r\n            if (this.rows[i] && this.rows[i][j] !== undefined) {\r\n            return this.rows[i][j]\r\n            }\r\n            return i === j ? 1 : 0\r\n        }))\r\n        return new Matrix(...newRows)\r\n    }\r\n\r\n    components() {\r\n        return this.rows.reduce((acc, row) => [ ...acc, ...row], [])\r\n    }\r\n\r\n    map(func) {\r\n        return new Matrix(\r\n            ...this.rows.map((row, i) => row.map((element, j) => func(element, i, j)))\r\n        )\r\n    }\r\n\r\n    minor(i, j) {\r\n        const newRows = withoutElementAtIndex(this.rows, i)\r\n            .map(row => withoutElementAtIndex(row, j))\r\n\r\n        const matrix = new Matrix(...newRows)\r\n        return matrix.determinant()\r\n    }\r\n\r\n    cofactor(i, j) {\r\n        const sign = Math.pow(-1, i + j)\r\n        const minor = this.minor(i, j)\r\n        return sign * minor\r\n    }\r\n\r\n    adjugate() {\r\n        return this\r\n            .map((_, i, j) => this.cofactor(i, j))\r\n            .transpose()\r\n    }\r\n\r\n    inverse() {\r\n        const determinant = this.determinant()\r\n        if (determinant === 0) {\r\n            throw new Error(\"Determinant can't be  zero.\")\r\n        }\r\n        const adjugate = this.adjugate()\r\n        return adjugate.scaleBy(1 / determinant)\r\n    }\r\n\r\n}","import { isNearlyZero } from './utils'\r\n\r\nexport default class Vector {\r\n    \r\n    constructor(...components) {\r\n      this.components = components\r\n    }\r\n\r\n    static get zero() {\r\n        return new Vector(0, 0, 0)\r\n    }\r\n    \r\n    get x() {\r\n        return this.components[0]\r\n    }\r\n    \r\n    set x(n) {\r\n        this.components[0] = n\r\n    }\r\n\r\n    get y() {\r\n        return this.components[1]\r\n    } \r\n\r\n    set y(n) {\r\n        this.components[1] = n\r\n    } \r\n\r\n    get z() {\r\n        return this.components[2]\r\n    } \r\n\r\n    set z(n) {\r\n        this.components[2] = n\r\n    } \r\n\r\n    length() {\r\n        return Math.hypot(...this.components)\r\n    }\r\n\r\n    isZero() {\r\n        return this.components.reduce((acc, _, index) => acc && isNearlyZero(this.components[index]), true)\r\n    }\r\n\r\n    abs() {\r\n        return new Vector(\r\n            ...this.components.map(component => Math.abs(component))\r\n        )\r\n    }\r\n\r\n    round() {\r\n        return new Vector(\r\n            ...this.components.map(component => Math.round(component))\r\n        )\r\n    }\r\n\r\n    nearestAxis() {\r\n        const b = Vector.zero\r\n        const xabs = Math.abs(this.components[0])\r\n        const yabs = Math.abs(this.components[1])\r\n        const zabs = Math.abs(this.components[2])\r\n\r\n        if (xabs >= yabs && xabs >= zabs) b.x = (this.components[0] > 0.0) ? 1.0 : -1.0\r\n        else if (yabs >= zabs) b.y = (this.components[1] > 0.0) ? 1.0 : -1.0\r\n        else b.z = (this.components[2] > 0.0) ? 1.0 : -1.0\r\n\r\n        return b\r\n    }\r\n\r\n    toArray() {\r\n        return this.components\r\n    }\r\n\r\n    mul(number) {\r\n        return new Vector(\r\n            ...this.components.map(component => component * number)\r\n        )\r\n    }\r\n\r\n    add({ components }) {\r\n        return new Vector(\r\n            ...components.map((component, index) => this.components[index] + component)\r\n        )\r\n    }\r\n\r\n    sub({ components }) {\r\n        return new Vector(\r\n            ...components.map((component, index) => this.components[index] - component)\r\n        )\r\n    }\r\n\r\n    crossProduct({ components }) {\r\n        if (this.components.length !== 3) return // 3D vectors only\r\n        return new Vector(\r\n            this.components[1] * components[2] - this.components[2] * components[1],\r\n            this.components[2] * components[0] - this.components[0] * components[2],\r\n            this.components[0] * components[1] - this.components[1] * components[0]\r\n        )\r\n    }\r\n\r\n    dotProduct({ components }) {\r\n        return components.reduce((acc, component, index) => acc + component * this.components[index], 0)\r\n    }\r\n    \r\n}\r\n\r\n","import Vector from '../LinearAlgebra/Vector'\r\nimport Matrix from '../LinearAlgebra/Matrix'\r\n\r\nexport default class Point {\r\n    \r\n    constructor(...components) {\r\n      this.components = components\r\n    }\r\n    \r\n    static get zero() {\r\n        return new Point(0, 0, 0)\r\n    }\r\n    \r\n    get x() {\r\n        return this.components[0]\r\n    }\r\n    \r\n    set x(n) {\r\n        this.components[0] = n\r\n    }\r\n\r\n    get y() {\r\n        return this.components[1]\r\n    } \r\n\r\n    set y(n) {\r\n        this.components[1] = n\r\n    }   \r\n\r\n    get z() {\r\n        return this.components[2]\r\n    } \r\n\r\n    set z(n) {\r\n        this.components[2] = n\r\n    } \r\n\r\n    length() {\r\n        return Math.hypot(...this.components)\r\n    }\r\n\r\n    abs() {\r\n        return new Point(\r\n            ...this.components.map(component => Math.abs(component))\r\n        )\r\n    }\r\n\r\n    toVector() {\r\n        return new Vector(...this.components)\r\n    }\r\n\r\n    toMatrix() {\r\n        return new Matrix(...this.components.map(component => [component]))\r\n    } \r\n\r\n    distance(b) {\r\n        return Math.sqrt(this.components.reduce((acc, component, i) => acc + Math.pow(this.components[i]-b.components[i], 2), 0))\r\n    }\r\n\r\n    // return a Point = Point + Vector\r\n    add({ components }) {\r\n        return new Point(\r\n            ...components.map((component, index) => this.components[index] + component)\r\n        )\r\n    }\r\n\r\n    // return a Vector = Point - Point \r\n    sub({ components }) {\r\n        return new Vector(\r\n            ...components.map((component, index) => this.components[index] - component)\r\n        )\r\n    }\r\n\r\n}\r\n\r\n","\r\nexport default class Line {\r\n    \r\n    constructor(p1, p2) {\r\n      this.p1 = p1\r\n      this.p2 = p2\r\n      this.m = (p2.y-p1.y) / (p2.x-p1.x)\r\n      this.c =  p1.y - this.m * p1.x\r\n    }\r\n\r\n    length() {\r\n        return this.p1.distance(this.p2)\r\n    }\r\n\r\n    distance(line) {\r\n      const d = Math.abs(line.c - this.c) / Math.sqrt(1+Math.pow(this.m, 2))\r\n      if (isNaN(d)) return 0\r\n      else return d\r\n    }\r\n}","import Point from '../LinearAlgebra/Point'\r\nimport Vector from '../LinearAlgebra/Vector'\r\nimport Matrix from '../LinearAlgebra/Matrix'\r\n\r\nexport default class DicomGeometry {\r\n    constructor(image) {\r\n      this.image = image\r\n      // Image Position Patient - x, y, z of top hand corner\r\n      const ipp = this.image.data.string('x00200032').split('\\\\').map(v => parseFloat(v)) \r\n      // Image Orientation Patient - x, y, z of direction cosines of the first row and x, y, z of direction cosines of the first column\r\n      const iop = this.image.data.string('x00200037').split('\\\\').map(v => parseFloat(v)) \r\n\r\n      const pixelSpacing = this.image.data.string('x00280030').split('\\\\').map(v => parseFloat(v)) \r\n      this.spacingY = pixelSpacing[0]\r\n      this.spacingX = pixelSpacing[1]\r\n\r\n      this.rows = image.rows\r\n      this.cols = image.columns\r\n\r\n      this.lengthX = this.cols * this.spacingY\r\n      this.lengthY = this.rows * this.spacingX\r\n\r\n      this.rowDir = new Vector(iop[0], iop[1], iop[2]) \r\n      this.colDir = new Vector(iop[3], iop[4], iop[5]) \r\n\r\n      this.nrmDir = this.rowDir.crossProduct(this.colDir)\r\n\r\n      this.topLeft = new Point(ipp[0], ipp[1], ipp[2])\r\n      this.topRight = this.topLeft.add(this.rowDir.mul(this.spacingX * this.cols))\r\n      this.bottomLeft = this.topLeft.add(this.colDir.mul(this.spacingY * this.rows))\r\n      this.bottomRight = this.bottomLeft.add(this.topRight.sub(this.topLeft)) \r\n\r\n      this.transformImageToRcs = new Matrix(\r\n        [this.rowDir.x*this.spacingX, this.colDir.x*this.spacingY, this.nrmDir.x, this.topLeft.x],\r\n        [this.rowDir.y*this.spacingX, this.colDir.y*this.spacingY, this.nrmDir.y, this.topLeft.y],\r\n        [this.rowDir.z*this.spacingX, this.colDir.z*this.spacingY, this.nrmDir.z, this.topLeft.z],\r\n        [0,                           0,                           0,             1             ]\r\n      )  \r\n      this.transformRcsToImage = this.transformImageToRcs.inverse() \r\n\r\n      const p = this.nrmDir.round().abs()\r\n      if (p.x === 1)\r\n        this.orientation = 'sagittal'\r\n      else if (p.y === 1) \r\n        this.orientation = 'coronal'\r\n      else if (p.z === 1) \r\n        this.orientation = 'axial'   \r\n\r\n    }\r\n\r\n}","import React from \"react\"\nimport {connect} from 'react-redux'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Link from '@material-ui/core/Link'\nimport Typography from '@material-ui/core/Typography'\nimport Hammer from \"hammerjs\"\nimport * as cornerstone from \"cornerstone-core\"\nimport * as cornerstoneTools from \"cornerstone-tools\"\nimport * as cornerstoneMath from \"cornerstone-math\"\nimport * as cornerstoneFileImageLoader from \"cornerstone-file-image-loader\"\nimport * as cornerstoneWebImageLoader from \"cornerstone-web-image-loader\"\nimport * as cornerstoneWADOImageLoader from \"cornerstone-wado-image-loader\"\nimport * as dicomParser from 'dicom-parser'\nimport * as blobUtil from 'blob-util'\n//import * as math from 'mathjs'\nimport {uids} from '../constants/uids'\nimport { SETTINGS_SAVEAS } from '../constants/settings'\nimport OpenUrlDlg from './OpenUrlDlg'\nimport CinePlayer from './CinePlayer'\nimport { isMobile } from 'react-device-detect'\nimport { import as csTools } from 'cornerstone-tools'\nimport db from '../db/db'\nimport fs from '../fs/fs'\n//import { EPSILON } from '../LinearAlgebra/constants'\nimport Matrix from '../LinearAlgebra/Matrix'\nimport Point from '../LinearAlgebra/Point'\n//import Vector from '../LinearAlgebra/Vector'\nimport Line from '../LinearAlgebra/Line'\nimport DicomGeometry from '../DicomGeometry/DicomGeometry'\n\nimport { \n  areEqual, \n} from '../LinearAlgebra/utils'\n\nimport {\n  clearStore, \n  dcmIsOpen, \n  activeDcm, \n  dcmTool, \n  activeMeasurements,\n  doFsRefresh,\n  setDcmEnableTool,\n} from '../actions'\n\nimport {\n  getDicomIpp,\n  //getDicomFrameOfReferenceUID,\n  capitalize,  \n  getFileName,\n  getSettingsOverlay,  \n  getSettingsSaveInto,\n  isFileImage,\n  isFsFileImage,\n  isLocalizer,  \n  isUrlImage,\n  //objectIsEmpty,\n} from '../functions'\n\n\nconst scrollToIndex = csTools('util/scrollToIndex')\n\ncornerstoneTools.external.cornerstone = cornerstone\ncornerstoneTools.external.cornerstoneMath = cornerstoneMath\ncornerstoneFileImageLoader.external.cornerstone = cornerstone\ncornerstoneWebImageLoader.external.cornerstone = cornerstone\ncornerstoneWADOImageLoader.external.cornerstone = cornerstone\ncornerstoneWADOImageLoader.external.dicomParser = dicomParser\ncornerstoneTools.external.Hammer = Hammer\ncornerstoneTools.init({\n  globalToolSyncEnabled: true,\n})\n\nclass DicomViewer extends React.Component {\n    constructor(props) {\n      super(props)\n      this.files = null\n      this.filename = ''\n      this.localfile = null\n      this.localurl = null\n      this.fsItem = null\n      this.dicomImage = null\n      this.explorerIndex = 0\n      this.imageId = null\n      this.image = null\n      this.isDicom = false\n      this.layoutIndex = 0\n      this.numberOfFrames = 1\n      this.measurements = []\n      this.xSize = 0\n      this.ySize = 0\n      this.zSize = 0\n      this.volume = null\n      this.originImage = null\n      this.mprPlane = ''\n      this.sliceMax = 0\n      this.sliceIndex = 0\n      this.mpr = {}      \n      this.referenceLines = {}\n      this.shouldScroll = false\n    }\n\n    state = {\n      visibleOpenUrlDlg: false,\n      progress: null,\n      visibleCinePlayer: false,\n      errorOnOpenImage: null,\n      errorOnCors: false,\n      frame: 1,\n      inPlay: false,\n      viewport: null,\n    }\n\n    componentDidMount() {\n      //console.log('dicomviewer - componentDidMount: ')\n      this.props.runTool(this)\n      this.props.changeTool(this)\n      cornerstone.events.addEventListener('cornerstoneimageloaded', this.onImageLoaded)\n      const { dcmRef } = this.props\n      dcmRef(this)          \n      this.layoutIndex = this.props.index\n\n      document.getElementById(`viewer-${this.props.index}`).addEventListener(\"wheel\", this.handlerMouseScroll)\n    }\n\n    componentWillUnmount() {\n      this.props.runTool(undefined)\n      this.props.changeTool(undefined)\n      const { dcmRef } = this.props\n      dcmRef(undefined)            \n    }\n\n    componentDidUpdate(previousProps) {\n      //console.log('dicomviewer - componentDidUpdate: ')\n      const isOpen = this.props.isOpen[this.props.index]\n      if (this.props.layout !== previousProps.layout && isOpen) {\n        cornerstone.resize(this.dicomImage)\n      }\n    }\n  \n    handlerMouseScroll = (e) => {\n      if (this.shouldScroll) { \n        if (e.deltaY > 0) this.props.listOpenFilesNextFrame()\n        else if (e.deltaY < 0) this.props.listOpenFilesPreviousFrame()\n      }\n    }\n\n    onOpenUrl = (e) => {\n      const eventData = e.detail\n      this.setState({ progress: eventData.percentComplete })\n    }\n\n    showOpenUrlDlg = (url) => {\n      this.setState({ visibleOpenUrlDlg: true }, () => {\n        cornerstone.events.addEventListener('cornerstoneimageloadprogress', this.onOpenUrl)\n        this.loadImage(undefined, url)\n      })\n    }\n  \n    hideOpenUrlDlg = () => {\n      this.setState({ visibleOpenUrlDlg: false, progress: null })\n    }\n\n    measurementSave = (measure) => {\n      this.measurements.push(measure) \n    }\n\n    measurementClear = () => {\n      this.measurements.splice(0, this.measurements.length)\n    }\n\n    measurementRemove = (index) => {\n      //console.log('this.measurements: ', this.measurements)\n      this.measurements.splice(index, 1)\n    }    \n\n    getTransferSyntax = () => {\n      const value = this.image.data.string('x00020010')\n      return value + ' [' + uids[value] + ']'\n    }\n\n    getSopClass = () => {\n      const value = this.image.data.string('x00080016')\n      return value + ' [' + uids[value] + ']'\n    }\n\n    getSopInstanceUID = () => {\n      const value = this.image.data.string('x00080018')\n      return value\n    }\n\n    getPixelRepresentation = () => {\n      const value = this.image.data.uint16('x00280103')\n      if (value === undefined) return\n      return value + (value === 0 ? ' (unsigned)' : ' (signed)')\n    }\n\n    getPlanarConfiguration = () => {\n      const value = this.image.data.uint16('x00280006')\n      if (value === undefined) return \n      return value + (value === 0 ? ' (pixel)' : ' (plane)')\n    }\n\n    getDicomViewerElement = () => {\n      return document.getElementsByClassName('cornerstone-enabled-image')\n    }\n   \n    onImageLoaded = (e) => {\n      //console.log('cornerstoneimageloaded: ')\n      this.props.onLoadedImage()\n    }\n\n    // Listen for changes to the viewport so we can update the text overlays in the corner\n    onImageRendered = (e) => {\n      //console.log('cornerstoneimagerendered: ', e.target)\n\n      //const viewport = cornerstone.getViewport(this.dicomImage)\n      const viewport = cornerstone.getViewport(e.target)\n\n      document.getElementById(\n        `mrtopleft-${this.props.index}`\n      ).textContent = this.mprIsOrthogonalView() ? `${capitalize(this.mprPlane)}` : `${this.PatientsName}`\n\n      document.getElementById(\n        `mrtopright-${this.props.index}`\n      ).textContent = `${viewport.displayedArea.brhc.x}x${viewport.displayedArea.brhc.y}`\n\n      document.getElementById(\n        `mrbottomleft-${this.props.index}`\n      ).textContent = `WW/WC: ${Math.round(viewport.voi.windowWidth)}/${Math.round(viewport.voi.windowCenter)}`\n\n      document.getElementById(\n        `mrbottomright-${this.props.index}`\n      ).textContent = `Zoom: ${Math.round(viewport.scale.toFixed(2)*100)}%`\n\n      document.getElementById(\n        `mrtopcenter-${this.props.index}`\n      ).textContent = ``\n      document.getElementById(\n        `mrbottomcenter-${this.props.index}`\n      ).textContent = ``    \n      document.getElementById(\n        `mrleftcenter-${this.props.index}`\n      ).textContent = ``      \n      document.getElementById(\n        `mrrightcenter-${this.props.index}`\n      ).textContent = ``  \n\n      if (this.mprPlane === 'sagittal') {\n        document.getElementById(\n          `mrtopcenter-${this.props.index}`\n        ).textContent = `S`\n        document.getElementById(\n          `mrbottomcenter-${this.props.index}`\n        ).textContent = `I`    \n        document.getElementById(\n          `mrleftcenter-${this.props.index}`\n        ).textContent = `A`      \n        document.getElementById(\n          `mrrightcenter-${this.props.index}`\n        ).textContent = `P`  \n\n      } else if (this.mprPlane === 'axial') {\n        document.getElementById(\n          `mrtopcenter-${this.props.index}`\n        ).textContent = `A`\n        document.getElementById(\n          `mrbottomcenter-${this.props.index}`\n        ).textContent = `P`    \n        document.getElementById(\n          `mrleftcenter-${this.props.index}`\n        ).textContent = `R`      \n        document.getElementById(\n          `mrrightcenter-${this.props.index}`\n        ).textContent = `L`    \n\n      } else if (this.mprPlane === 'coronal') {\n        document.getElementById(\n          `mrtopcenter-${this.props.index}`\n        ).textContent = `S`\n        document.getElementById(\n          `mrbottomcenter-${this.props.index}`\n        ).textContent = `I`    \n        document.getElementById(\n          `mrleftcenter-${this.props.index}`\n        ).textContent = `R`      \n        document.getElementById(\n          `mrrightcenter-${this.props.index}`\n        ).textContent = `L`                    \n      }    \n\n      if (this.referenceLines.isScoutDraw) {\n        this.referenceLines.isScoutDraw = false\n        this.referenceLinesDraw()\n      }\n\n      if (this.mpr.isSliceLocation) {\n        this.mpr.isSliceLocation = false\n        this.mprSliceLocationDraw()\n      }\n\n      if (this.isDicom && this.state.visibleCinePlayer && this.numberOfFrames > 1) {\n        document.getElementById(\n          `frameLabel-${this.props.index}`\n        ).textContent = `${this.state.frame} / ${this.numberOfFrames}`\n        if (this.state.inPlay) {\n          let frame = this.state.frame === this.numberOfFrames ? 1 : this.state.frame+1\n          this.setState({frame: frame})\n        }\n      }\n\n      this.props.onRenderedImage(this.props.index)\n    }\n\n    onMeasurementModified = (e) => {\n      //console.log('cornerstonetoolsmeasurementmodified: ', e.detail.measurementData)\n      \n    }\n\n    onMeasurementAdded = (e) => {\n      //console.log('cornerstonetoolsmeasurementadded: ', e.detail.measurementData)\n      if (this.props.tool !== \"Angle\") return\n      const measure = {\n        tool: this.props.tool,\n        note: '',\n        data: e.detail.measurementData\n      }\n      this.measurementSave(measure)\n      this.props.setActiveMeasurements(this.measurements)      \n    }\n\n    onMeasurementCompleted = (e) => {\n      //console.log('cornerstonetoolsmeasurementcompleted: ', e.detail.measurementData)\n      const measure = {\n        tool: this.props.tool,\n        note: '',\n        data: e.detail.measurementData\n      }\n      if (this.props.tool === \"FreehandRoi\") {\n        setTimeout(() => {\n          this.measurementSave(measure)\n          this.props.setActiveMeasurements(this.measurements)\n        }, 500)\n      } else {\n        this.measurementSave(measure)\n        this.props.setActiveMeasurements(this.measurements)\n      }\n    }\n    \n    onErrorOpenImageClose = () => {\n      this.setState({errorOnOpenImage: null})\n    }\n\n    onErrorCorsClose = () => {\n      this.setState({errorOnCors: false})\n    }    \n\n    updateImage = () => {\n      const element = this.dicomImage\n      cornerstone.updateImage(element)\n    }\n\n    displayImageFromFiles = (index) => {\n      //console.log('displayImageFromFiles: ', index)\n\n      const files = this.files === null ? this.props.files : this.files\n\n      const image = files[index].image\n      const imageId = files[index].imageId\n      this.filename = files[index].name\n      this.sliceIndex = index\n\n      const element = this.dicomImage\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      element.addEventListener(\"cornerstonetoolsmeasurementadded\", this.onMeasurementAdded)\n      element.addEventListener(\"cornerstonetoolsmeasurementmodified\", this.onMeasurementModified)\n      element.addEventListener(\"cornerstonetoolsmeasurementcompleted\", this.onMeasurementCompleted)\n      cornerstone.enable(element)\n\n      this.image = image\n\n      this.isDicom = true\n      \n      this.PatientsName = image.data.string('x00100010')\n      this.sopInstanceUid = this.getSopInstanceUID()\n\n      let stack = { currentImageIdIndex: 0, imageIds: \"\" }\n      this.numberOfFrames = image.data.intString('x00280008')\n      if (this.numberOfFrames > 0) {\n        let imageIds = []\t\n        for(var i=0; i < this.numberOfFrames; ++i) {\n          imageIds.push(imageId + \"?frame=\"+i)\n        }\t\n        stack.imageIds = imageIds\n      }\n\n      cornerstone.displayImage(element, image)\n\n      this.mprPlanePosition()\n      \n      this.enableTool()\n\n      if (this.numberOfFrames > 1) {\n        cornerstoneTools.addStackStateManager(element, ['stack', 'playClip']);    \n        cornerstoneTools.addToolState(element, 'stack', stack)\n        this.setState({frame: 1})\n      }\n     \n      // Load the possible measurements from DB and save in the store \n      db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).each(measure => {\n        //console.log('load measure from db: ', measure)\n        this.measurementSave(measure)\n        cornerstoneTools.addToolState(element, measure.tool, measure.data)\n        this.runTool(measure.tool)\n        cornerstone.updateImage(element)\n        cornerstoneTools.setToolEnabled(measure.tool)\n      }).then(() => {\n        //if (this.useIsNormal) {\n          this.props.setActiveMeasurements(this.measurements)\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})      \n          this.props.setIsOpenStore({index: this.props.index, value: true})         \n        //} \n      })   \n      \n    }\n\n    loadImageFromCanvas = (canvas) => {\n      //console.log('loadImageFromCanvas, dcmViewer: ', this.props.index)\n\n      const element = this.dicomImage\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      element.addEventListener(\"cornerstonetoolsmeasurementadded\", this.onMeasurementAdded)\n      element.addEventListener(\"cornerstonetoolsmeasurementmodified\", this.onMeasurementModified)\n      element.addEventListener(\"cornerstonetoolsmeasurementcompleted\", this.onMeasurementCompleted)\n      cornerstone.enable(element)\n\n      const imageId = cornerstoneFileImageLoader.fileManager.addCanvas(canvas)\n\n      cornerstone.loadImage(imageId).then(image => {\n        this.image = image\n\n        this.isDicom = false\n\n        cornerstone.displayImage(element, image)\n\n        this.enableTool()\n\n        this.props.setIsOpenStore({index: this.props.index, value: true})\n\n      }, (e) => {\n        console.log('error', e)\n        this.setState({errorOnOpenImage: \"This is not a valid canvas.\"})\n      })\n    }\n\n    loadImageFromCustomObject = (columns, rows, pixelData) => {\n      //console.log('loadImageFromCustomObject: ')\n\n      const element = this.dicomImage\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      element.addEventListener(\"cornerstonetoolsmeasurementadded\", this.onMeasurementAdded)\n      element.addEventListener(\"cornerstonetoolsmeasurementmodified\", this.onMeasurementModified)\n      element.addEventListener(\"cornerstonetoolsmeasurementcompleted\", this.onMeasurementCompleted)\n      cornerstone.enable(element)\n      \n      let customObj = {\n        rows: rows,\n        columns: columns,\n        pixelData: pixelData,\n        image: this.originImage,\n      }\n\n      const imageId = cornerstoneFileImageLoader.fileManager.addCustom(customObj)\n\n      cornerstone.loadImage(imageId).then(image => {\n        this.image = image\n        this.isDicom = true\n\n        cornerstone.displayImage(element, image)\n\n        //this.enableTool()\n\n        this.props.setIsOpenStore({index: this.props.index, value: true})\n\n      }, (e) => {\n        console.log('error', e)\n        this.setState({errorOnOpenImage: \"This is not a valid canvas.\"})\n      })\n    }\n\n    loadImage = (localfile, url=undefined, fsItem=undefined) => {\n      //console.log('loadImage, localfile: ', localfile)\n      //console.log('loadImage, fsItem: ', fsItem)\n      //console.log('loadImage, url: ', url)\n\n      if (localfile === undefined && url === undefined && fsItem === undefined) return\n      \n      if (fsItem !== undefined) {\n        this.fsItem = fsItem\n      } else if (localfile !== undefined) {\n        this.localfile = localfile\n      } else {\n        this.localurl = url\n      }\n \n      const element = this.dicomImage\n\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      element.addEventListener(\"cornerstonetoolsmeasurementadded\", this.onMeasurementAdded)\n      element.addEventListener(\"cornerstonetoolsmeasurementmodified\", this.onMeasurementModified)\n      element.addEventListener(\"cornerstonetoolsmeasurementcompleted\", this.onMeasurementCompleted)\n\n      let imageId = undefined\n\n      cornerstone.enable(element)\n\n      let size = 0\n\n      if (localfile === undefined && isUrlImage(url)) { // check if it's a simple image [jpeg or png] from url\n        //console.log('image: ', file)\n        cornerstone.loadImage(url).then(image => {\n          //console.log('loadImage, image from url: ', image)\n\n          this.hideOpenUrlDlg()\n\n          this.image = image\n\n          this.isDicom = false\n\n          cornerstone.displayImage(element, image)\n          \n          this.enableTool()\n\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n          this.props.isOpenStore(true)\n\n        }, (e) => {\n          console.log('error', e)\n          this.setState({errorOnOpenImage: \"This is not a valid JPG or PNG file.\"})\n        })\n\n      } else if ((localfile !== undefined && isFileImage(localfile)) || (fsItem !== undefined && isFsFileImage(fsItem))) { // otherwise try to open as local image file (JPEG, PNG) \n        if (fsItem !== undefined) {\n          imageId = cornerstoneFileImageLoader.fileManager.addBuffer(fsItem.data)\n        } else {\n          imageId = cornerstoneFileImageLoader.fileManager.add(localfile)\n        }\n        cornerstone.loadImage(imageId).then(image => {\n          console.log('loadImage, image from local: ', image)\n\n          this.image = image\n          this.isDicom = false\n          this.PatientsName = ''\n\n          cornerstone.displayImage(element, image)\n          \n          this.enableTool()\n\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n          //this.props.isOpenStore(true)\n          this.props.setIsOpenStore({index: this.props.index, value: true})\n\n        }, (e) => {\n          console.log('error', e)\n          this.setState({errorOnOpenImage: \"This is not a valid JPG or PNG file.\"})\n        })\n\n      } else { // otherwise try to open as Dicom file\n\n        if (fsItem !== undefined) {\n          imageId = cornerstoneWADOImageLoader.wadouri.fileManager.addBuffer(fsItem.data)\n          this.filename = fsItem.name\n          size = fsItem.size\n        } else if (localfile !== undefined) {\n          imageId = cornerstoneWADOImageLoader.wadouri.fileManager.add(localfile)\n          this.filename = localfile.name\n          size = localfile.size\n        } else { // it's a web dicom image\n          imageId = \"wadouri:\"+url\n        }\n  \n        //console.log('loadImage, imageId: ', imageId)\n\n        cornerstone.loadAndCacheImage(imageId).then(image => {\n          //console.log('loadImage, image: ', image)\n          //let pixelDataElement = image.data.elements.x7fe00010\n          //console.log('loadImage, pixelDataElement: ', pixelDataElement)\n          //console.log('loadImage, getPixelData: ', image.getPixelData())\n          \n          this.hideOpenUrlDlg()\n\n          this.image = image\n\n          this.isDicom = true\n\n          this.PatientsName = image.data.string('x00100010')\n          this.sopInstanceUid = this.getSopInstanceUID()\n\n          let stack = { currentImageIdIndex: 0, imageIds: \"\" }\n          this.numberOfFrames = image.data.intString('x00280008')\n          if (this.numberOfFrames > 0) {\n            let imageIds = []\t\n            for(var i=0; i < this.numberOfFrames; ++i) {\n              imageIds.push(imageId + \"?frame=\"+i)\n            }\t\n            stack.imageIds = imageIds\n          }\n\n          cornerstone.displayImage(element, image)\n          //cornerstoneTools.mouseInput.enable(element);\n          //cornerstoneTools.mouseWheelInput.enable(element);\n\n          this.enableTool()\n\n          if (this.numberOfFrames > 1) {\n            cornerstoneTools.addStackStateManager(element, ['stack', 'playClip']);    \n            cornerstoneTools.addToolState(element, 'stack', stack)\n            //cornerstoneTools.setToolActive('StackScrollMouseWheel', { })\n            this.setState({frame: 1})\n          }\n  \n          // Load the possible measurements from DB and save in the store \n          db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).each(measure => {\n            //console.log('load measure from db: ', measure)\n            //this.props.measurementStore(measure)\n            this.measurementSave(measure)\n            cornerstoneTools.addToolState(element, measure.tool, measure.data)\n            this.runTool(measure.tool)\n            cornerstone.updateImage(element)\n            cornerstoneTools.setToolEnabled(measure.tool)\n          }).then(() => {\n            //console.log('this.measurements: ', this.measurements)\n            this.props.setActiveMeasurements(this.measurements)\n            this.props.setActiveDcm({name: this.filename, size: size, image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n            this.props.setIsOpenStore({index: this.props.index, value: true})            \n          })       \n\n        }, (e) => {\n          console.log('error', e)   \n          this.hideOpenUrlDlg()      \n          //console.log('toString: ', e.error.toString())\n          const error = e.error.toString()\n          if (error === '[object XMLHttpRequest]') {\n            this.setState({errorOnCors: true})\n          } else {\n            const pos = error.indexOf(\":\")\n            this.setState({errorOnOpenImage: pos < 0 ? e.error : error.substring(pos+1)})            \n          } \n        })\n      }\n    }\n  \n    enableTool = (toolName, mouseButtonNumber) => {\n      if (this.props.dcmEnableTool) return\n      // Enable all tools we want to use with this element\n      const WwwcTool = cornerstoneTools.WwwcTool\n      const LengthTool = cornerstoneTools['LengthTool']\n      const PanTool = cornerstoneTools.PanTool\n      const ZoomTouchPinchTool = cornerstoneTools.ZoomTouchPinchTool\n      const ZoomTool = cornerstoneTools.ZoomTool\n      const ProbeTool = cornerstoneTools.ProbeTool\n      const EllipticalRoiTool = cornerstoneTools.EllipticalRoiTool\n      const RectangleRoiTool = cornerstoneTools.RectangleRoiTool\n      const FreehandRoiTool = cornerstoneTools.FreehandRoiTool\n      const AngleTool = cornerstoneTools.AngleTool\n      const MagnifyTool = cornerstoneTools.MagnifyTool\n      const StackScrollMouseWheelTool = cornerstoneTools.StackScrollMouseWheelTool\n\n      cornerstoneTools.addTool(MagnifyTool)\n      cornerstoneTools.addTool(AngleTool)    \n      cornerstoneTools.addTool(WwwcTool)\n      cornerstoneTools.addTool(LengthTool)\n      cornerstoneTools.addTool(PanTool)\n      cornerstoneTools.addTool(ZoomTouchPinchTool)\n      cornerstoneTools.addTool(ZoomTool)\n      cornerstoneTools.addTool(ProbeTool)\n      cornerstoneTools.addTool(EllipticalRoiTool)\n      cornerstoneTools.addTool(RectangleRoiTool)\n      cornerstoneTools.addTool(FreehandRoiTool)\n      cornerstoneTools.addTool(StackScrollMouseWheelTool)   \n      \n      this.props.setDcmEnableToolStore(true)\n    }\n  \n    // helper function used by the tool button handlers to disable the active tool\n    // before making a new tool active\n    disableAllTools = () => {\n      this.props.setDcmEnableToolStore(false)\n      cornerstoneTools.setToolEnabled('Length')\n      cornerstoneTools.setToolEnabled('Pan')\n      cornerstoneTools.setToolEnabled('Magnify')\n      cornerstoneTools.setToolEnabled('Angle')\n      cornerstoneTools.setToolEnabled('RectangleRoi')\n      cornerstoneTools.setToolEnabled('Wwwc')\n      cornerstoneTools.setToolEnabled('ZoomTouchPinch')\n      cornerstoneTools.setToolEnabled('Probe')\n      cornerstoneTools.setToolEnabled('EllipticalRoi')\n      cornerstoneTools.setToolEnabled('FreehandRoi')\n      cornerstoneTools.setToolEnabled('StackScrollMouseWheel')\n    }\n  \n    runTool = (toolName, opt) => {\n      //console.log(`runTool: ${toolName}, ${opt}`)\n      if (this.state.inPlay) {\n        this.runCinePlayer('pause')\n      }\n      switch (toolName) {\n        case 'setfiles': {\n          this.files = opt\n          this.sliceMax = this.files.length\n          this.shouldScroll = this.files.length > 1\n          break   \n        }        \n        case 'openimage': {\n          cornerstone.disable(this.dicomImage)\n          this.displayImageFromFiles(opt)\n          break   \n        }\n        case 'openLocalFs': {\n          cornerstone.disable(this.dicomImage)\n          this.loadImage(opt)\n          break   \n        } \n        case 'openSandboxFs': {\n          cornerstone.disable(this.dicomImage)\n          this.loadImage(undefined, undefined, opt)\n          break   \n        }         \n        case 'openurl': {\n          this.showOpenUrlDlg(opt)\n          break                 \n        }\n        case 'clear': {\n          this.setState({ visibleCinePlayer: false })\n          this.mprPlane = ''\n          this.files = null\n          this.props.setIsOpenStore({index: this.props.index, value: false}) \n          cornerstone.disable(this.dicomImage)\n          break\n        }  \n        case 'notool': {\n          this.disableAllTools()\n          break\n        }\n        case 'Wwwc': {\n          cornerstoneTools.setToolActive('Wwwc', { mouseButtonMask: 1 })\n          break\n        }  \n        case 'Pan': {\n          cornerstoneTools.setToolActive('Pan', { mouseButtonMask: 1 })\n          break   \n        }  \n        case 'Zoom': {\n          cornerstoneTools.setToolActive(isMobile ? 'ZoomTouchPinch' : 'Zoom', { mouseButtonMask: 1 })\n          break\n        }\n        case 'Length': {\n          cornerstoneTools.setToolActive('Length', isMobile ? { isTouchActive: true } : { mouseButtonMask: 1 })\n          break  \n        }\n        case 'Probe': {\n            cornerstoneTools.setToolActive('Probe', { mouseButtonMask: 1 })\n          break\n        }\n        case 'EllipticalRoi': {\n          cornerstoneTools.setToolActive('EllipticalRoi', { mouseButtonMask: 1 })\n          break   \n        }\n        case 'RectangleRoi': {\n          cornerstoneTools.setToolActive('RectangleRoi', { mouseButtonMask: 1 })\n          break  \n        }\n        case 'Angle': {\n          cornerstoneTools.setToolActive('Angle', { mouseButtonMask: 1 })\n          break \n        }\n        case 'Magnify': {\n          cornerstoneTools.setToolActive('Magnify', { mouseButtonMask: 1 })\n          break  \n        }\n        case 'FreehandRoi': {\n          cornerstoneTools.setToolActive('FreehandRoi', { mouseButtonMask: 1 })\n          break \n        }\n        case 'Invert': {\n          const element = this.dicomImage\n          const viewport = cornerstone.getViewport(element)\n          viewport.invert = !viewport.invert\n          cornerstone.setViewport(element, viewport)\n          break \n        }         \n        case 'saveas': {\n            let type = localStorage.getItem(SETTINGS_SAVEAS)\n            if (getSettingsSaveInto() === 'local') {\n              // cornerstoneTools.SaveAs(this.dicomImage, `${this.filename}.${type}`, `image/${type}`)   \n              const element = this.dicomImage\n              const viewport = cornerstone.getViewport(element)\n              const canvas = document.getElementsByClassName('cornerstone-canvas')[this.props.activeDcmIndex]\n              const zoom = viewport.scale.toFixed(2)\n              const cols = this.image.columns * zoom\n              const rows = this.image.rows * zoom\n\n              let myCanvas = document.createElement('canvas')\n              myCanvas = this.cropCanvas(canvas, \n                Math.round(canvas.width / 2 - cols / 2), \n                Math.round(canvas.height / 2 - rows / 2), \n                cols, rows)   \n\n              let a = document.createElement(\"a\")\n              a.href = myCanvas.toDataURL(`image/${type}`)\n              a.download = `${this.filename}.${type}`    \n              document.body.appendChild(a) // Required for this to work in FireFox\n              a.click()           \n\n            } else { // store image into sandbox file system\n              const element = this.dicomImage\n              const viewport = cornerstone.getViewport(element)\n              const canvas = document.getElementsByClassName('cornerstone-canvas')[this.props.activeDcmIndex]\n              const zoom = viewport.scale.toFixed(2)\n              const cols = this.image.columns * zoom\n              const rows = this.image.rows * zoom\n\n              let myCanvas = document.createElement('canvas')\n              myCanvas = this.cropCanvas(canvas, \n                Math.round(canvas.width / 2 - cols / 2), \n                Math.round(canvas.height / 2 - rows / 2), \n                cols, rows)           \n              \n              blobUtil.canvasToBlob(myCanvas, `image/${type}`).then(blob => {\n                blobUtil.blobToArrayBuffer(blob).then(arrayBuffer => {\n                  const name = `${getFileName(this.filename)}-MPR-${this.mprPlane}`     \n                  let newName = name\n                  let counter = 1\n                  let done = false             \n                  do {\n                      let filename = `${newName}.${type}`\n                      const checkName = this.props.fsCurrentList.find(e => e.name === filename)\n                      if (checkName === undefined) {\n                          fs.transaction('rw', fs.files, async () => {\n                              await fs.files.add({\n                                  parent: this.props.fsCurrentDir,\n                                  name: filename,\n                                  type: type,\n                                  size: arrayBuffer.byteLength,\n                                  data: arrayBuffer\n                              })\n                          }).then(() => {\n                            this.props.makeFsRefresh()\n                          })\n                          done = true\n                      } else {\n                          newName = `${name} - ${counter}`\n                          counter++\n                      }\n                  } while (!done)\n                })\n              })\n            }  \n          break\n        }\n        case 'cine': {\n          this.setState({ visibleCinePlayer: !this.state.visibleCinePlayer })\n          break\n        }\n        case 'reset': {\n          this.reset()\n          break\n        }\n        case 'removetool': {\n          //console.log('removetool index: ', opt)\n          const element = this.dicomImage\n          cornerstoneTools.removeToolState(element, this.measurements[opt].tool, this.measurements[opt].data)\n          cornerstone.updateImage(element)\n          //this.props.measurementRemoveStore(opt)\n          this.measurementRemove(opt)\n          this.props.setActiveMeasurements(this.measurements)\n          break\n        }  \n        case 'removetools': {   \n          const element = this.dicomImage\n          // for each measurement remove it \n          this.measurements.forEach(measure => {\n            cornerstoneTools.clearToolState(element, measure.tool)         \n          })\n          cornerstone.updateImage(element)\n          this.measurementClear()\n          // also remove all measurements from db\n          db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).delete()\n          this.props.setActiveMeasurements(this.measurements)\n          break\n        }  \n        case 'savetools': {\n          // first, remove eventually previous measurements from db\n          db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).delete()\n          // then save all the current measurements\n          this.measurements.forEach(measure => {\n            try {\n              db.measurement.add({\n                sopinstanceuid: this.sopInstanceUid, \n                tool: measure.tool,\n                note: measure.note,\n                data: measure.data\n              })\n            } catch(error) {\n              console.error(error)\n            }                       \n          })\n          break\n        }\n        default: {\n          break\n        }\n      }\n    } \n\n    cropCanvas = (canvas, x, y, width, height) => {\n      // create a temp canvas\n      const newCanvas = document.createElement('canvas')\n      // set its dimensions\n      newCanvas.width = width\n      newCanvas.height = height\n      // draw the canvas in the new resized temp canvas \n      newCanvas.getContext('2d').drawImage(canvas, x, y, width, height, 0, 0, width, height)\n      return newCanvas\n    }\n\n    changeTool = (toolName, value) => {\n      //console.log('change tool, value: ', toolName, value)\n\n      switch (toolName) {\n        case 'Wwwc':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Wwwc', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Wwwc')\n          }\n          break  \n        case 'Pan':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Pan', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Pan')\n          }\n          break    \n        case 'Zoom':\n          if (value === 1) {\n            cornerstoneTools.setToolActive(isMobile ? 'ZoomTouchPinch' : 'Zoom', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive(isMobile ? 'ZoomTouchPinch' : 'Zoom')\n          }\n          break                             \n        case 'Length':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Length', isMobile ? { isTouchActive: true } : { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Length')\n          }\n          break   \n        case 'Probe':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Probe', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Probe')\n          }\n          break        \n        case 'Angle':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Angle', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Angle')\n          }          \n          break   \n        case 'Magnify':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Magnify', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Magnify')\n          }          \n          break        \n        case 'EllipticalRoi':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('EllipticalRoi', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('EllipticalRoi')\n          }\n          break   \n        case 'RectangleRoi':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('RectangleRoi', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('RectangleRoi')\n          }\n          break\n        case 'FreehandRoi':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('FreehandRoi', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('FreehandRoi')\n          }\n          break     \n        default:\n            break\n        }  \n    }\n\n    runCinePlayer = (cmdName) => {\n      //console.log('this.state.frame: ', this.state.frame)\n      const element = this.dicomImage\n      switch (cmdName) {\n        case 'firstframe': {\n          let frame = 1\n          this.setState({frame: frame})\n          scrollToIndex(element, 0)\n          break\n        }\n        case 'previousframe': {\n          if (this.state.frame > 1) {\n            let frame = this.state.frame-1\n            this.setState({frame: frame})     \n            scrollToIndex(element, frame-1)       \n          }\n          break\n        }\n        case 'play': {\n          cornerstoneTools.playClip(element, 30)\n          this.setState({inPlay: true})\n          break\n        }\n        case 'pause': {\n            cornerstoneTools.stopClip(element)\n            this.setState({inPlay: false})\n          break\n        }\n        case 'nextframe': {\n          if (this.state.frame < this.numberOfFrames) {\n            let frame = this.state.frame+1\n            this.setState({frame: frame})            \n            scrollToIndex(element, frame-1)\n          }\n          break  \n        }\n        case 'lastframe': {\n          let frame = this.numberOfFrames\n          this.setState({frame: frame})   \n          scrollToIndex(element, frame-1)      \n          break    \n        }                       \n        default:\n          break\n      }\n    }\n\n    reset = () => {\n      const element = this.dicomImage\n      const defaultViewport = cornerstone.getDefaultViewportForImage(element, this.image)\n      let viewport = cornerstone.getViewport(element)\n      viewport.voi.windowWidth = defaultViewport.voi.windowWidth\n      viewport.voi.windowCenter = defaultViewport.voi.windowCenter\n      viewport.invert = false\n      cornerstone.setViewport(element, viewport)\n    }\n\n    // -------------------------------------------------------------------------------------------- MPR\n    //#region MPR\n\n    mprPlanePosition = () => {\n      try {\n        if (!this.isDicom) return this.mprPlane\n        const image = this.files[0].image\n        const imageOrientation = image.data.string('x00200037').split('\\\\')\n        let v = new Array(6).fill(0)\n        v[0] = parseFloat(imageOrientation[0]) // the x direction cosines of the first row X\n        v[1] = parseFloat(imageOrientation[1]) // the y direction cosines of the first row X\n        v[2] = parseFloat(imageOrientation[2]) // the z direction cosines of the first row X\n        v[3] = parseFloat(imageOrientation[3]) // the x direction cosines of the first column Y\n        v[4] = parseFloat(imageOrientation[4]) // the y direction cosines of the first column Y\n        v[5] = parseFloat(imageOrientation[5]) // the z direction cosines of the first column Y    \n        v = v.map((x) => Math.round(x))\n        let p = [v[1]*v[5] - v[2]*v[4], v[2]*v[3] - v[0]*v[5], v[0]*v[4] - v[1]*v[3]] // cross product of X x Y\n        p = p.map((x) => Math.abs(x))\n        if (p[0] === 1) {\n          this.mprPlane = 'sagittal'\n        } else if (p[1] === 1) {\n          this.mprPlane = 'coronal'\n        } else if (p[2] === 1) {\n          this.mprPlane = 'axial'\n        }\n      } catch(error) { // it's not possible to build MPR\n        this.mprPlane = ''\n      } \n      return this.mprPlane \n    }\n\n    transpose = (matrix) => {\n      return Object.keys(matrix[0]).map(colNumber => matrix.map(rowNumber => rowNumber[colNumber]));\n    }\n\n    mprRenderYZPlane = (filename, origin, x, mprData) => {\n      if (this.volume === null) return\n      \n      this.mprData = mprData\n\n      const files = this.files === null ? this.props.files : this.files\n\n      this.sliceIndex = x\n      \n      this.filename = filename\n      cornerstone.disable(this.dicomImage)\n\n      if (origin === 'sagittal') \n        this.mprPlane = 'coronal'\n      else if (origin === 'axial') \n        this.mprPlane = 'sagittal'\n      else\n        this.mprPlane = 'sagittal'\n\n      this.xSize = files[0].columns\n      this.ySize = files[0].rows \n      this.zSize = mprData.zDim\n\n      const i = Math.round(x / this.xSize * files.length)\n      this.originImage = files[i].image\n\n      if (origin === 'sagittal') {\n        let xoffset = Math.floor(this.xSize / 2) - Math.floor(this.zSize / 2)\n        let plane = new Int16Array(this.xSize * this.ySize)\n        for (let y = 0; y < this.ySize; y++) \n          for (let z = 0; z < this.zSize; z++) \n            plane[z + this.ySize * y + xoffset] = this.volume[z][x + this.ySize * y]        \n        this.loadImageFromCustomObject(this.xSize, this.ySize, plane)\n\n      } else if (origin === 'coronal') {\n        let xoffset = Math.floor(this.xSize / 2) - Math.floor(this.zSize / 2)\n        let plane = new Int16Array(this.xSize * this.ySize)\n        for (let y = 0; y < this.ySize; y++) \n          for (let z = 0; z < this.zSize; z++) \n            plane[z + this.ySize * y + xoffset] = this.volume[z][x + this.ySize * y]        \n        this.loadImageFromCustomObject(this.xSize, this.ySize, plane)\n\n      } else { // axial\n        const yzPlane = this.mprBuildYZPlane(x)\n        this.loadImageFromCustomObject(this.ySize, this.zSize, yzPlane)\n      }\n    }\n\n    mprBuildYZPlane = (x) => {\n      //console.log(`mprBuildYZPlane, ySize: ${this.ySize}, zSize: ${this.zSize} `)\n      let plane = new Int16Array(this.ySize * this.zSize)\n      for (var y = 0; y < this.ySize; y++) \n        for (var z = 0; z < this.zSize; z++) \n          plane[y + this.ySize * z] = this.volume[z][x + this.ySize * y]\n      return plane\n    }\n\n    mprRenderXZPlane = (filename, origin, y, mprData) => {\n      if (this.volume === null) return\n\n      this.mprData = mprData\n\n      const files = this.files === null ? this.props.files : this.files\n      \n      this.sliceIndex = y\n\n      this.filename = filename\n      cornerstone.disable(this.dicomImage)\n\n      if (origin === 'sagittal') \n        this.mprPlane = 'axial'\n      else if (origin === 'axial') \n        this.mprPlane = 'coronal'\n      else\n        this.mprPlane = 'axial'\n\n      this.xSize = files[0].columns\n      this.ySize = files[0].rows\n      this.zSize = mprData.zDim\n\n      const i = Math.trunc(y / this.ySize * files.length)\n      this.originImage = files[i].image\n\n      if (origin === 'sagittal') {\n        let xoffset = Math.floor(this.xSize / 2) - Math.floor(this.zSize / 2)\n        let plane = new Int16Array(this.xSize * this.ySize)\n        for (let x = 0; x < this.xSize; x++) \n          for (let z = 0; z < this.zSize; z++)\n            plane[z + this.xSize * x + xoffset] = this.volume[z][x + this.xSize * y] \n        this.loadImageFromCustomObject(this.xSize, this.ySize, plane)\n\n      } else {\n        const xzPlane = this.mprBuildXZPlane(y)\n        this.loadImageFromCustomObject(this.xSize, this.zSize, xzPlane)\n      }\n    }\n  \n    mprBuildXZPlane = (y) => {\n      //console.log(`mprBuildXZPlane, xSize: ${this.xSize}, zSize: ${this.zSize} `)\n      let plane = new Int16Array(this.xSize * this.zSize)\n      for (let x = 0; x < this.xSize; x++) \n        for (let z = 0; z < this.zSize; z++)\n          plane[x + this.xSize * z] = this.volume[z][x + this.xSize * y] \n      //console.log('mprBuildXZPlane, plane: ', plane)    \n      return plane\n    }  \n\n    mprIsOrthogonalView = () => {\n      //console.log('mprIsOrthogonalView: ', this.mprPlane)\n      return (this.mprPlane !== '' && this.props.layout[0] === 1 && this.props.layout[1] === 3)\n    }\n\n    mprSliceLocation = (index) => {\n      console.log('mprSliceLocationDraw: ', index)\n      console.log('mprData: ',  this.mprData)\n      this.mpr.sliceLocation = {}\n      if (this.mprData.plane.from === 'axial') {\n        this.mpr.sliceLocation.p0 = new Point(10, index*this.mprData.zStep)\n        this.mpr.sliceLocation.p1 = new Point(this.xSize-10, index*this.mprData.zStep)\n        this.mpr.sliceLocation.p2 = new Point(this.xSize-10, (index+1)*this.mprData.zStep)\n        this.mpr.sliceLocation.p3 = new Point(10, (index+1)*this.mprData.zStep)\n      } else if (this.mprData.plane.from === 'sagittal') {\n        const start = Math.round((this.xSize - this.zSize) / 2)\n        this.mpr.sliceLocation.p0 = new Point(start+index*this.mprData.zStep, 10)\n        this.mpr.sliceLocation.p1 = new Point(start+index*this.mprData.zStep, this.ySize-10)\n        this.mpr.sliceLocation.p2 = new Point(start+(index+1)*this.mprData.zStep, this.ySize-10)\n        this.mpr.sliceLocation.p3 = new Point(start+(index+1)*this.mprData.zStep, 10)\n      } else { // from coronal\n        if (this.mprPlane === 'axial') {\n          this.mpr.sliceLocation.p0 = new Point(10, index*this.mprData.zStep)\n          this.mpr.sliceLocation.p1 = new Point(this.xSize-10, index*this.mprData.zStep)\n          this.mpr.sliceLocation.p2 = new Point(this.xSize-10, (index+1)*this.mprData.zStep)\n          this.mpr.sliceLocation.p3 = new Point(10, (index+1)*this.mprData.zStep)\n        } else { // to sagittal\n          const start = Math.round((this.xSize - this.zSize) / 2)\n          this.mpr.sliceLocation.p0 = new Point(start+index*this.mprData.zStep, 10)\n          this.mpr.sliceLocation.p1 = new Point(start+index*this.mprData.zStep, this.ySize-10)\n          this.mpr.sliceLocation.p2 = new Point(start+(index+1)*this.mprData.zStep, this.ySize-10)\n          this.mpr.sliceLocation.p3 = new Point(start+(index+1)*this.mprData.zStep, 10)          \n        }\n      } \n      this.mpr.isSliceLocation = true\n      this.updateImage()\n    }\n\n    mprSliceLocationDraw = (index) => {\n      const canvas = document.getElementById(`viewer-${this.props.index}`).getElementsByClassName('cornerstone-canvas')[0]\n      const ctxH = canvas.getContext(\"2d\")\n      const p0 = this.mpr.sliceLocation.p0\n      const p1 = this.mpr.sliceLocation.p1\n      const p2 = this.mpr.sliceLocation.p2\n      const p3 = this.mpr.sliceLocation.p3\n      ctxH.beginPath()\n      ctxH.setLineDash([])\n      ctxH.strokeStyle = 'rgba(105, 105, 250, 0.5)'\n      ctxH.moveTo(p0.x, p0.y)\n      ctxH.lineTo(p1.x, p1.y)\n      ctxH.lineTo(p2.x, p2.y)\n      ctxH.lineTo(p3.x, p3.y)\n      ctxH.lineTo(p0.x, p0.y)\n      ctxH.lineWidth = 1\n      ctxH.stroke()\n    }\n\n    //#endregion\n\n    // -------------------------------------------------------------------------------------------- REFERENCE LINES\n    //#region REFERENCE LINES\n\n    // see https://stackoverflow.com/questions/10241062/how-to-draw-scout-reference-lines-in-dicom\n    //     http://www.dclunie.com/dicom3tools/workinprogress/dcpost.cc\n    // \n    referenceLinesBuild = (srcImage) => {\n      //console.log('referenceLinesBuild - srcImage: ', srcImage)\n      \n      this.referenceLines.dst = new DicomGeometry(this.image)\n      //console.log('this.referenceLines.dst: ', this.referenceLines.dst)\n      this.referenceLines.src = new DicomGeometry(srcImage)\n      //console.log('this.referenceLines.src: ', this.referenceLines.src)\n\n      this.referenceLines.isReferenceLine = this.referenceLines.dst.orientation !== undefined &&\n                                            this.referenceLines.src.orientation !== undefined && \n                                            this.referenceLines.dst.orientation !== this.referenceLines.src.orientation\n\n      this.referenceLines.isScoutDraw = true\n\n      this.updateImage()\n\n    }\n\n    referenceLinesBuildLine = () => {\n      const dst = this.referenceLines.dst\n      const src = this.referenceLines.src\n\n      const nP = dst.nrmDir.dotProduct(dst.topLeft)\n      const nA = dst.nrmDir.dotProduct(src.topLeft)\n      const nB = dst.nrmDir.dotProduct(src.topRight)\n      const nC = dst.nrmDir.dotProduct(src.bottomRight)\n      const nD = dst.nrmDir.dotProduct(src.bottomLeft)\n\n      let list = []\n\n      if (!areEqual(nB, nA)) {\n        const t = (nP - nA) / (nB - nA)\n        if (t > 0 && t <= 1) \n          list.push(src.topLeft.add((src.topRight.sub(src.topLeft)).mul(t)))\n      }\n\n      if (!areEqual(nC, nB)) { \n        const t = (nP - nB) / (nC - nB)\n        if (t > 0 && t <= 1)\n          list.push(src.topRight.add((src.bottomRight.sub(src.topRight)).mul(t)))\n      }\n        \n      if (!areEqual(nD, nC)) { \n        const t = (nP - nC) / (nD - nC)\n        if (t > 0 && t <= 1)\n          list.push(src.bottomRight.add((src.bottomLeft.sub(src.bottomRight)).mul(t)))\n      }\n\n      if (!areEqual(nA, nD)) { \n        const t = (nP - nD) / (nA - nD)\n        if (t > 0 && t <= 1)\n          list.push(src.bottomLeft.add((src.topLeft.sub(src.bottomLeft)).mul(t)))\n      }\n\n      // the destinationplane should have been crossed exactly two times\n      if (list.length !== 2)\n        return \n\n      // now back from 3D patient space to 2D pixel space\n      const p = {\n        startPoint: this.transformDstPatientPointToImage(list[0]),\n        endPoint:   this.transformDstPatientPointToImage(list[1])\n      }\n      return p      \n    }\n\n    transformDstPatientPointToImage = (p) => {\n      const v = new Matrix(\n        [p.x], \n        [p.y], \n        [p.z], \n        [1]\n      )\n      const transformed = this.referenceLines.dst.transformRcsToImage.multiply(v)\n      // validation, if the point is within the image plane, then the z-component of the transformed point should be zero\n      const point = new Point(Math.round(transformed.get(0,0)), Math.round(transformed.get(1,0)))\n      return point\n    }\n\n    referenceLinesBuildPlane = () => {\n      const dst = this.referenceLines.dst \n      const src = this.referenceLines.src \n\n      let pos = []\n\n      // TLHC is what is in ImagePositionPatient\n      pos[0] = src.topLeft\n      // TRHC\n      pos[1] = src.topLeft.add(src.rowDir.mul(src.lengthX))\n      // BRHC\n      pos[2] = src.topLeft.add((src.rowDir.mul(src.lengthX)).add(src.colDir.mul(src.lengthY)))\n      // BLHC\n      pos[3] = src.topLeft.add(src.colDir.mul(src.lengthY))\n\n      let pixel = []\n\n      let rotation = new Matrix(\n        dst.rowDir.toArray(),\n        dst.colDir.toArray(),\n        dst.nrmDir.toArray()\n      )\n\n      for (let i = 0; i < 4; i++) {            \n          // move everything to origin of target\n          pos[i] = pos[i].add(Point.zero.sub(dst.topLeft))\n\n          // The rotation is easy ... just rotate by the row, col and normal vectors ...\n          const m = rotation.multiply(pos[i].toMatrix())\n          pos[i] = new Point(Math.round(m.get(0,0)), Math.round(m.get(1,0)), Math.round(m.get(2,0))) \n\n          // DICOM coordinates are center of pixel 1\\1\n          pixel[i] = new Point(Math.trunc(pos[i].x / dst.spacingY + 0.5),\n                               Math.trunc(pos[i].y / dst.spacingX + 0.5))\n      }         \n\n      //console.log('referenceLinesBuildPlane: ', pixel)\n      return pixel\n    }\n\n    referenceLinesDraw = () => {\n      if (!this.referenceLines.isReferenceLine) return\n\n      const canvas = document.getElementById(`viewer-${this.props.index}`).getElementsByClassName('cornerstone-canvas')[0]\n      const ctxH = canvas.getContext(\"2d\")\n\n      this.referenceLines.plane = this.referenceLinesBuildPlane()\n\n      this.referenceLines.line = this.referenceLinesBuildLine()\n\n      const line = this.referenceLines.line\n      \n      ctxH.beginPath()\n      ctxH.setLineDash([])\n      ctxH.strokeStyle = 'rgba(255, 255, 51, 0.5)'\n      ctxH.moveTo(line.startPoint.x, line.startPoint.y)\n      ctxH.lineTo(line.endPoint.x, line.endPoint.y)\n      ctxH.lineWidth = 1\n      ctxH.stroke()\n\n      const plane = this.referenceLines.plane\n\n      const d = Math.max(this.referenceLines.dst.rows, this.referenceLines.dst.cols) / 30\n      //console.log('d: ', d)\n\n      const line0 = new Line(plane[0], plane[1])\n      //console.log('line0: ', line0)\n      const line1 = new Line(plane[1], plane[2])\n      //console.log('line1: ', line1)\n      const line2 = new Line(plane[2], plane[3])\n      //console.log('line2: ', line2)\n      const line3 = new Line(plane[3], plane[0])\n      //console.log('line3: ', line3)\n\n      //console.log('d 0-2: ', line0.distance(line2))\n      //console.log('d 1-3: ', line1.distance(line3))\n\n      if (Math.min(line0.distance(line2), line1.distance(line3)) < d) return\n\n      ctxH.beginPath()\n      ctxH.setLineDash([3, 3])\n      ctxH.strokeStyle = 'rgba(135, 206, 250, 0.5)'\n      ctxH.moveTo(plane[0].x, plane[0].y)\n      ctxH.lineTo(plane[1].x, plane[1].y)\n      ctxH.lineTo(plane[2].x, plane[2].y)\n      ctxH.lineTo(plane[3].x, plane[3].y)\n      ctxH.lineTo(plane[0].x, plane[0].y)\n      ctxH.lineWidth = 1\n      ctxH.stroke()\n    }\n    \n    //#endregion\n\n\n    dicomImageRef = el => {\n      this.dicomImage = el\n    }\n\n    onImageClick = () => {\n      //console.log('onImageClick: ')\n    }\n\n    isLocalizer = () => {\n      return isLocalizer(this.image)\n    }\n\n    findFirstSliceWithIppValue = (ippValue, ippPos) => {\n      const increasing = this.files[0].sliceDistance - this.files[this.files.length-1].sliceDistance < 0\n      //console.log('DicomViewer - findFirstSliceWithIppValue, ippValue: ', ippValue)\n      for(let i=0; i < this.files.length; i++) {\n        const ipp = getDicomIpp(this.files[i].image, ippPos)\n        //console.log(`DicomViewer - findFirstSliceWithIppValue, i: ${i}, ipp: ${ipp}`)\n        if (increasing) {\n          if (ipp >= ippValue) return i          \n        } else {\n          if (ipp <= ippValue) return i          \n        }\n      }\n      return -1\n    }\n\n    render() {\n\n      const visible = this.props.visible ? 'visible' : 'hidden'\n      const isOpen = this.props.isOpen[this.props.index]\n      const visibleOpenUrlDlg = this.state.visibleOpenUrlDlg\n      const errorOnOpenImage = this.state.errorOnOpenImage\n      const progress = this.state.progress\n\n      const styleContainer = {\n        width: '100%', \n        height: '100%', \n        border: (this.props.activeDcmIndex === this.props.index && (this.props.layout[0] > 1 || this.props.layout[1] > 1)) ? 'solid 1px #AAAAAA' : null,\n        position: 'relative',\n      }\n\n      const styleDicomImage = {\n        width: '100%', \n        height: '100%', \n        position: 'relative',\n      }\n\n      const overlay = getSettingsOverlay() && this.props.overlay\n\n      return ( \n        <div className=\"container\" style={styleContainer} >\n\n          {visibleOpenUrlDlg ? <OpenUrlDlg progress={progress} onClose={this.hideOpenUrlDlg} /> : null}\n\n          <Dialog\n            open={errorOnOpenImage !== null}\n            onClose={this.onErrorOpenImageClose}\n          >\n            <DialogTitle id=\"alert-dialog-title\">{\"Error on opening image\"}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                {this.state.errorOnOpenImage}\n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={this.onErrorOpenImageClose} autoFocus>\n                Ok\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <Dialog\n            open={this.state.errorOnCors}\n            onClose={this.onErrorCorsClose}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n          >\n            <DialogTitle id=\"alert-dialog-title\">{\"Error on loading image\"}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                <Typography gutterBottom>\n                  CORS or Cross Origin Resource Sharing is a browser security policy \n                  that prevents javascript from loading data from a server with a different base URL \n                  than the server that served up the javascript file. \n                </Typography> \n                <Typography gutterBottom>\n                  See the &nbsp; \n                  <Link href=\"http://enable-cors.org/\" target='_blank' color='textPrimary'>\n                    Enable CORS site\n                  </Link>\n                  &nbsp; for information about CORS.                     \n                </Typography>                                \n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={this.onErrorCorsClose} autoFocus>\n                Ok\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <div\n            style={{\n              width: '100%', \n              height: '100%', \n              position: \"relative\",\n              color:  '#FFFFFF',\n              fontSize: '1.00em',\n              textShadow: '1px 1px #000000',\n              visibility: visible\n            }}\n            onContextMenu={() => false}\n            className=\"cornerstone-enabled-image\"\n          >\n\n            <div \n              id={`viewer-${this.props.index}`}\n              ref={this.dicomImageRef} style={styleDicomImage}\n            >\n            </div>\n\n            <div\n              id={`mrtopleft-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, left: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n             \n            </div>\n            <div\n              id={`mrtopright-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, right: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>\n            <div\n              id={`mrbottomright-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, right: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>\n            <div\n              id={`mrbottomleft-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, left: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>   \n\n            <div\n              id={`mrtopcenter-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, width: '60px', left: '50%', marginLeft: '0px', display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>\n\n            <div\n              id={`mrleftcenter-${this.props.index}`}\n              style={{ position: \"absolute\", top: '50%', width: '30px', left: 3, marginLeft: '0px', display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>    \n\n            <div\n              id={`mrrightcenter-${this.props.index}`}\n              style={{ position: \"absolute\", top: '50%', width: '30px', right: 3, marginRight: '-20px', display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>                \n\n            <div\n              id={`mrbottomcenter-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, width: '60px', left: '50%', marginLeft: '0px', display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              \n            </div>\n\n            { this.state.visibleCinePlayer && this.numberOfFrames > 1 ? (\n              <div style={{position:\"absolute\", width:'100%', bottom:0, textAlign:'center'}}>\n                <div style={{margin:'0 auto', width:'240px', backgroundColor:'rgba(136, 136, 136, 0.5)'}}>\n                  <CinePlayer runCinePlayer={this.runCinePlayer} inPlay={this.state.inPlay} />  \n                  <div \n                    id={`frameLabel-${this.props.index}`}\n                    style={{ width:230, margin:'0 auto', marginTop:-10, textAlign:\"center\" }}\n                  >\n                    {this.state.frame} / {this.numberOfFrames}\n                  </div> \n                </div>               \n              </div> \n              ) : null\n            }\n          </div>\n        </div>\n      )\n    }\n  }\n  \nconst mapStateToProps = (state) => {\n  return {\n    files: state.files,\n    series: state.series,\n    url: state.url,\n    isOpen: state.isOpen,\n    tool: state.tool,\n    activeDcmIndex: state.activeDcmIndex,\n    activeDcm: state.activeDcm,\n    explorerActiveSeriesIndex: state.explorerActiveSeriesIndex,\n    measurements: state.measurements,\n    layout: state.layout,\n    fsCurrentDir: state.fsCurrentDir,\n    fsCurrentList: state.fsCurrentList,\n    volume: state.volume,\n    dcmEnableTool: state.dcmEnableTool,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    clearingStore: () => dispatch(clearStore()),\n    setIsOpenStore: (value) => dispatch(dcmIsOpen(value)),\n    toolStore: (tool) => dispatch(dcmTool(tool)),\n    setActiveDcm: (dcm) => dispatch(activeDcm(dcm)),\n    setActiveMeasurements: (measurements) => dispatch(activeMeasurements(measurements)),\n    makeFsRefresh: (dcm) => dispatch(doFsRefresh()),\n    setDcmEnableToolStore: (value) => dispatch(setDcmEnableTool(value))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DicomViewer)\n","import React from 'react'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport { SETTINGS_DCMHEADER } from '../constants/settings'\r\nimport { toCsv } from '../functions'\r\nimport 'react-perfect-scrollbar/dist/css/styles.css'\r\nimport PerfectScrollbar from 'react-perfect-scrollbar'\r\nimport {\r\n    mdiContentSaveOutline\r\n} from '@mdi/js'\r\n\r\nconst DicomHeader = ({dcmViewer, classes, color}) => {\r\n    let header = []\r\n    header.push({name: 'Transfer Syntax', value: dcmViewer.getTransferSyntax()})\r\n    header.push({name: 'SOP Class', value: dcmViewer.getSopClass()})\r\n    header.push({name: 'SOP Instance UID', value: dcmViewer.getSopInstanceUID()})\r\n    header.push({name: 'Modality', value: dcmViewer.image.data.string('x00080060')})\r\n    header.push({name: 'Manufacturer', value: dcmViewer.image.data.string('x00080070')})\r\n    header.push({name: 'Study Description', value: dcmViewer.image.data.string('x00081030')})\r\n    header.push({name: 'Series Description', value: dcmViewer.image.data.string('x0008103E')})\r\n    header.push({name: 'Patient Name', value: dcmViewer.image.data.string('x00100010')})\r\n    header.push({name: 'Frame Rate', value: dcmViewer.image.data.string('x00082144')})\r\n\r\n    header.push({name: 'MR Acquisition Type', value: dcmViewer.image.data.string('x00180023')})\r\n    header.push({name: 'Slice Thickness', value: dcmViewer.image.data.string('x00180050')})\r\n    header.push({name: 'Spacing Between Slice', value: dcmViewer.image.data.string('x00180088')})\r\n    header.push({name: 'Patient Position', value: dcmViewer.image.data.string('x00185100')})\r\n\r\n    header.push({name: 'Study ID', value: dcmViewer.image.data.string('x00200010')})\r\n    header.push({name: 'Series Number', value: dcmViewer.image.data.string('x00200011')})\r\n    header.push({name: 'Acquisition Number', value: dcmViewer.image.data.string('x00200012')})\r\n    header.push({name: 'Instance Number', value: dcmViewer.image.data.string('x00200013')})\r\n    header.push({name: 'Image Position (Patient)', value: dcmViewer.image.data.string('x00200032')})\r\n    header.push({name: 'Image Orientation (Patient)', value: dcmViewer.image.data.string('x00200037')})\r\n    header.push({name: 'Images in Acquisition', value: dcmViewer.image.data.string('x00201002')}) \r\n    header.push({name: 'Slice Location', value: dcmViewer.image.data.string('x00201041')})        \r\n\r\n    header.push({name: 'Samples per Pixel', value: dcmViewer.image.data.uint16('x00280002')})\r\n    header.push({name: 'Photometric Interpretation', value: dcmViewer.image.data.string('x00280004')})\r\n    header.push({name: 'Number of Frames', value: dcmViewer.image.data.string('x00280008')})\r\n    header.push({name: 'Planar Configuration', value: dcmViewer.getPlanarConfiguration()})\r\n    header.push({name: 'Rows', value: dcmViewer.image.data.uint16('x00280010')})\r\n    header.push({name: 'Columns', value: dcmViewer.image.data.uint16('x00280011')})\r\n    header.push({name: 'Pixel Spacing', value: dcmViewer.image.data.string('x00280030')})\r\n    header.push({name: 'Bits Allocated', value: dcmViewer.image.data.uint16('x00280100')})\r\n    header.push({name: 'Bits Stored', value: dcmViewer.image.data.uint16('x00280101')})\r\n    header.push({name: 'High Bit', value: dcmViewer.image.data.uint16('x00280102')})\r\n    header.push({name: 'Pixel Representation', value: dcmViewer.getPixelRepresentation()})\r\n    header.push({name: 'Window Center', value: dcmViewer.image.data.string('x00281050')})\r\n    header.push({name: 'Window Width', value: dcmViewer.image.data.string('x00281051')})\r\n    header.push({name: 'Rescale Intercept', value: dcmViewer.image.data.string('x00281052')})\r\n    header.push({name: 'Rescale Slope', value: dcmViewer.image.data.string('x00281053')})\r\n    header.push({name: 'Min Stored Pixel Value', value: dcmViewer.image.minPixelValue})\r\n    header.push({name: 'Max Stored Pixel Value', value: dcmViewer.image.maxPixelValue})\r\n\r\n    header.push({name: 'Image Orientation', value: dcmViewer.image.data.string('x00700042')})\r\n    header.push({name: 'Image Horizontal Flip', value: dcmViewer.image.data.string('x00700041')})\r\n\r\n    const listItems = header.map((item, index) => {\r\n        if (item.value !== undefined) \r\n            return (\r\n                <ListItem dense={true} key={index}>\r\n                    <ListItemText primary={item.name} secondary={item.value} />\r\n                </ListItem>\r\n            ) \r\n        else return null\r\n    })\r\n\r\n    const saveHeader = () => {\r\n        let exportAs = localStorage.getItem(SETTINGS_DCMHEADER)\r\n        if (exportAs === null) {\r\n          exportAs = \"json\"\r\n          localStorage.setItem(SETTINGS_DCMHEADER, exportAs)\r\n        }  \r\n    \r\n        let fileData = ''\r\n        \r\n        if (exportAs === 'csv') {\r\n          fileData = toCsv(header)\r\n        } else {\r\n          const obj = header.reduce((o, item) => ({ ...o, [item.name]: item.value}), {})\r\n          fileData = JSON.stringify(obj)\r\n        }\r\n        \r\n        const element = document.createElement(\"a\")\r\n        const file = new Blob([fileData], {type: 'text/plain'})\r\n        element.href = URL.createObjectURL(file)\r\n        element.download = `${dcmViewer.localfile.name}.${exportAs}`\r\n        document.body.appendChild(element) // Required for this to work in FireFox\r\n        element.click()\r\n    }\r\n\r\n    console.log('dcmViewer', dcmViewer)\r\n\r\n    return (\r\n      <PerfectScrollbar>\r\n        <div style={{marginTop: '48px'}}>\r\n          <Toolbar variant=\"dense\">\r\n            <Typography variant=\"subtitle1\" className={classes.title}>\r\n              Dicom Header\r\n            </Typography>\r\n            <div className={classes.grow} />\r\n            <IconButton color=\"inherit\" onClick={saveHeader}>\r\n              <Icon path={mdiContentSaveOutline} size={'1.2rem'} color={color} />\r\n            </IconButton>\r\n          </Toolbar>    \r\n          <div>          \r\n            <List dense={true} component=\"div\">\r\n                {listItems}             \r\n            </List>\r\n          </div>      \r\n        </div>\r\n      </PerfectScrollbar>\r\n    )\r\n}\r\n  \r\nexport default DicomHeader\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport axios from 'axios'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport {\r\n  setZippedFile,\r\n} from '../actions/index'\r\n\r\nconst CancelToken = axios.CancelToken\r\nconst source = CancelToken.source()\r\n\r\nclass DownloadZipDlg extends PureComponent {\r\n\r\n  state = {\r\n    loading: 0\r\n  }\r\n\r\n  componentDidMount(previousProps) {\r\n    this.requestDownloadZip()\r\n  }\r\n\r\n  hide = () => {\r\n    this.props.onClose()\r\n  }\r\n\r\n  cancel = () => {\r\n    source.cancel('Operation canceled by the user.')\r\n    this.hide()\r\n  }\r\n\r\n  requestDownloadZip = () => {\r\n    console.log('this.props.url', this.props.url)\r\n    this.setState({loading: 0})\r\n    axios({\r\n      method: 'get',\r\n      url: this.props.url,\r\n      responseType: 'arraybuffer',\r\n      cancelToken: source.token,\r\n      onDownloadProgress: (progressEvent) => {\r\n        const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n        this.setState({ loading: percentCompleted })\r\n        console.log('loading: ', percentCompleted)\r\n      },\r\n    }).then((response) => {\r\n        console.log('response: ', response)\r\n        this.props.setFsZippedFile(response.data)\r\n        this.hide()\r\n    }).catch((error) => {\r\n      console.log('error: ', error)\r\n    })\r\n  }\r\n  \r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Dialog\r\n            open={true}\r\n            onClose={this.hide}\r\n        >\r\n            <DialogTitle>{\"Downloading zip archive...\"}</DialogTitle>\r\n            <DialogContent>\r\n              <LinearProgress variant=\"determinate\" value={this.state.loading} color='secondary' />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={this.cancel}>\r\n                    Cancel\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setFsZippedFile: (file) => dispatch(setZippedFile(file))\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(DownloadZipDlg)\r\n","import React from \"react\"\nimport {connect} from 'react-redux'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Link from '@material-ui/core/Link'\nimport Typography from '@material-ui/core/Typography'\nimport * as cornerstone from \"cornerstone-core\"\nimport * as cornerstoneFileImageLoader from \"cornerstone-file-image-loader\"\nimport * as cornerstoneWADOImageLoader from \"cornerstone-wado-image-loader\"\nimport {uids} from '../constants/uids'\nimport OpenUrlDlg from './OpenUrlDlg'\n\nimport {\n  clearStore, \n  dcmIsOpen, \n  activeDcm, \n  dcmTool, \n  activeMeasurements,\n  doFsRefresh,\n  setDcmEnableTool,\n} from '../actions'\n\nimport {\n  isFileImage,\n  isFsFileImage,\n  isUrlImage,\n} from '../functions'\n\nclass DicomPreviewer extends React.Component {\n    constructor(props) {\n      super(props)\n      this.files = null\n      this.filename = ''\n      this.localfile = null\n      this.localurl = null\n      this.fsItem = null\n      this.dicomImage = null\n      this.explorerIndex = 0\n      this.imageId = null\n      this.image = null\n      this.isDicom = false\n      this.numberOfFrames = 1\n      this.measurements = []\n      this.originImage = null\n      this.mprPlane = ''\n      this.sliceMax = 0\n      this.sliceIndex = 0\n      this.shouldScroll = false\n    }\n\n    state = {\n      visibleOpenUrlDlg: false,\n      progress: null,\n      visibleCinePlayer: false,\n      errorOnOpenImage: null,\n      errorOnCors: false,\n      frame: 1,\n      inPlay: false,\n      viewport: null,\n    }\n\n    componentDidMount() {\n      this.props.runTool(this)\n      const { dcmRef } = this.props\n      dcmRef(this)          \n    }\n\n    componentWillUnmount() {\n      this.props.runTool(undefined)\n      const { dcmRef } = this.props\n      dcmRef(undefined)            \n    }\n\n    componentDidUpdate(previousProps) {\n      //console.log('dicomviewer - componentDidUpdate: ')\n    }\n\n    onOpenUrl = (e) => {\n      const eventData = e.detail\n      this.setState({ progress: eventData.percentComplete })\n    }\n\n    showOpenUrlDlg = (url) => {\n      this.setState({ visibleOpenUrlDlg: true }, () => {\n        cornerstone.events.addEventListener('cornerstoneimageloadprogress', this.onOpenUrl)\n        this.loadImage(undefined, url)\n      })\n    }\n  \n    hideOpenUrlDlg = () => {\n      this.setState({ visibleOpenUrlDlg: false, progress: null })\n    }\n\n    measurementSave = (measure) => {\n      this.measurements.push(measure) \n    }\n\n    measurementClear = () => {\n      this.measurements.splice(0, this.measurements.length)\n    }\n\n    measurementRemove = (index) => {\n      this.measurements.splice(index, 1)\n    }    \n\n    getTransferSyntax = () => {\n      const value = this.image.data.string('x00020010')\n      return value + ' [' + uids[value] + ']'\n    }\n\n    getSopClass = () => {\n      const value = this.image.data.string('x00080016')\n      return value + ' [' + uids[value] + ']'\n    }\n\n    getSopInstanceUID = () => {\n      const value = this.image.data.string('x00080018')\n      return value\n    }\n\n    getPixelRepresentation = () => {\n      const value = this.image.data.uint16('x00280103')\n      if (value === undefined) return\n      return value + (value === 0 ? ' (unsigned)' : ' (signed)')\n    }\n\n    getPlanarConfiguration = () => {\n      const value = this.image.data.uint16('x00280006')\n      if (value === undefined) return \n      return value + (value === 0 ? ' (pixel)' : ' (plane)')\n    }\n\n    getDicomViewerElement = () => {\n      return document.getElementsByClassName('cornerstone-enabled-image')\n    }\n   \n    onImageLoaded = (e) => {\n      //console.log('cornerstoneimageloaded: ')\n    }\n\n    // Listen for changes to the viewport so we can update the text overlays in the corner\n    onImageRendered = (e) => {\n      if (this.isDicom && this.state.visibleCinePlayer && this.numberOfFrames > 1) {\n        document.getElementById(\n          `frameLabel-${this.props.index}`\n        ).textContent = `${this.state.frame} / ${this.numberOfFrames}`\n        if (this.state.inPlay) {\n          let frame = this.state.frame === this.numberOfFrames ? 1 : this.state.frame+1\n          this.setState({frame: frame})\n        }\n      }\n    }\n\n    onErrorOpenImageClose = () => {\n      this.setState({errorOnOpenImage: null})\n    }\n\n    onErrorCorsClose = () => {\n      this.setState({errorOnCors: false})\n    }    \n\n    updateImage = () => {\n      const element = this.dicomImage\n      cornerstone.updateImage(element)\n    }\n\n    displayImageFromFiles = (index) => {\n\n      const files = this.files === null ? this.props.files : this.files\n\n      const image = files[index].image\n      const imageId = files[index].imageId\n      this.filename = files[index].name\n\n      const element = this.dicomImage\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      cornerstone.enable(element)\n\n      this.image = image\n\n      this.isDicom = true\n      \n      this.PatientsName = image.data.string('x00100010')\n      this.sopInstanceUid = this.getSopInstanceUID()\n\n      let stack = { currentImageIdIndex: 0, imageIds: \"\" }\n      this.numberOfFrames = image.data.intString('x00280008')\n      if (this.numberOfFrames > 0) {\n        let imageIds = []\t\n        for(var i=0; i < this.numberOfFrames; ++i) {\n          imageIds.push(imageId + \"?frame=\"+i)\n        }\t\n        stack.imageIds = imageIds\n      }\n\n      cornerstone.displayImage(element, image)\n \n    }\n\n    loadImage = (localfile, url=undefined, fsItem=undefined) => {\n\n      if (localfile === undefined && url === undefined && fsItem === undefined) return\n      \n      if (fsItem !== undefined) {\n        this.fsItem = fsItem\n      } else if (localfile !== undefined) {\n        this.localfile = localfile\n      } else {\n        this.localurl = url\n      }\n \n      const element = this.dicomImage\n\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      element.addEventListener(\"cornerstonetoolsmeasurementadded\", this.onMeasurementAdded)\n      element.addEventListener(\"cornerstonetoolsmeasurementmodified\", this.onMeasurementModified)\n      element.addEventListener(\"cornerstonetoolsmeasurementcompleted\", this.onMeasurementCompleted)\n\n      let imageId = undefined\n\n      cornerstone.enable(element)\n\n      if (localfile === undefined && isUrlImage(url)) { // check if it's a simple image [jpeg or png] from url\n\n        cornerstone.loadImage(url).then(image => {\n          this.hideOpenUrlDlg()\n\n          this.image = image\n\n          this.isDicom = false\n\n          cornerstone.displayImage(element, image)\n          \n          this.enableTool()\n\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n          this.props.isOpenStore(true)\n\n        }, (e) => {\n          console.log('error', e)\n          this.setState({errorOnOpenImage: \"This is not a valid JPG or PNG file.\"})\n        })\n\n      } else if ((localfile !== undefined && isFileImage(localfile)) || (fsItem !== undefined && isFsFileImage(fsItem))) { // otherwise try to open as local image file (JPEG, PNG) \n        if (fsItem !== undefined) {\n          imageId = cornerstoneFileImageLoader.fileManager.addBuffer(fsItem.data)\n        } else {\n          imageId = cornerstoneFileImageLoader.fileManager.add(localfile)\n        }\n        cornerstone.loadImage(imageId).then(image => {\n          console.log('loadImage, image from local: ', image)\n\n          this.image = image\n          this.isDicom = false\n          this.PatientsName = ''\n\n          cornerstone.displayImage(element, image)\n          \n          this.enableTool()\n\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n\n          this.props.setIsOpenStore({index: this.props.index, value: true})\n\n        }, (e) => {\n          console.log('error', e)\n          this.setState({errorOnOpenImage: \"This is not a valid JPG or PNG file.\"})\n        })\n\n      } else { // otherwise try to open as Dicom file\n\n        if (fsItem !== undefined) {\n          imageId = cornerstoneWADOImageLoader.wadouri.fileManager.addBuffer(fsItem.data)\n          this.filename = fsItem.name\n          //size = fsItem.size\n        } else if (localfile !== undefined) {\n          imageId = cornerstoneWADOImageLoader.wadouri.fileManager.add(localfile)\n          this.filename = localfile.name\n          //size = localfile.size\n        } else { // it's a web dicom image\n          imageId = \"wadouri:\"+url\n        }\n\n        cornerstone.loadAndCacheImage(imageId).then(image => {\n          \n          this.hideOpenUrlDlg()\n\n          this.image = image\n\n          this.isDicom = true\n\n          this.PatientsName = image.data.string('x00100010')\n          this.sopInstanceUid = this.getSopInstanceUID()\n\n          let stack = { currentImageIdIndex: 0, imageIds: \"\" }\n          this.numberOfFrames = image.data.intString('x00280008')\n          if (this.numberOfFrames > 0) {\n            let imageIds = []\t\n            for(var i=0; i < this.numberOfFrames; ++i) {\n              imageIds.push(imageId + \"?frame=\"+i)\n            }\t\n            stack.imageIds = imageIds\n          }\n\n          cornerstone.displayImage(element, image)\n\n          this.enableTool()\n\n        }, (e) => {\n          console.log('error', e)   \n          this.hideOpenUrlDlg()      \n          //console.log('toString: ', e.error.toString())\n          const error = e.error.toString()\n          if (error === '[object XMLHttpRequest]') {\n            this.setState({errorOnCors: true})\n          } else {\n            const pos = error.indexOf(\":\")\n            this.setState({errorOnOpenImage: pos < 0 ? e.error : error.substring(pos+1)})            \n          } \n        })\n      }\n    }\n\n    runTool = (toolName, opt) => {\n      if (this.state.inPlay) {\n        this.runCinePlayer('pause')\n      }\n      switch (toolName) {\n        case 'setfiles': {\n          this.files = opt\n          this.sliceMax = this.files.length\n          this.shouldScroll = this.files.length > 1\n          break   \n        }        \n        case 'openimage': {\n          cornerstone.disable(this.dicomImage)\n          this.sliceIndex = opt\n          this.displayImageFromFiles(opt)\n          break   \n        }\n\n        case 'reset': {\n          this.reset()\n          break\n        }\n\n        case 'clear': {\n          this.files = null\n          cornerstone.disable(this.dicomImage)\n          break\n        }  \n  \n        default: {\n          break\n        }\n      }\n    } \n\n    reset = () => {\n      const element = this.dicomImage\n      const defaultViewport = cornerstone.getDefaultViewportForImage(element, this.image)\n      let viewport = cornerstone.getViewport(element)\n      viewport.voi.windowWidth = defaultViewport.voi.windowWidth\n      viewport.voi.windowCenter = defaultViewport.voi.windowCenter\n      viewport.invert = false\n      cornerstone.setViewport(element, viewport)\n    }\n\n    dicomImageRef = el => {\n      this.dicomImage = el\n    }\n\n    onImageClick = () => {\n      //console.log('onImageClick: ')\n    }\n\n    getSeriesNumber = () => {\n      if (this.props.series === undefined || this.props.series === null) return     \n      return this.props.series.seriesList.get(this.props.series.seriesKeys[this.props.index])[this.props.index].series.seriesNumber\n    }\n\n    getSeriesLength = () => {\n      if (this.props.series === undefined || this.props.series === null) return     \n      return this.props.series.seriesList.get(this.props.series.seriesKeys[this.props.index]).length\n    }\n\n    getSeriesDescription = () => {\n      if (this.props.series === undefined || this.props.series === null) return\n      if (this.props.series.seriesList.get(this.props.series.seriesKeys[this.props.index])[this.props.index] === undefined) return\n      return this.props.series.seriesList.get(this.props.series.seriesKeys[this.props.index])[this.props.index].series.seriesDescription\n    }\n\n    render() {\n\n      const visible = this.props.visible ? 'visible' : 'hidden'\n      const visibleOpenUrlDlg = this.state.visibleOpenUrlDlg\n      const errorOnOpenImage = this.state.errorOnOpenImage\n      const progress = this.state.progress\n      \n      this.sliceMax = this.getSeriesLength()\n\n      //console.log('this.props.explorerActiveSeriesIndex: ', this.props.explorerActiveSeriesIndex)\n      //console.log('this.props.index: ', this.props.index)\n      \n      const styleContainer = {\n        width: '100%', \n        height: '100%', \n        border: (this.props.explorerActiveSeriesIndex === this.props.index) ? 'solid 1px #AAAAAA' : null,\n        position: 'relative',\n      }\n\n      const styleDicomImage = {\n        width: '100%', \n        height: '100%', \n        position: 'relative',\n      }\n\n      return ( \n        <div className=\"container\" style={styleContainer} >\n\n          {visibleOpenUrlDlg ? <OpenUrlDlg progress={progress} onClose={this.hideOpenUrlDlg} /> : null}\n\n          <Dialog\n            open={errorOnOpenImage !== null}\n            onClose={this.onErrorOpenImageClose}\n          >\n            <DialogTitle id=\"alert-dialog-title\">{\"Error on opening image\"}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                {this.state.errorOnOpenImage}\n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={this.onErrorOpenImageClose} autoFocus>\n                Ok\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <Dialog\n            open={this.state.errorOnCors}\n            onClose={this.onErrorCorsClose}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n          >\n            <DialogTitle id=\"alert-dialog-title\">{\"Error on loading image\"}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                <Typography gutterBottom>\n                  CORS or Cross Origin Resource Sharing is a browser security policy \n                  that prevents javascript from loading data from a server with a different base URL \n                  than the server that served up the javascript file. \n                </Typography> \n                <Typography gutterBottom>\n                  See the &nbsp; \n                  <Link href=\"http://enable-cors.org/\" target='_blank' color='textPrimary'>\n                    Enable CORS site\n                  </Link>\n                  &nbsp; for information about CORS.                     \n                </Typography>                                \n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={this.onErrorCorsClose} autoFocus>\n                Ok\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <div\n            style={{\n              width: '100%', \n              height: '100%', \n              position: \"relative\",\n              color:  '#AAAAAA',\n              fontSize: '0.80em',\n              textShadow: '1px 1px #000000',\n              visibility: visible\n            }}\n            onContextMenu={() => false}\n            className=\"cornerstone-enabled-image\"\n          >\n\n            <div \n              id={`previewer-${this.props.index}`}\n              ref={this.dicomImageRef} style={styleDicomImage}\n            >\n            </div>\n\n            <div\n              id={`mrtopleft-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, left: 3 }}\n            >\n             {this.getSeriesNumber()}\n            </div>\n            <div\n              id={`mrtopright-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, right: 3 }}\n            >\n              \n            </div>\n            <div\n              id={`mrbottomright-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, right: 3 }}\n            >\n              {`${this.sliceMax}`}\n            </div>\n            <div\n              id={`mrbottomleft-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, left: 3 }}\n            >\n              {this.getSeriesDescription()}\n            </div>   \n\n            <div\n              id={`mrtopcenter-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, width: '60px', left: '50%', marginLeft: '0px' }}\n            >\n              \n            </div>\n\n            <div\n              id={`mrleftcenter-${this.props.index}`}\n              style={{ position: \"absolute\", top: '50%', width: '30px', left: 3, marginLeft: '0px' }}\n            >\n              \n            </div>    \n\n            <div\n              id={`mrrightcenter-${this.props.index}`}\n              style={{ position: \"absolute\", top: '50%', width: '30px', right: 3, marginRight: '-20px' }}\n            >\n              \n            </div>                \n\n            <div\n              id={`mrbottomcenter-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, width: '60px', left: '50%', marginLeft: '0px' }}\n            >\n              \n            </div>\n          </div>\n        </div>\n      )\n    }\n  }\n  \nconst mapStateToProps = (state) => {\n  return {\n    files: state.files,\n    series: state.series,\n    url: state.url,\n    tool: state.tool,\n    activeDcmIndex: state.activeDcmIndex,\n    activeDcm: state.activeDcm,\n    explorerActiveSeriesIndex: state.explorerActiveSeriesIndex,\n    measurements: state.measurements,\n    fsCurrentDir: state.fsCurrentDir,\n    fsCurrentList: state.fsCurrentList,\n    dcmEnableTool: state.dcmEnableTool,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    clearingStore: () => dispatch(clearStore()),\n    setIsOpenStore: (value) => dispatch(dcmIsOpen(value)),\n    toolStore: (tool) => dispatch(dcmTool(tool)),\n    setActiveDcm: (dcm) => dispatch(activeDcm(dcm)),\n    setActiveMeasurements: (measurements) => dispatch(activeMeasurements(measurements)),\n    makeFsRefresh: (dcm) => dispatch(doFsRefresh()),\n    setDcmEnableToolStore: (value) => dispatch(setDcmEnableTool(value))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DicomPreviewer)\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport DicomPreviewer from './DicomPreviewer'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport Select from '@material-ui/core/Select'\r\nimport 'react-perfect-scrollbar/dist/css/styles.css'\r\nimport PerfectScrollbar from 'react-perfect-scrollbar'\r\nimport {\r\n    seriesStore,\r\n    filesStore,\r\n    explorer,\r\n    explorerActivePatientIndex,\r\n    explorerActiveStudyIndex,\r\n    explorerActiveSeriesIndex,\r\n  } from '../actions'\r\n\r\nimport {\r\n    groupBy,  \r\n} from '../functions'\r\n\r\nconst style = {\r\n    width: '200px', \r\n    padding: '8px 8px 8px 8px', \r\n    marginTop: '40px',\r\n}\r\n\r\nconst styleScrollbar = {\r\n    height: 'calc(100vh - 48px)',\r\n}\r\n\r\nconst styleDicomViewerStack = {\r\n    width: '182px', \r\n    marginTop: '10px',\r\n    marginLeft: '7px',\r\n}\r\n\r\nconst styleDicomViewer = { \r\n    padding: '4px 4px 4px 4px', \r\n}\r\n\r\nconst styles = theme => ({\r\n    formControl: {\r\n        margin: theme.spacing(1),\r\n        minWidth: 180,\r\n    },\r\n    selectEmpty: {\r\n        marginTop: theme.spacing(2),\r\n    },\r\n    selectText: {\r\n        fontSize: '0.85em',\r\n    },    \r\n    menuItemText: {\r\n        fontSize: '0.85em',\r\n    },\r\n})\r\n\r\nclass Explorer extends PureComponent {\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        this.dicomViewersRefs = []\r\n        this.dicomViewers = []\r\n        for(let i=0; i < 16; i++) {\r\n          this.dicomViewers.push(this.setDcmViewer(i))\r\n        }\r\n      }\r\n\r\n    state = {\r\n        patientName: this.props.explorer.patient.keys[0],\r\n        studies: [],\r\n        study: '',\r\n        series: [],\r\n        seriesActiveIndex: 0,\r\n    }\r\n\r\n    setDcmViewer = (index) => {\r\n        return (\r\n          <div style={styleDicomViewer}>  \r\n            <DicomPreviewer \r\n                dcmRef={(ref) => {this.dicomViewersRefs[index] = ref}}\r\n                index={index}\r\n                runTool={ref => (this.runTool = ref)} \r\n                changeTool={ref => (this.changeTool = ref)}\r\n                onLoadedImage={this.onLoadedImage}\r\n                onRenderedImage={this.onRenderedImage}\r\n                visible={true} \r\n            />   \r\n          </div> \r\n        )\r\n    }\r\n    \r\n    onLoadedImage = () => {\r\n    \r\n    }\r\n\r\n    onRenderedImage = () => {\r\n\r\n    }\r\n\r\n    getDcmViewerRef = (index) => {\r\n        return this.dicomViewersRefs[index]\r\n    }\r\n\r\n    getDcmViewer = (index) => {\r\n        return this.dicomViewers[index]\r\n    }\r\n\r\n    buildPreviewStack = (rows) => {\r\n        this.dicomviewers = []\r\n        for(let i=0; i < rows; i++) {\r\n            this.dicomviewers.push(\r\n              <div \r\n                key={i} \r\n                onClick={() => this.previewStackClick(i)} \r\n                onTouchStart={() => this.previewStackTouch(i)}\r\n              >\r\n                {this.getDcmViewer(i)}\r\n              </div>        \r\n            )\r\n        }\r\n        \r\n        return (\r\n          <div\r\n            id=\"dicompreviewer-grid\"\r\n            style={{\r\n              display: 'grid',\r\n              gridTemplateRows: `repeat(${rows}, ${100 / rows}%)`,\r\n              gridTemplateColumns: `repeat(${1}, ${100}%)`,\r\n              height: '100%',\r\n              width: '100%',\r\n            }}\r\n          >\r\n            {this.dicomviewers}\r\n          </div>\r\n        )\r\n    }\r\n\r\n    componentDidMount() {\r\n        //console.log('Explorer - componentDidMount: ')\r\n\r\n        const patientIndex = this.props.explorerActivePatientIndex\r\n        const studyIndex = this.props.explorerActiveStudyIndex\r\n        const seriesIndex = this.props.explorerActiveSeriesIndex\r\n        const patientName = this.props.explorer.patient.keys[patientIndex]\r\n\r\n        const files = this.props.files\r\n        \r\n        this.setState({patientName: patientName}, () => {\r\n            this.filesListForPatient = files.filter((a) => {\r\n                return a.patient.patientName === patientName}\r\n            )\r\n \r\n            this.studyList = groupBy(this.filesListForPatient, a => a.study.studyDateTime)\r\n            let studyKeys = [...this.studyList.keys()]\r\n            if (this.studyList.get(studyKeys[0])[0].study.studyDate === undefined) {\r\n                this.studyList = groupBy(this.filesListForPatient, a => a.study.studyDescription)\r\n                studyKeys = [...this.studyList.keys()]\r\n            }\r\n            this.study = {\r\n              list: this.studyList,\r\n              keys: studyKeys\r\n            }\r\n\r\n            const seriesList = groupBy(this.studyList.get(studyKeys[0]), a => a.series.seriesNumber) // this.filesListForPatient\r\n            this.seriesList = new Map([...seriesList].sort())\r\n            \r\n            const seriesKeys = [...this.seriesList.keys()]\r\n            seriesKeys.sort(function(a, b) { return a - b })\r\n\r\n            this.series = {\r\n                seriesList: this.seriesList,\r\n                seriesKeys: seriesKeys\r\n            }\r\n            this.files = this.series.seriesList.get(seriesKeys[0])\r\n            this.props.setSeriesStore(this.series)\r\n\r\n            this.setState({study: this.study.keys[studyIndex], studies: studyKeys, series: seriesKeys}, () => {\r\n                this.previewStackClick(seriesIndex)\r\n            })\r\n        })\r\n\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        //console.log('Explorer - componentDidUpdate: ', this.state.series)\r\n        for(let i=0; i < this.state.series.length; i++) {\r\n            this.dicomViewersRefs[i].runTool('setfiles', this.seriesList.get(this.state.series[i]))\r\n            this.dicomViewersRefs[i].runTool('openimage', 0)\r\n        }\r\n    }\r\n\r\n    handlePatientChange = (event, value) => {\r\n        //console.log('handlePatientChange: ', value)\r\n\r\n        this.patientName = event.target.value\r\n        const patientIndex = value.key\r\n\r\n        this.filesListForPatient = this.props.allFiles.filter((a) => {\r\n            return a.patient.patientName === this.patientName}\r\n        )\r\n\r\n        this.studyList = groupBy(this.filesListForPatient, a => a.study.studyDateTime)\r\n        const studyKeys = [...this.studyList.keys()]\r\n        this.study = {\r\n          list: this.studyList,\r\n          keys: studyKeys\r\n        }\r\n\r\n        this.seriesList = groupBy(this.studyList.get(studyKeys[0]), a => a.series.seriesNumber) // this.filesListForPatient\r\n        const seriesKeys = [...this.seriesList.keys()]\r\n\r\n        this.series = {\r\n            seriesList: this.seriesList,\r\n            seriesKeys: seriesKeys\r\n        }\r\n        this.props.setSeriesStore(this.series)\r\n\r\n        this.setState({patientName: this.patientName, study: this.study.keys[0], studies: studyKeys, series: seriesKeys}, () => {\r\n            this.props.setExplorerActivePatientIndex(patientIndex)\r\n            this.previewStackClick(0)\r\n        })\r\n    }\r\n\r\n    handleStudyChange = (event, value) => {\r\n        //console.log('handleStudyChange, event: ', event)\r\n\r\n        const studyIndex = value.key\r\n\r\n        this.studyList = groupBy(this.filesListForPatient, a => a.study.studyDateTime)\r\n        let studyKeys = [...this.studyList.keys()]\r\n        if (this.studyList.get(studyKeys[0])[0].study.studyDate === undefined) {\r\n            this.studyList = groupBy(this.filesListForPatient, a => a.study.studyDescription)\r\n            studyKeys = [...this.studyList.keys()]\r\n        }\r\n        this.study = {\r\n          list: this.studyList,\r\n          keys: studyKeys\r\n        }\r\n\r\n        this.seriesList = groupBy(this.studyList.get(studyKeys[studyIndex]), a => a.series.seriesNumber)\r\n        const seriesKeys = [...this.seriesList.keys()]\r\n\r\n        this.series = {\r\n            seriesList: this.seriesList,\r\n            seriesKeys: seriesKeys\r\n        }\r\n        this.props.setSeriesStore(this.series)\r\n\r\n        this.setState({study: this.study.keys[studyIndex], studies: studyKeys, series: seriesKeys}, () => {\r\n            this.previewStackClick(0)\r\n        })\r\n\r\n\r\n    }\r\n\r\n    previewStackClick = (index) => {\r\n        //console.log('previewStackClick: ', index)\r\n        //if (index === this.state.seriesActiveIndex) return\r\n        this.props.setExplorerActiveSeriesIndex(index) \r\n        this.setState({seriesActiveIndex: index}, () => {\r\n            this.props.onSelectSeries(this.series.seriesList.get(this.state.series[index]), index)\r\n        })\r\n    }\r\n\r\n    previewStackTouch = (index) => {\r\n        this.props.setExplorerActiveSeriesIndex(index)\r\n        this.setState({seriesActiveIndex: index}, () => {\r\n            this.props.onSelectSeries(this.series.seriesList.get(this.state.series[index]))\r\n        })\r\n    }\r\n\r\n    clear = () => {\r\n        for(let i=0; i < 16; i++) {\r\n            this.dicomViewersRefs[i].runTool('clear')\r\n        }\r\n    }\r\n\r\n    render() {   \r\n        const { classes } = this.props\r\n\r\n        return (\r\n            <PerfectScrollbar> \r\n                <div style={styleScrollbar}>\r\n                    <div style={style}>\r\n                        <FormControl className={classes.formControl}>\r\n                            <InputLabel id=\"patient-label\">Patient</InputLabel>\r\n                            <Select\r\n                                className={classes.selectText}\r\n                                labelId=\"patient-select-label\"\r\n                                id=\"patient-select\"\r\n                                value={this.state.patientName}\r\n                                onChange={this.handlePatientChange}\r\n                            >\r\n                                {this.props.explorer.patient.keys.map((patient, index) => (\r\n                                    <MenuItem className={classes.menuItemText} value={patient} key={index}>{patient}</MenuItem>\r\n                                ))}\r\n                            </Select>\r\n                        </FormControl>\r\n\r\n                        <FormControl className={classes.formControl}>\r\n                            <InputLabel id=\"study-label\">Study</InputLabel>\r\n                            <Select\r\n                                className={classes.selectText}\r\n                                labelId=\"study-select-label\"\r\n                                id=\"study-select\"\r\n                                value={this.state.study}\r\n                                onChange={this.handleStudyChange}\r\n                            >\r\n                                {this.state.studies.map((study, index) => (\r\n                                    // `${studyDate} - ${studyTime}`\r\n                                    <MenuItem className={classes.menuItemText} value={study} key={index}>{study}</MenuItem>\r\n                                ))}\r\n                            </Select>\r\n                        </FormControl>\r\n\r\n                        <div style={styleDicomViewerStack}>\r\n                            {\r\n                                this.buildPreviewStack(this.state.series.length)\r\n                            }\r\n                        </div>\r\n                    </div>\r\n\r\n            </div>\r\n          </PerfectScrollbar> \r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      files: state.files,\r\n      explorerActivePatientIndex: state.explorerActivePatientIndex,\r\n      explorerActiveStudyIndex: state.explorerActiveStudyIndex,\r\n      explorerActiveSeriesIndex: state.explorerActiveSeriesIndex,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        setFilesStore: (files) => dispatch(filesStore(files)),\r\n        setExplorer: (data) => dispatch(explorer(data)),\r\n        setExplorerActivePatientIndex: (index) => dispatch(explorerActivePatientIndex(index)),\r\n        setExplorerActiveStudyIndex: (index) => dispatch(explorerActiveStudyIndex(index)),\r\n        setExplorerActiveSeriesIndex: (index) => dispatch(explorerActiveSeriesIndex(index)),\r\n        setSeriesStore: (series) => dispatch(seriesStore(series)),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(Explorer))\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport * as cornerstone from \"cornerstone-core\"\r\nimport * as cornerstoneWADOImageLoader from \"cornerstone-wado-image-loader\"\r\nimport {\r\n  //allFilesStore,\r\n  filesStore,\r\n} from '../actions'\r\nimport { \r\n  getDicomPatientName,\r\n  getDicomStudyId,\r\n  getDicomStudyDate,\r\n  getDicomStudyTime,\r\n  getDicomStudyDescription,\r\n  getDicomSeriesDate,\r\n  getDicomSeriesTime,\r\n  getDicomSeriesDescription,\r\n  getDicomSeriesNumber,\r\n  getDicomInstanceNumber,\r\n  getDicomSliceLocation,\r\n  getDicomSliceDistance,\r\n  getDicomRows,\r\n  getDicomColumns,\r\n  getDicomEchoNumber,\r\n  getFileNameCorrect,\r\n  dicomDateTimeToLocale,\r\n} from '../functions'\r\n\r\ncornerstoneWADOImageLoader.external.cornerstone = cornerstone\r\n\r\nclass OpenMultipleFilesDlg extends PureComponent {\r\n\r\n  state = {\r\n    progress: 0,\r\n    cancel: false,\r\n  }  \r\n\r\n  componentDidMount() {\r\n    //console.log('OpenMultipleFilesDlg - componentDidMount: ', this.props.files)\r\n\r\n    this.items = []\r\n    this.count = 0\r\n    this.step = 0\r\n\r\n    const files = this.props.files\r\n\r\n    this.step = files.length / 50\r\n    this.nextProgress = this.step\r\n    this.t0 = performance.now()\r\n\r\n    //console.log('OpenMultipleFilesDlg - cachedImages: ', cornerstone.imageCache.cachedImages)\r\n\r\n    //cornerstoneWADOImageLoader.wadouri.fileManager.purge()\r\n    //cornerstone.imageCache.purgeCache()\r\n    \r\n    let imageIds = [] \r\n\r\n    for (let i=0; i < files.length; i++) {\r\n      const file = files[i]\r\n      if (this.props.origin === 'local')\r\n        imageIds.push(cornerstoneWADOImageLoader.wadouri.fileManager.add(file))\r\n      else // it's fs item\r\n        imageIds.push(cornerstoneWADOImageLoader.wadouri.fileManager.addBuffer(file.data))\r\n    }\r\n    \r\n    //console.log('OpenMultipleFilesDlg - files: ', files)\r\n\r\n    for (let i=0; i < files.length; i++) {\r\n      const file = files[i]\r\n      if (this.state.cancel) {\r\n        //this.props.setAllFilesStore(null)\r\n        this.props.setFilesStore(null)\r\n        this.close()\r\n        return\r\n      }\r\n      \r\n      //console.log('imageId', imageIds[i])\r\n      \r\n      cornerstone.loadImage(imageIds[i]).then((image) => {\r\n        //console.log('image', image)\r\n        const patientName = getDicomPatientName(image)\r\n\r\n        const studyId = getDicomStudyId(image)\r\n        const studyDate = getDicomStudyDate(image)\r\n        const studyTime = getDicomStudyTime(image)\r\n        const studyDescription = getDicomStudyDescription(image)\r\n\r\n        const seriesDate = getDicomSeriesDate(image)\r\n        const seriesTime = getDicomSeriesTime(image)\r\n        const seriesDescription = getDicomSeriesDescription(image)        \r\n        const seriesNumber = getDicomSeriesNumber(image)\r\n\r\n        const instanceNumber = getDicomInstanceNumber(image)\r\n        const sliceDistance = getDicomSliceDistance(image)\r\n        const echoNumber = getDicomEchoNumber(image)\r\n        const sliceLocation = getDicomSliceLocation(image)  \r\n        const columns = getDicomColumns(image)       \r\n        const rows = getDicomRows(image)\r\n\r\n        const studyDateTime = studyDate === undefined ? undefined : dicomDateTimeToLocale(`${studyDate}.${studyTime}`)\r\n\r\n        let item = null\r\n        if (this.props.origin === 'local')\r\n          item = {\r\n            imageId: imageIds[i], \r\n            instanceNumber: instanceNumber, \r\n            name: getFileNameCorrect(file.name), \r\n            image: image, \r\n            rows: rows, \r\n            columns: columns, \r\n            sliceDistance: sliceDistance,\r\n            sliceLocation: sliceLocation,\r\n            patient: {\r\n              patientName: patientName\r\n            },\r\n            study: {\r\n              studyId: studyId,\r\n              studyDate: studyDate,\r\n              studyTime: studyTime,\r\n              studyDateTime: studyDateTime,\r\n              studyDescription: studyDescription\r\n            },\r\n            series: {\r\n              seriesDate: seriesDate,\r\n              seriesTime: seriesTime,\r\n              seriesDescription: seriesDescription,\r\n              seriesNumber: seriesNumber,\r\n              echoNumber: echoNumber\r\n            }\r\n          }\r\n        else\r\n          item = {\r\n            imageId: imageIds[i], \r\n            instanceNumber: instanceNumber, \r\n            name: file.name, \r\n            image: image, \r\n            rows: rows, \r\n            columns: columns, \r\n            sliceDistance: sliceDistance,\r\n            sliceLocation: sliceLocation,  \r\n            patient: {\r\n              patientName: patientName\r\n            },\r\n            study: {\r\n              studyId: studyId,\r\n              studyDate: studyDate,\r\n              studyTime: studyTime,\r\n              studyDateTime: studyDateTime,\r\n              studyDescription: studyDescription\r\n            },\r\n            series: {\r\n              seriesDate: seriesDate,\r\n              seriesTime: seriesTime,\r\n              seriesDescription: seriesDescription,\r\n              seriesNumber: seriesNumber,\r\n              echoNumber: echoNumber\r\n            }          \r\n          }\r\n        this.items.push(item)\r\n        this.count++\r\n\r\n        const progress = Math.floor(this.count*(100/files.length))\r\n        //\r\n        if (progress > this.nextProgress) {\r\n          this.nextProgress += this.step\r\n          this.setState({progress: progress})\r\n        }\r\n        if (this.count === files.length) {\r\n          this.items.sort((l, r) => {\r\n            return l.instanceNumber - r.instanceNumber\r\n            // return l.sliceDistance - r.sliceDistance\r\n            // return l.sliceLocation - r.sliceLocation\r\n          })\r\n          this.t1 = performance.now()\r\n          console.log(`performance load ${this.count} images in ${this.t1-this.t0} milliseconds`)\r\n          this.props.setFilesStore(this.items)\r\n          this.close()\r\n        }\r\n\t\t\t}, (e) => {\r\n        console.log('Error in reading multiple files: ', e)\r\n        this.count++\r\n      })\r\n      if (this.count === files.length) {\r\n        \r\n      }   \r\n    }\r\n    //this.close()\r\n  }\r\n\r\n  close = () => {\r\n    //console.log('this.slicesDistance: ', this.slicesDistance)\r\n    this.props.onClose()\r\n  }\r\n\r\n  cancel = () => {\r\n    this.setState({cancel: true}) \r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Dialog\r\n            open={true}\r\n            onClose={this.close}\r\n            aria-labelledby=\"alert-dialog-title\"\r\n        >\r\n            <DialogTitle id=\"alert-dialog-title\">{\"Opening multiple files ...\"}</DialogTitle>\r\n            <DialogContent>\r\n              <LinearProgress variant=\"determinate\" value={this.state.progress} color='secondary' />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={this.cancel}>\r\n                    Cancel\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n      //setAllFilesStore: (files) => dispatch(allFilesStore(files)),\r\n      setFilesStore: (files) => dispatch(filesStore(files)),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(OpenMultipleFilesDlg)\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport Button from '@material-ui/core/Button'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogContentText from '@material-ui/core/DialogContentText'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableContainer from '@material-ui/core/TableContainer'\r\nimport TableHead from '@material-ui/core/TableHead'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n// import {List as ListVirtual} from 'react-virtualized'\r\nimport 'react-perfect-scrollbar/dist/css/styles.css'\r\nimport PerfectScrollbar from 'react-perfect-scrollbar'\r\nimport JSZip from 'jszip'\r\nimport { saveAs } from 'file-saver'\r\nimport fs from '../fs/fs'\r\nimport OpenMultipleFilesDlg from './OpenMultipleFilesDlg'\r\nimport {\r\n    getFileExt,\r\n    getFileExtReal,\r\n    getFileName,\r\n    formatBytes,\r\n    getSettingsFsView,\r\n    getFileNameCorrect,\r\n} from '../functions'\r\nimport {\r\n    //setFsCurrentId,\r\n    setFsCurrentDir,\r\n    setFsCurrentList,\r\n    setZippedFile,\r\n    fsFileStore,\r\n} from '../actions'\r\nimport {\r\n    mdiCheck,\r\n    mdiChevronLeft,\r\n    mdiClose,\r\n    mdiContentCopy,\r\n    mdiContentCut,\r\n    mdiContentPaste,\r\n    mdiContentSaveOutline,\r\n    mdiDeleteOutline,\r\n    mdiDotsHorizontal,\r\n    mdiExportVariant, \r\n    mdiFolderOutline,   \r\n    mdiFolderPlusOutline,\r\n    mdiCheckBoxOutline,\r\n    mdiSquareEditOutline,\r\n} from '@mdi/js'\r\n\r\nconst styles = theme => ({\r\n    table: {\r\n        minWidth: 250,\r\n    },\r\n    tableCellText: {\r\n        fontSize: '0.80em',\r\n    },\r\n    toolbarButtons: {\r\n        marginLeft: 'auto',\r\n        marginRight: -20,\r\n    },\r\n    leftButtons: {\r\n        marginLeft: -25,\r\n    },\r\n    textPaper: {\r\n        padding: '2px 4px',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        width: 250,\r\n    },\r\n    textInput: {\r\n        marginLeft: theme.spacing(1),\r\n        flex: 1,\r\n    },\r\n    textButton: {\r\n        padding: 10,\r\n    },\r\n})\r\n\r\nconst styleScrollbar = {\r\n    height: 'calc(100vh - 48px)'\r\n}\r\n\r\nclass FsUI extends PureComponent {\r\n    constructor(props) {\r\n        super(props)\r\n        this.files = []\r\n        this.cut = false\r\n        this.itemsCount = 0\r\n        this.saveAsField = React.createRef()\r\n\r\n      }\r\n\r\n    state = {\r\n        textFieldLabel: '',\r\n        textFieldValue: '',\r\n        selected: [],\r\n        selectedCopy: [],\r\n        visibleTextField: false,\r\n        visibleDeleteDlg: false,\r\n        visibleOthers: false,\r\n        visibleAlreadyExistDlg: false,\r\n        visibleOSaveAsDlg: false,\r\n        visibleWaiting: false,\r\n        visibleOpenMultipleFilesDlg: false,\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.fsListDir(this.props.fsCurrentDir)\r\n    }\r\n\r\n    componentDidUpdate(previousProps) {\r\n        //console.log('componentDidUpdate: ', this.props)\r\n        if (this.props.fsZippedFile !== null) {\r\n            const zip = new JSZip()\r\n            zip.loadAsync(this.props.fsZippedFile).then((contents) => {\r\n                //console.log('zip file contents: ', contents)\r\n                contents.forEach((relativePath, zipEntry) => {\r\n                    //console.log('zipEntry: ', zipEntry)\r\n                    if (zipEntry.dir) { \r\n                        //console.log('dir relativePath: ', relativePath)\r\n                    } else {                  \r\n                        //console.log('file relativePath: ', relativePath)\r\n                        zip.file(relativePath).async('uint8array').then((content) => {\r\n                            this.fsAddItem(relativePath, content)\r\n                        })\r\n                    }\r\n                })\r\n            }).then(() => {\r\n                this.props.setFsZippedFile(null)\r\n                //this.fsListDir(this.props.fsCurrentDir)\r\n            })\r\n        } else {\r\n            //this.fsListDir(this.props.fsCurrentDir)\r\n        }\r\n    }\r\n\r\n    fsBuildParent(parent, name) {\r\n        let newParent = ''\r\n        if (parent === '') {\r\n            if (name !== '') \r\n                newParent = name\r\n        } else {\r\n            if (name !== '') \r\n                newParent = `${parent}/${name}` \r\n            else\r\n                newParent = parent\r\n        }\r\n        return newParent\r\n    }\r\n\r\n    fsAddItem(filename, data) {\r\n        //console.log('fsAddItem filename: ', filename)\r\n        //console.log('fsAddItem data: ', data)\r\n        let components = filename.split('/')\r\n        const name = components.pop()\r\n        const parent = this.fsBuildParent(this.props.fsCurrentDir, components.join('/'))\r\n        //console.log(`add file, parent: ${parent}, name: ${name}`)\r\n        fs.transaction('rw', fs.files, async () => {\r\n            await fs.files.add({\r\n                parent: parent,\r\n                name: name,\r\n                type: getFileExt(name),\r\n                size: data.length,\r\n                data: data\r\n            })             \r\n        }).then(() => {\r\n            // store subdirectory\r\n            while (components.length > 0) {\r\n                const name = components.pop()\r\n                const parent = this.fsBuildParent(this.props.fsCurrentDir, components.join('/'))\r\n                //console.log(`put dir, parent: ${parent}, name: ${name}`)\r\n                fs.transaction('rw', fs.files, async () => {\r\n                    await fs.files.put({\r\n                        parent: parent,\r\n                        name: name,\r\n                        type: 'dir',\r\n                        size: '' \r\n                    }) \r\n                }).then(() => {\r\n                    this.fsListDir(this.props.fsCurrentDir)\r\n                })\r\n            }            \r\n        })\r\n    }\r\n\r\n    fsExistDir(dir, create = true) {\r\n        const item = this.props.fsCurrentList.find(e => e.name === dir)\r\n        if (item !== undefined) {\r\n            if (create) {\r\n                this.fsCreateDir(this.props.fsCurrentDir, dir)\r\n                return true\r\n            } else return false\r\n        } else return false\r\n    }\r\n\r\n    fsListDir(dir) {\r\n        //console.log('fsListDir: ', dir)\r\n        let listItems = []\r\n        fs.transaction('r', fs.files, () => {\r\n            fs.files.where({parent: dir, type: 'dir'}).sortBy('name').then((list) => { // first list all dirs\r\n                listItems = list\r\n            }).then(() => { // after list all files\r\n                fs.files.where({parent: dir}).and(item => item.type !== 'dir').sortBy('name').then((list) => {\r\n                    listItems = listItems.concat(list)\r\n                }).then(() => {\r\n                    this.props.setCurrentList(listItems)\r\n                    setTimeout(() => this.setState({visibleWaiting: false}), 1000)\r\n                })\r\n            })\r\n        })\r\n    }\r\n\r\n    fsCreateDir(parent, name) {\r\n        fs.files.add({parent: parent, name: name, type: 'dir', size: ''}).then(() => { \r\n            this.fsListDir(this.props.fsCurrentDir)\r\n        })\r\n    }\r\n\r\n    doSelectUnselect = () => {\r\n        let newSelected = []\r\n        if (this.state.selected.length > 0) { // unselect the files\r\n            this.setState({selected: newSelected})            \r\n        } else { // select only files not dir\r\n            this.props.fsCurrentList.forEach((item) => {\r\n                if (item.type !== 'dir') {\r\n                    newSelected.push(item.name)\r\n                }\r\n                this.setState({selected: newSelected}, () => {\r\n                    //console.log('this.state.selected: ', this.state.selected)\r\n                })\r\n                \r\n            })\r\n        }\r\n    }\r\n\r\n    openSelectedFilesRetrieveItems = async () => {\r\n        await fs.transaction('r', fs.files, async () => {\r\n            this.state.selected.forEach( async (name, index) => {\r\n                await fs.files.where({parent: this.props.fsCurrentDir, name: name}).first((item) => {\r\n                    //console.log('item: ', item)\r\n                    if (item !== undefined && item.type !== 'dir') {\r\n                        this.files.push(item)\r\n                    } else if (item.type === 'dir') {\r\n                        fs.files.where('parent').startsWithIgnoreCase(item.name).each((e) => {\r\n                            if (e !== undefined && e.type !== 'dir') {\r\n                                //console.log(' e: ', e) \r\n                                this.files.push(e)\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n             })\r\n        })\r\n    }\r\n\r\n    openSelectedFiles = () => {\r\n        if (this.state.selected.length === 0) return\r\n        this.files = []\r\n        this.openSelectedFilesRetrieveItems().then(() => {\r\n            this.setState({visibleOpenMultipleFilesDlg: true})\r\n            this.setState({selected: []})  \r\n        })\r\n    }\r\n\r\n    hideOpenMultipleFilesDlg = () => {\r\n        this.setState({ visibleOpenMultipleFilesDlg: false })\r\n        if (this.props.files.length > 1) {\r\n            this.props.onOpenMultipleFilesCompleted()\r\n        } else this.props.onOpenImage(0)\r\n    }\r\n\r\n    createDir = () => {\r\n        this.setState({textFieldLabel: 'new folder name', visibleTextField: !this.state.visibleTextField})\r\n    }\r\n\r\n    renameItem = () => {\r\n        this.lastSelected = this.state.selected[this.state.selected.length-1]\r\n        this.setState({textFieldLabel: '', textFieldValue: this.lastSelected, visibleTextField: !this.state.visibleTextField})\r\n    }\r\n\r\n    previousDir = () => {\r\n        //console.log('this.state.parentDir: ', this.state.parentDir)\r\n        if (this.props.fsCurrentDir === '') return\r\n        const nextDir = this.props.fsCurrentDir.split('/').slice(0, -1).join('/')\r\n        this.props.setCurrentDir(nextDir)\r\n        this.fsListDir(nextDir)\r\n    }\r\n\r\n    confirmText = (e) => {\r\n        if (this.state.textFieldLabel === '') { // it's a rename\r\n            // check if the new name already exist\r\n            const check = this.props.fsCurrentList.find(e => e.name === this.state.textFieldValue)\r\n            if (check !== undefined) {\r\n                this.setState({visibleAlreadyExistDlg: true})\r\n                return\r\n            }\r\n            const item = this.props.fsCurrentList.find(e => e.name === this.lastSelected)\r\n            if (item !== undefined) {\r\n                if (item.type === 'dir') {\r\n                    const oldParent = this.fsBuildParent(item.parent, item.name)\r\n                    const newParent = this.fsBuildParent(item.parent, this.state.textFieldValue)\r\n                    // rename parent for all subitems\r\n                    fs.transaction('rw', fs.files, async () => {\r\n                        await fs.files.where({parent: oldParent}).each((e) => {\r\n                            fs.transaction('rw', fs.files, async () => { // since is a new primary key then add it as new item \r\n                                await fs.files.add({\r\n                                parent: newParent,\r\n                                name: e.name,\r\n                                type: e.type,\r\n                                size: e.size,\r\n                                data: e.data\r\n                                }).then(() => { // then delete old one\r\n                                    fs.files.where({parent: oldParent}).delete()\r\n                                })\r\n                            })\r\n                        })\r\n                    })\r\n                } \r\n                fs.transaction('rw', fs.files, async () => { // a new primary key, add it as new item \r\n                    await fs.files.add({\r\n                      parent: item.parent,\r\n                      name: this.state.textFieldValue,\r\n                      type: item.type,\r\n                      size: item.size,\r\n                      data: item.data\r\n                    }).then(() => { // then delete old one\r\n                        fs.files.where({parent: item.parent, name: item.name}).delete()\r\n                    })\r\n                })\r\n                this.setState({visibleTextField: false})\r\n                this.fsListDir(this.props.fsCurrentDir)                \r\n            }\r\n        } else { // it's a new directory\r\n            this.setState({visibleTextField: false}, () => {\r\n                this.fsCreateDir(this.props.fsCurrentDir, this.state.textFieldValue)\r\n            })\r\n        }\r\n    }\r\n\r\n    cancelDir = () => {\r\n         this.setState({visibleTextField: false})\r\n    }\r\n\r\n    saveItem = () => {\r\n        //console.log('this.props.localFileStore: ', this.props.localFileStore)\r\n        //console.log('this.props.fsFileStore: ', this.props.fsFileStore)\r\n        //console.log('this.props.activeDcm: ', this.props.activeDcm)\r\n\r\n        if (this.props.localFileStore !== null) {\r\n            const file = this.props.localFileStore\r\n            if (file === null) return\r\n            let reader = new FileReader()\r\n            reader.onload = (event) => {\r\n                let buffer = event.target.result\r\n                const ext = getFileExtReal(file.name)\r\n                //console.log('ext: ', ext)\r\n                const name = getFileName(getFileNameCorrect(file.name))   \r\n                //console.log('name: ', name)\r\n                let newName = name\r\n                let counter = 0\r\n                let done = false             \r\n                do {\r\n                    let filename = ext === '' ? newName : `${newName}.${ext}`\r\n                    const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                    if (checkName === undefined) {\r\n                        fs.transaction('rw', fs.files, async () => {\r\n                            await fs.files.add({\r\n                                parent: this.props.fsCurrentDir,\r\n                                name: filename,\r\n                                type: ext === '' ? getFileExt(name) : ext,\r\n                                size: file.size,\r\n                                data: buffer\r\n                            })\r\n                        }).then(() => {\r\n                            this.fsListDir(this.props.fsCurrentDir)\r\n                        })\r\n                        done = true\r\n                    } else {\r\n                        newName = `${name} - Copy`\r\n                        if (counter > 0) newName = `${newName} (${counter})`\r\n                        counter++\r\n                    }\r\n                } while (!done)\r\n            }\r\n            reader.readAsArrayBuffer(file)\r\n        } else if (this.props.fsFileStore !== null) {\r\n            const file = this.props.fsFileStore\r\n            let buffer = file.data\r\n            const ext = getFileExtReal(file.name)\r\n            const name = getFileName(getFileNameCorrect(file.name))   \r\n            let newName = name\r\n            let counter = 0\r\n            let done = false             \r\n            do {\r\n                let filename = ext === '' ? newName : `${newName}.${ext}`\r\n                const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                if (checkName === undefined) {\r\n                    fs.transaction('rw', fs.files, async () => {\r\n                        await fs.files.add({\r\n                            parent: this.props.fsCurrentDir,\r\n                            name: filename,\r\n                            type: getFileExt(name),\r\n                            size: file.size,\r\n                            data: buffer\r\n                        })\r\n                    }).then(() => {\r\n                        this.fsListDir(this.props.fsCurrentDir)\r\n                    })\r\n                    done = true\r\n                } else {\r\n                    newName = `${name} - Copy`\r\n                    if (counter > 0) newName = `${newName} (${counter})`\r\n                    counter++\r\n                }\r\n            } while (!done)           \r\n        }\r\n    }\r\n\r\n    copyItem = () => {\r\n        let newSelectedCopy = []\r\n        this.state.selected.forEach(name => {\r\n            const item = this.props.fsCurrentList.find(e => e.name === name)\r\n            if (item !== undefined) {\r\n                newSelectedCopy.push({parent: item.parent, name: item.name})\r\n            }\r\n        })\r\n        this.setState({selectedCopy: newSelectedCopy})\r\n    }\r\n\r\n    cutItem = () => {\r\n        let newSelectedCopy = []\r\n        this.state.selected.forEach(name => {\r\n            let item = this.props.fsCurrentList.find(e => e.name === name)\r\n            if (item !== undefined) {\r\n                newSelectedCopy.push({parent: item.parent, name: item.name})\r\n            }\r\n        })\r\n        this.setState({selectedCopy: newSelectedCopy})\r\n        this.cut = true\r\n    }\r\n\r\n    pasteItem = () => {\r\n        //console.log('this.state.selectedCopy: ', this.state.selectedCopy)\r\n        //console.log('this.props.fsCurrentList: ', this.props.fsCurrentList)\r\n        this.state.selectedCopy.forEach(async (selected, index) => {\r\n            await fs.files.where({parent: selected.parent, name: selected.name}).first((item) => {\r\n                if (item !== undefined) {\r\n                    //console.log('item: ', item)\r\n                    if (item.type === 'dir') {\r\n                        // create a new name\r\n                        let counter = 0\r\n                        let done = false\r\n                        let newName = item.name\r\n                        do {\r\n                            let filename = newName\r\n                            const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                            if (checkName === undefined) {\r\n                                done = true\r\n                            } else {\r\n                                newName = `${item.name} - Copy`\r\n                                if (counter > 0) newName = `${newName} (${counter})`\r\n                                counter++\r\n                            }\r\n                        } while (!done)   \r\n                        //console.log('this.props.fsCurrentDir: ', this.props.fsCurrentDir)\r\n                        //console.log('newName: ', newName)\r\n                        // copy the folder\r\n                        fs.files.add({\r\n                            parent: this.props.fsCurrentDir,\r\n                            name: newName,\r\n                            type: item.type,\r\n                            size: item.size,\r\n                            data: item.data\r\n                        })   \r\n                        // copy all subdirs and files\r\n                        const oldParent = this.fsBuildParent(item.parent, item.name) \r\n                        const newParent = this.fsBuildParent(this.props.fsCurrentDir, newName) \r\n                        //console.log('oldParent: ', oldParent)\r\n                        //console.log('newParent: ', newParent)\r\n                        let listItems = []\r\n                        fs.files.where('parent').startsWithIgnoreCase(oldParent).each((e) => {\r\n                            listItems.push(e)\r\n                        }).then(() => {\r\n                            listItems.forEach(e => {\r\n                                //console.log('listItems e: ', e)\r\n                                //const parent = e.parent.replace(oldParent, newParent)\r\n                                //console.log('parent: ', parent)\r\n                                fs.files.add({\r\n                                    parent: newParent,\r\n                                    name: e.name,\r\n                                    type: e.type,\r\n                                    size: e.size,\r\n                                    data: e.data\r\n                                })                          \r\n                            })                            \r\n                        })\r\n                    } else { // it's a file\r\n                        const ext = getFileExtReal(item.name)\r\n                        const name = getFileName(item.name)    \r\n                        let newName = name\r\n                        let counter = 0\r\n                        let done = false             \r\n                        do {\r\n                            let filename = ext === '' ? newName : `${newName}.${ext}`\r\n                            const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                            if (checkName === undefined) {\r\n                                fs.transaction('rw', fs.files, async () => {\r\n                                    await fs.files.add({\r\n                                        parent: this.props.fsCurrentDir,\r\n                                        name: filename,\r\n                                        type: item.type,\r\n                                        size: item.size,\r\n                                        data: item.data\r\n                                    })\r\n                                })\r\n                                done = true\r\n                            } else {\r\n                                newName = `${name} - Copy`\r\n                                if (counter > 0) newName = `${newName} (${counter})`\r\n                                counter++\r\n                            }\r\n                        } while (!done)\r\n                    }\r\n                }\r\n            })\r\n            if (index === this.state.selectedCopy.length-1) {\r\n                if (this.cut) {\r\n                    this.state.selectedCopy.forEach((selected) => {\r\n                        fs.files.where({parent: selected.parent, name: selected.name}).delete()\r\n                    })\r\n                    this.setState({selectedCopy: []})\r\n                    this.cut = false                    \r\n                }\r\n                this.fsListDir(this.props.fsCurrentDir)\r\n            }\r\n        })\r\n        this.setState({selected: []})\r\n    }\r\n\r\n    deleteItem = () => {\r\n        this.state.selected.forEach(name => {\r\n            let item = this.props.fsCurrentList.find(e => e.name === name)\r\n            if (item !== undefined) {\r\n                if (item.type === 'dir') { // delete also all subitems\r\n                    fs.files.where('parent').startsWithIgnoreCase(this.fsBuildParent(item.parent, item.name)).delete()\r\n                }\r\n                fs.files.where({parent: item.parent, name: item.name}).delete().then(() => {\r\n                    this.fsListDir(this.props.fsCurrentDir)\r\n                })\r\n            }\r\n        })\r\n        this.setState({selected: []}) \r\n    }\r\n\r\n    showOthers = () => {\r\n        this.setState({visibleOthers: !this.state.visibleOthers})\r\n    }\r\n\r\n    exportItem = () => {\r\n        if (this.state.selected.length === 0) return\r\n        this.setState({visibleOSaveAsDlg: true})\r\n    }\r\n\r\n    itemClick = (e, row) => {\r\n        //console.log('itemClick: ', row.name)\r\n        const selectedIndex = this.state.selected.indexOf(row.name)\r\n        //console.log('selectedIndex: ', selectedIndex)\r\n        let newSelected = []\r\n        if (selectedIndex === -1) {\r\n            newSelected = newSelected.concat(this.state.selected, row.name)\r\n        } else if (selectedIndex >= 0) {\r\n            newSelected = newSelected.concat(\r\n                this.state.selected.slice(0, selectedIndex),\r\n                this.state.selected.slice(selectedIndex + 1),\r\n            )\r\n        }\r\n        this.setState({selected: newSelected}, () => {\r\n            //console.log('this.state.selected: ', this.state.selected)\r\n        })\r\n    }\r\n\r\n    itemDoubleClick = (e, item) => {\r\n        if (item.type === 'dir') {\r\n            this.setState({visibleWaiting: true})\r\n            const fsCurrentDir = this.fsBuildParent(item.parent, item.name)\r\n            this.props.setCurrentDir(fsCurrentDir)\r\n            this.fsListDir(fsCurrentDir)\r\n        } else if (item.name === 'DICOMDIR') {\r\n            this.props.onOpenDicomdir(item)\r\n        } else {\r\n            this.props.setFsFileStore(item)\r\n            this.props.onOpen(item)\r\n        }\r\n    }\r\n\r\n    showDeleteDlg = () => {\r\n        this.setState({ visibleDeleteDlg: true })\r\n      }\r\n    \r\n    hideDeleteDlg = () => {\r\n        this.setState({ visibleDeleteDlg: false })\r\n    }\r\n\r\n    confirmDeleteDlg = () => {\r\n        this.hideDeleteDlg()\r\n        this.deleteItem()\r\n    }\r\n\r\n    hideAlreadyExistDlg = () => {\r\n        this.setState({ visibleAlreadyExistDlg: false })\r\n    }  \r\n\r\n    hideSaveAs = () => {\r\n        this.setState({ visibleOSaveAsDlg: false })\r\n    }\r\n\r\n    closeSaveAs = () => {\r\n        const filename = `${this.saveAsField.value}.zip`\r\n        this.setState({ visibleOSaveAsDlg: false }, () => {\r\n            let zip = new JSZip()\r\n            let listItems = []\r\n            fs.files.where('parent').startsWithIgnoreCase(this.props.fsCurrentDir).each((e) => {\r\n                if (this.state.selected.indexOf(e.parent) >= 0 || this.state.selected.indexOf(e.name) >= 0)\r\n                    listItems.push(e)\r\n            }).then(() => {\r\n                listItems.forEach((e) => {\r\n                    if (e.type !== 'dir') {\r\n                        zip.folder(e.parent).file(e.name, e.data)\r\n                    }\r\n                })\r\n                zip.generateAsync({type:\"blob\"}).then(blob => {\r\n                    saveAs(blob, filename)\r\n                })\r\n            })\r\n        })\r\n    }    \r\n\r\n    mouseDown = (e, item) => {\r\n        this.timer = setTimeout(() => { \r\n            this.itemDoubleClick(e, item)\r\n        }, 500)\r\n    }\r\n\r\n    mouseUp = (e) => {\r\n        clearTimeout(this.timer)\r\n    }\r\n\r\n    render() {   \r\n        const { classes } = this.props\r\n        const isSelected = name => this.state.selected.indexOf(name) !== -1\r\n        const visibleTextField = this.state.visibleTextField\r\n        const visibleOthers = this.state.visibleOthers\r\n        const visibleDeleteDlg = this.state.visibleDeleteDlg\r\n        const visibleAlreadyExistDlg = this.state.visibleAlreadyExistDlg\r\n        const visibleOSaveAsDlg = this.state.visibleOSaveAsDlg\r\n        const visibleOpenMultipleFilesDlg = this.state.visibleOpenMultipleFilesDlg\r\n        const visibleWaiting = this.state.visibleWaiting\r\n\r\n        let styleComponent = null\r\n        if (getSettingsFsView() === 'bottom') {\r\n            styleComponent = {marginTop: '0px', height: '275px'}\r\n        } else {\r\n            styleComponent = {marginTop: '48px', width: '350px'}\r\n        }\r\n\r\n        let totalItemsCount = ''\r\n        if (this.state.selected.length > 0)\r\n            totalItemsCount = `(${this.state.selected.length} / ${this.props.fsCurrentList.length} items)`\r\n        else \r\n            totalItemsCount = `(${this.props.fsCurrentList.length} items)`\r\n\r\n        //console.log('this.props.fsCurrentDir: ', this.props.fsCurrentDir)\r\n\r\n        return (\r\n            <PerfectScrollbar>\r\n                <div style={styleScrollbar}> \r\n                    <div style={styleComponent}>\r\n                    { visibleTextField ? \r\n                        <Paper component=\"form\" className={classes.textPaper}>\r\n                            <InputBase\r\n                                autoFocus\r\n                                className={classes.textInput}\r\n                                placeholder={this.state.textFieldLabel}\r\n                                defaultValue={this.state.textFieldValue}\r\n                                onChange={(event) => {\r\n                                    this.setState({textFieldValue: event.target.value})\r\n                                }}\r\n                            />\r\n                            <IconButton className={classes.textButton} onClick={this.confirmText}>\r\n                                <Icon path={mdiCheck} size={'1.2rem'} color={this.props.color} />\r\n                            </IconButton>\r\n                            <IconButton className={classes.textButton} onClick={this.cancelDir}>\r\n                                <Icon path={mdiClose} size={'1.2rem'} color={this.props.color} />\r\n                            </IconButton>                        \r\n                        </Paper>\r\n                    : \r\n                        <div>\r\n\r\n                            <div>\r\n                                <Toolbar variant=\"dense\">\r\n                                    <div className={classes.leftButtons}>\r\n                                    { visibleWaiting ?\r\n                                        <CircularProgress style={{marginLeft: '10px'}} size={20} color=\"secondary\" />\r\n                                    : \r\n                                        <Tooltip title=\"Previous folder\">\r\n                                            <IconButton color=\"inherit\" onClick={this.previousDir} >\r\n                                                <Icon path={mdiChevronLeft} size={'1.2rem'} color={this.props.color} />\r\n                                            </IconButton>       \r\n                                        </Tooltip>                                     \r\n                                    }\r\n                        \r\n                                    </div>\r\n                                    <div className={classes.toolbarButtons}>\r\n                                        <Tooltip title=\"Select/unselect all files\">\r\n                                            <IconButton color=\"inherit\" onClick={this.doSelectUnselect}>\r\n                                                <Icon path={mdiCheckBoxOutline} size={'1.2rem'} color={this.props.color} />\r\n                                            </IconButton>\r\n                                        </Tooltip>    \r\n                                        <Tooltip title=\"Open selected files\">\r\n                                            <IconButton color=\"inherit\" onClick={this.openSelectedFiles}>\r\n                                                <Icon path={mdiFolderOutline} size={'1.2rem'} color={this.props.color} />\r\n                                            </IconButton>\r\n                                        </Tooltip>                            \r\n                                        <Tooltip title=\"Create a new directory\">\r\n                                            <IconButton color=\"inherit\" onClick={this.createDir}>\r\n                                                <Icon path={mdiFolderPlusOutline} size={'1.2rem'} color={this.props.color} />\r\n                                            </IconButton>\r\n                                        </Tooltip>\r\n                                        <Tooltip title=\"Rename the last selected item\">\r\n                                            <IconButton color=\"inherit\" onClick={this.renameItem}>\r\n                                                <Icon path={mdiSquareEditOutline} size={'1.2rem'} color={this.props.color} />\r\n                                            </IconButton> \r\n                                        </Tooltip>\r\n\r\n                                        <IconButton color=\"inherit\" onClick={this.showOthers}>\r\n                                            <Icon path={mdiDotsHorizontal} size={'1.2rem'} color={this.props.color} />\r\n                                        </IconButton>                           \r\n                                    </div>            \r\n                                </Toolbar>\r\n                            </div> \r\n\r\n                            { visibleOthers ?\r\n                                <div>\r\n                                    <Toolbar variant=\"dense\">\r\n                                        <div className={classes.toolbarButtons}>\r\n                                            <Tooltip title=\"Move the selected items to the clipboard\">                          \r\n                                                <IconButton color=\"inherit\" onClick={this.cutItem}>\r\n                                                    <Icon path={mdiContentCut} size={'1.2rem'} color={this.props.color} />\r\n                                                </IconButton> \r\n                                            </Tooltip>  \r\n                                            <Tooltip title=\"Copy the selected items to the clipboard\">\r\n                                                <IconButton color=\"inherit\" onClick={this.copyItem}>\r\n                                                    <Icon path={mdiContentCopy} size={'1.2rem'} color={this.props.color} />\r\n                                                </IconButton>\r\n                                            </Tooltip>\r\n                                            <Tooltip title=\"Paste clipboard contents to current location\">                             \r\n                                                <IconButton color=\"inherit\" onClick={this.pasteItem}>\r\n                                                    <Icon path={mdiContentPaste} size={'1.2rem'} color={this.props.color} />\r\n                                                </IconButton>   \r\n                                            </Tooltip>  \r\n                                            <Tooltip title=\"Delete the selected items\">    \r\n                                                <IconButton color=\"inherit\" onClick={this.showDeleteDlg}>\r\n                                                    <Icon path={mdiDeleteOutline} size={'1.2rem'} color={this.props.color} />\r\n                                                </IconButton>  \r\n                                            </Tooltip>                                    \r\n                                            <Tooltip title=\"Save the opened image to sandbox file system\"> \r\n                                                <IconButton color=\"inherit\" onClick={this.saveItem}>\r\n                                                    <Icon path={mdiContentSaveOutline} size={'1.2rem'} color={this.props.color} />\r\n                                                </IconButton>      \r\n                                            </Tooltip>\r\n                                            <Tooltip title=\"Export the selected items as zipped archive\">\r\n                                                <IconButton color=\"inherit\" onClick={this.exportItem}>\r\n                                                    <Icon path={mdiExportVariant} size={'1.2rem'} color={this.props.color} />\r\n                                                </IconButton>   \r\n                                            </Tooltip>     \r\n                                            {/*<IconButton color=\"inherit\" onClick={this.downloadItem}>\r\n                                                <Icon path={mdiDownload} size={'1.2rem'} color={this.props.color} />\r\n                                            </IconButton>*/}                                     \r\n                                        </div>            \r\n                                    </Toolbar>\r\n                                </div>\r\n                            : null\r\n                            }\r\n\r\n                            <div>\r\n                                <div>\r\n                                    <Typography \r\n                                        type=\"caption text\" \r\n                                        style={{fontSize: '0.75em', marginLeft: '15px', color: 'rgba(146, 146, 146, 1)', float: 'left'}}>\r\n                                            {'/'+this.props.fsCurrentDir+' '}\r\n                                    </Typography>\r\n                                </div>\r\n                                <div>\r\n                                    <Typography \r\n                                        type=\"caption text\" \r\n                                        style={{fontSize: '0.75em', marginRight: '5px', color: 'rgba(146, 146, 146, 1)', float: 'right'}}>\r\n                                            { totalItemsCount }\r\n                                    </Typography>\r\n                                </div>\r\n                            </div>    \r\n\r\n                            { visibleWaiting ?\r\n                                <div style={{marginTop: '20px', position: 'absolute'}}>\r\n                                    <LinearProgress color=\"secondary\" />\r\n                                </div>\r\n                            : null  \r\n                            }\r\n        \r\n                        </div>\r\n                        \r\n                    }\r\n                    \r\n                    <div style={{height: '200px'}}>\r\n                        <TableContainer component={Paper}>\r\n                            <Table className={classes.table} size=\"small\">\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell>Name</TableCell>\r\n                                        <TableCell align=\"left\">Type</TableCell>\r\n                                        <TableCell align=\"left\">Size</TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                {this.props.fsCurrentList.map((row) => {\r\n                                    const isItemSelected = isSelected(row.name)\r\n                                    return (\r\n                                        <TableRow \r\n                                            key={`${row.parent}/${row.name}`} \r\n                                            role='button' \r\n                                            hover\r\n                                            selected={isItemSelected}\r\n                                            onClick={(e) => {this.itemClick(e, row)}}\r\n                                            onDoubleClick={(e) => {this.itemDoubleClick(e, row)}}\r\n                                            onTouchStart={(e) => this.mouseDown(e, row)} \r\n                                            onTouchEnd={(e) => this.mouseUp(e, row)}\r\n                                            onMouseDown={(e) => this.mouseDown(e, row)} \r\n                                            onMouseUp={(e) => this.mouseUp(e, row)}\r\n                                        >\r\n                                            <TableCell component=\"th\" scope=\"row\">\r\n                                            <Typography className={classes.tableCellText}>\r\n                                                {row.name}\r\n                                            </Typography>    \r\n                                            </TableCell>\r\n                                            <TableCell align=\"left\">{row.type}</TableCell>\r\n                                            <TableCell align=\"left\">{formatBytes(row.size)}</TableCell>\r\n                                        </TableRow>\r\n                                    )\r\n                                })}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </TableContainer>\r\n                    </div>   \r\n\r\n                    <Dialog\r\n                        open={visibleDeleteDlg}\r\n                        onClose={this.hideDeleteDlg}\r\n                    >\r\n                        <DialogTitle>{\"Are you sure to delete selected items?\"}</DialogTitle>\r\n                        <DialogActions>\r\n                            <Button onClick={this.hideDeleteDlg}>\r\n                                Cancel\r\n                            </Button>\r\n                            <Button onClick={this.confirmDeleteDlg} autoFocus>\r\n                                Ok\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </Dialog>    \r\n\r\n                    <Dialog\r\n                        open={visibleAlreadyExistDlg}\r\n                        onClose={this.hideAlreadyExistDlg}\r\n                    >\r\n                        <DialogTitle>{\"An item with this name already exists!\"}</DialogTitle>\r\n                        <DialogActions>\r\n                            <Button onClick={this.hideAlreadyExistDlg} autoFocus>\r\n                                Ok\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </Dialog>    \r\n\r\n                    <Dialog\r\n                        open={visibleOSaveAsDlg}\r\n                    >\r\n                        <DialogTitle>Export archive</DialogTitle>\r\n                        <DialogContent>\r\n                            <DialogContentText>\r\n                                Specify a file name for the archive:\r\n                            </DialogContentText>\r\n                            <TextField\r\n                                autoFocus\r\n                                margin=\"dense\"\r\n                                id=\"id-open-url\"\r\n                                inputRef={input => (this.saveAsField = input)}\r\n                                fullWidth\r\n                            />\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={() => this.hideSaveAs()} >\r\n                                Cancel\r\n                            </Button>\r\n                            <Button onClick={() => this.closeSaveAs()}>\r\n                                Ok\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </Dialog>          \r\n\r\n                    {visibleOpenMultipleFilesDlg ? <OpenMultipleFilesDlg onClose={this.hideOpenMultipleFilesDlg} files={this.files} origin={'fs'} /> : null}                    \r\n                </div>\r\n                </div>\r\n            </PerfectScrollbar>\r\n        )\r\n    }              \r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      files: state.files,\r\n      localFileStore: state.localFile,\r\n      fsFileStore: state.fsFile,  \r\n      activeDcm: state.activeDcm,\r\n      fsCurrentDir: state.fsCurrentDir,\r\n      fsCurrentList: state.fsCurrentList,\r\n      fsZippedFile: state.fsZippedFile,\r\n      fsRefresh: state.fsRefresh,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        setCurrentDir: (dir) => dispatch(setFsCurrentDir(dir)),\r\n        setCurrentList: (list) => dispatch(setFsCurrentList(list)),\r\n        setFsZippedFile: (file) => dispatch(setZippedFile(file)),\r\n        setFsFileStore: (file) => dispatch(fsFileStore(file)),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(FsUI))\r\n","import React, { PureComponent } from 'react'\r\nimport Slider from '@material-ui/core/Slider'\r\nimport {connect} from 'react-redux'\r\n//import * as cornerstone from 'cornerstone-core'\r\n// import { import as csTools } from 'cornerstone-tools'\r\n\r\n// const getRGBPixels = csTools('util/getRGBPixels')\r\n\r\nconst HIST_WIDTH = 256\r\nconst HIST_HEIGHT = 128\r\nconst N_BINS = 256\r\n\r\nconst style = {\r\n  width: '273px', \r\n  padding: '8px 8px 8px 8px', \r\n  backgroundColor: '#444444',\r\n}\r\n\r\nconst styleSlider = {\r\n  width: '255px',\r\n  marginTop: '-9px',\r\n}\r\n\r\nconst styleCanvasGradient = {\r\n  marginTop: '-9px',\r\n}\r\n\r\nconst styleTable = {\r\n  borderCollapse: 'collapse',\r\n  fontFamily: 'Courier, monospace',\r\n  fontSize: '67%',\r\n  width: '100%',\r\n}\r\n\r\nconst styleTableTd = {\r\n  tableLayout: 'fixed',\r\n  width: '25%',\r\n}\r\n\r\nclass Histogram extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.canvasHistogram = React.createRef()\r\n      this.canvasGradient = React.createRef()\r\n    }\r\n\r\n    state = {\r\n      activeDrags: 0,\r\n      deltaPosition: {\r\n        x: 0, y: 0\r\n      },\r\n      controlledPosition: {\r\n        x: -400, y: 200\r\n      },\r\n      value: 128,\r\n      histCount: 0,\r\n      valueScale: 0,\r\n      minHist: 0,\r\n      maxHist: 0,\r\n      mean: 0,\r\n      stdDev: 0,\r\n      indexDcm: -1\r\n    }\r\n\r\n    componentDidMount() {\r\n      //console.log('Histogram - componentDidMount: ')\r\n      //this.image = this.props.activeDcm.image\r\n      //this.element = this.props.activeDcm.element\r\n      //this.isDicom = this.props.activeDcm.isDicom\r\n      //this.pixelData = this.props.activeDcm.image.getPixelData()\r\n      const canvasH = this.canvasHistogram.current\r\n      const ctxH = this.canvasHistogram.current.getContext(\"2d\")\r\n      ctxH.translate(0, canvasH.height)\r\n      ctxH.scale(1, -1)\r\n\r\n      this.updateCanvas()     \r\n    }\r\n    \r\n    componentDidUpdate() {\r\n      //console.log('Histogram - componentDidUpdate: ')\r\n      /*if (this.props.activeDcm === null) {\r\n        const ctxH = this.canvasHistogram.current.getContext(\"2d\")\r\n        ctxH.clearRect(0, 0, ctxH.canvas.width, ctxH.canvas.height)\r\n        return\r\n      }\r\n      this.updateCanvas() */\r\n      if (this.state.indexDcm !== this.props.activeDcmIndex) {\r\n        this.setState({indexDcm: this.props.activeDcmIndex})\r\n        this.updateCanvas()\r\n      }\r\n    }\r\n\r\n    getMousePos(canvas, evt) {\r\n      const rect = canvas.getBoundingClientRect()\r\n      return {\r\n        x: evt.clientX - rect.left,\r\n        y: evt.clientY - rect.top\r\n      }\r\n    }\r\n\r\n    getRGBPixelsImage(x, y, width, height) {\r\n      const pixelData = this.props.activeDcm.image.getPixelData()\r\n      const storedPixelData = []\r\n      x = Math.round(x)\r\n      y = Math.round(y)   \r\n      let index = 0\r\n      let spIndex, row, column\r\n    \r\n      for (row = 0; row < height; row++) {\r\n        for (column = 0; column < width; column++) {\r\n          spIndex = ((row + y) * this.props.activeDcm.image.rows + (column + x)) * 4\r\n          const red = pixelData[spIndex]\r\n          const green = pixelData[spIndex + 1]\r\n          const blue = pixelData[spIndex + 2]\r\n          const alpha = pixelData[spIndex + 3]\r\n  \r\n          storedPixelData[index++] = red\r\n          storedPixelData[index++] = green\r\n          storedPixelData[index++] = blue\r\n          storedPixelData[index++] = alpha\r\n        }\r\n      }\r\n      return storedPixelData\r\n    }\r\n\r\n    getPixelsImage(x, y, width, height) {\r\n      const pixelData = this.props.activeDcm.image.getPixelData()\r\n      const storedPixelData = []\r\n      x = Math.round(x)\r\n      y = Math.round(y)   \r\n      let index = 0\r\n      let spIndex, row, column\r\n    \r\n      for (row = 0; row < height; row++) {\r\n        for (column = 0; column < width; column++) {\r\n          spIndex = ((row + y) * this.props.activeDcm.image.rows + (column + x)) \r\n          storedPixelData[index++] = pixelData[spIndex]\r\n        }\r\n      }\r\n      return storedPixelData\r\n    }    \r\n\r\n    getPixel(x, y) {\r\n      let sp = []\r\n      if (this.props.activeDcm.isDicom) {\r\n        if (this.props.activeDcm.image.color) {\r\n          //sp = getRGBPixels(this.element, x, y, 1, 1)\r\n          //sp = cornerstone.getStoredPixels(this.element, x, y, 1, 1)\r\n          sp = this.getRGBPixelsImage(x, y, 1, 1)\r\n        } else {\r\n          // sp = cornerstone.getStoredPixels(this.props.activeDcm.element, x, y, 1, 1)\r\n          sp = this.getPixelsImage(x, y, 1, 1)\r\n        }\r\n      } else {\r\n        sp = this.getRGBPixelsImage(x, y, 1, 1)\r\n      }\r\n      return sp[0]\r\n    }\r\n\r\n    updateCanvas() {\r\n      if (this.props.activeDcm === null) return\r\n      const image = this.props.activeDcm.image\r\n      if (image === null) return\r\n      //const element = this.props.element\r\n      const maxPixelValue = image.maxPixelValue\r\n      const minPixelValue = image.minPixelValue\r\n      //const k = Math.pow(2, this.props.bitsStored)\r\n      const minHist = minPixelValue+image.intercept\r\n      const maxHist = maxPixelValue+image.intercept\r\n      const lenHist = maxHist-minHist+1\r\n      const binSize = lenHist / N_BINS\r\n      let zero256 = Math.floor(Math.abs(minHist) / binSize)\r\n      let stepWW = Math.round(image.windowWidth / binSize / 2)\r\n      let stepWC = Math.round(image.windowCenter / binSize)\r\n\r\n      this.setState({minHist: minHist})\r\n      this.setState({maxHist: maxHist})\r\n      this.binSize = binSize\r\n\r\n      //console.log('activeDcm: ', this.props.activeDcm)\r\n      //console.log('image: ', )\r\n      //console.log('getPixelData: ', image.getPixelData())\r\n      //console.log('columns: ', image.columns)\r\n      //console.log('rows: ', image.rows)\r\n      //console.log('isDicom: ', this.props.activeDcm.isDicom)\r\n      //console.log('bitsStored: ', k)\r\n      //console.log('minHist: ', minHist)\r\n      //console.log('maxHist: ', maxHist)\r\n      //console.log('lenHist: ', lenHist)\r\n      //console.log('binSize: ', binSize)\r\n      //console.log('zeroHist: ', zero256)\r\n      //console.log('stepWW: ', stepWW)\r\n      //console.log('stepWC: ', stepWC)\r\n      //console.log('zero256-stepWW: ', zero256-stepWW)\r\n      //console.log('zero256+stepWW: ', zero256+stepWW)   \r\n      //console.log('image.color: ', image.color)\r\n      //console.log('image.slope: ', image.slope)\r\n      //console.log('image.intercept: ', image.intercept)\r\n\r\n      let m = 0 // the mean\r\n      // build histogram\r\n      let hist = Array(lenHist).fill(0) \r\n      for (let y = 0; y < image.columns; y++) {\r\n        for (let x = 0; x < image.rows; x++) {\r\n          let sp = this.getPixel(x, y)\r\n          let mo = sp * image.slope + image.intercept\r\n          hist[mo-minHist] += 1\r\n          m += mo\r\n        } \r\n      }  \r\n\r\n      m = m / (image.columns * image.rows)\r\n      this.setState({mean: m})  \r\n\r\n      //console.log('hist: ', hist)\r\n      //console.log('mean: ', m)\r\n\r\n      // calculate standard deviation\r\n      let s = 0\r\n      for (let y = 0; y < image.columns; y++)\r\n        for (let x = 0; x < image.rows; x++) {\r\n          let sp = this.getPixel(x, y)\r\n          let mo = sp * image.slope + image.intercept\r\n          s += Math.pow(mo-m, 2)\r\n        }  \r\n      s = Math.sqrt(s / (image.columns * image.rows))\r\n      this.setState({stdDev: s})\r\n\r\n      // binning the histogram \r\n      let hist256 = Array(N_BINS).fill(0) \r\n      let max = 0\r\n\r\n      if (binSize < 1) {\r\n        let binStep = Math.round(N_BINS / lenHist)\r\n        let iHist = 0\r\n        let i = 0\r\n        while (i < N_BINS) {\r\n          for (let j=0; j < binStep; j++) { \r\n            hist256[i] = iHist < lenHist ? hist[iHist] : 0\r\n            if (max < hist256[i]) max = hist256[i]  \r\n            i++\r\n          }   \r\n          iHist++     \r\n        }\r\n\r\n        /*for (let i=0; i < N_BINS; i+=binStep) {\r\n          const k = Math.floor(i)\r\n          //console.log(`i: ${k} `)\r\n          for (let j=0; j < Math.round(binStep); j++) { \r\n            console.log(`i: ${k} - j: ${j} - iHist: ${iHist} - hist[iHist]: ${hist[iHist]}`)\r\n            hist256[k+j] = hist[iHist]\r\n          }\r\n          iHist++\r\n          if (max < hist256[k]) max = hist256[k] \r\n        }*/\r\n      } else {\r\n        let step = 0\r\n        for (let i=0; i < N_BINS; i++) {\r\n          for (let j=step; j < Math.round(step+binSize); j++) {\r\n            if (j >= lenHist) break\r\n            hist256[i] += hist[j]\r\n          }\r\n          if (max < hist256[i]) { max = hist256[i] }\r\n          step = Math.round(step+binSize)\r\n        }        \r\n      }\r\n\r\n      this.hist256 = hist256\r\n\r\n      //console.log('hist256: ', hist256)\r\n      //console.log('max: ', max)\r\n\r\n      if (max / HIST_HEIGHT > 100) max = max / 5\r\n      \r\n      const canvasH = this.canvasHistogram.current\r\n      const ctxH = this.canvasHistogram.current.getContext(\"2d\")\r\n      ctxH.clearRect(0, 0, ctxH.canvas.width, ctxH.canvas.height)\r\n\r\n      canvasH.addEventListener('pointermove', (evt) => {\r\n        const mousePos = this.getMousePos(canvasH, evt)\r\n        this.setState({histCount: hist256[mousePos.x]})\r\n        let p = Math.round(mousePos.x * this.binSize)\r\n        this.setState({valueScale: p+minHist})\r\n      }, true)\r\n\r\n      //console.log('value: ', (m-minHist)/binSize)\r\n      let value = Math.round((m-minHist)/binSize)\r\n      this.setState({value: value, valueScale: m, histCount: hist256[value]})\r\n      //this.setState({valueScale: m})\r\n      //this.setState({histCount: hist256[value]})\r\n\r\n      // draw WindowWidth area\r\n      ctxH.beginPath()\r\n      ctxH.fillStyle = 'rgba(210, 210, 210, 0.5)'\r\n      ctxH.fillRect(zero256-stepWW+stepWC, 0, stepWW*2, HIST_HEIGHT)\r\n\r\n      // draw histogram\r\n      ctxH.beginPath()\r\n      ctxH.strokeStyle = 'rgba(0, 0, 0, 1.0)'\r\n      for (let i = 0; i < N_BINS; i++) {\r\n        let h = Math.round((hist256[i]/max)*HIST_HEIGHT)\r\n        ctxH.moveTo(i, 0)\r\n        ctxH.lineTo(i, h)\r\n        ctxH.stroke()\r\n      }\r\n      \r\n      // draw WindowCenter cursor\r\n      ctxH.beginPath()\r\n      ctxH.strokeStyle = 'rgba(140, 140, 140, 0.5)'\r\n      ctxH.moveTo(zero256+stepWC, 0)\r\n      ctxH.lineTo(zero256+stepWC, HIST_HEIGHT)\r\n      ctxH.lineWidth = 1\r\n      ctxH.stroke()\r\n          \r\n      let lowX = zero256-stepWW+stepWC\r\n      let highX = zero256+stepWW+stepWC\r\n\r\n      // draw gradient scale\r\n      const canvasG = this.canvasGradient.current\r\n      const ctxG = canvasG.getContext(\"2d\")\r\n\r\n      ctxG.fillStyle = \"#000000\"\r\n      ctxG.fillRect(0, 0, lowX, 10)\r\n\r\n      let grd = ctxG.createLinearGradient(lowX, 0, highX+(lowX < 0 ? lowX : 0), 0)\r\n      grd.addColorStop(0, \"black\")\r\n      grd.addColorStop(1, \"white\")\r\n      ctxG.fillStyle = grd\r\n      ctxG.fillRect(lowX, 0, highX, 10)\r\n    }\r\n        \r\n    handleChangeValue = (event, newValue) => {\r\n      //console.log('old value: ', this.state.value)\r\n      //console.log('new value: ', newValue)\r\n      //console.log('(newValue*this.binSize)+this.state.minHist: ', (newValue*this.binSize)+this.state.minHist)\r\n      //console.log('this.hist256[newValue]: ', this.hist256[newValue])\r\n      this.setState({value: newValue})\r\n      this.setState({valueScale: (newValue*this.binSize)+this.state.minHist})\r\n      this.setState({histCount: this.hist256[newValue]})\r\n    }\r\n      \r\n    hide = () => {\r\n      this.props.onClose()\r\n    }\r\n    \r\n    onDrag = (e, ui) => {\r\n      const {x, y} = this.state.deltaPosition;\r\n      this.setState({\r\n        deltaPosition: {\r\n          x: x + ui.deltaX,\r\n          y: y + ui.deltaY,\r\n        }\r\n      })\r\n    }\r\n  \r\n    onStart = () => {\r\n      this.setState({activeDrags: this.state.activeDrags+1})\r\n    }\r\n  \r\n    onStop = () => {\r\n      this.setState({activeDrags: this.state.activeDrags-1})\r\n    }\r\n    \r\n    render() {\r\n      return (\r\n        <div style={style}>\r\n          <div>\r\n            <canvas \r\n              ref={this.canvasHistogram} \r\n              width={HIST_WIDTH} \r\n              height={HIST_HEIGHT} \r\n              style={{backgroundColor: \"#FFFFFF\", cursor:'crosshair'}} \r\n            />\r\n          </div>  \r\n          <div style={styleCanvasGradient}>\r\n            <canvas ref={this.canvasGradient} width={HIST_WIDTH} height={10} style={{backgroundColor: \"#FFFFFF\"}} />\r\n          </div>\r\n          <div style={styleSlider}>\r\n            <Slider\r\n              value={this.state.value}\r\n              onChange={this.handleChangeValue}\r\n              aria-labelledby=\"continuous-slider\"\r\n              color=\"secondary\"\r\n              min={0}\r\n              max={255}\r\n            />\r\n          </div>\r\n          <div>\r\n            <table style={styleTable}>\r\n              <tbody>\r\n                <tr>\r\n                  <td style={styleTableTd}>min:</td>\r\n                  <td style={styleTableTd}>{this.state.minHist}</td>\r\n                  <td style={styleTableTd}>max:</td>\r\n                  <td style={styleTableTd}>{this.state.maxHist}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>mean:</td>\r\n                  <td>{parseFloat(this.state.mean).toFixed(3)}</td>\r\n                  <td>std dev:</td>\r\n                  <td>{parseFloat(this.state.stdDev).toFixed(3)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>count:</td>\r\n                  <td>{this.state.histCount}</td>\r\n                  <td>value:</td>\r\n                  <td>{parseFloat(this.state.valueScale).toFixed(3)}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n      </div>\r\n      )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    activeDcmIndex: state.activeDcmIndex,\r\n    activeDcm: state.activeDcm,\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Histogram)\r\n","import React, { PureComponent } from 'react'\r\n\r\nconst styleTable = {\r\n  borderCollapse: 'collapse',\r\n  width: '100px',\r\n  height: '100px',\r\n}\r\n\r\nconst styleTableTd = {\r\n  width: '25px',\r\n  height: '25px',\r\n  border: 'solid 1px black',\r\n}\r\n\r\nclass LayoutTool extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.tableRef = React.createRef()\r\n      this.state = {\r\n        row: this.props.row,\r\n        col: this.props.col,\r\n      }\r\n    }\r\n\r\n    componentDidMount() {\r\n      this.initTable()\r\n    }\r\n\r\n    initTable = () => {\r\n      let row = this.state.row\r\n      let col = this.state.col\r\n      let rows = this.tableRef.current.rows\r\n      for (let i=0; i <= row; i++) {\r\n        for(let j=0; j <= col; j++) {\r\n          rows[i].cells[j].bgColor = '#AAAAAA'\r\n        }\r\n      }\r\n    }\r\n\r\n    cellClick = (e) => {\r\n      let row = e.target.parentNode.rowIndex\r\n      let col = e.target.cellIndex\r\n\r\n      this.setState({row: row, col: col})\r\n\r\n      let rows = this.tableRef.current.rows\r\n      for (let i=0; i <= 3; i++) {\r\n        for(let j=0; j <= 3; j++) {\r\n          rows[i].cells[j].bgColor = '#444444'\r\n        }\r\n      }\r\n      for (let i=0; i <= row; i++) {\r\n        for(let j=0; j <= col; j++) {\r\n          rows[i].cells[j].bgColor = '#AAAAAA'\r\n        }\r\n      }\r\n      this.props.onChange(row+1, col+1)\r\n    }\r\n\r\n    renderTable() {\r\n      const rows = ['', '', '', '']\r\n      return (\r\n        rows.map((row, i) => {\r\n          return (\r\n            <tr key={`${i}`}>\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n            </tr>\r\n          )\r\n        })\r\n      )\r\n   }\r\n\r\n    render() {  \r\n      return (\r\n          <div>            \r\n            <table style={styleTable} ref={this.tableRef}>\r\n              <tbody>\r\n                {this.renderTable()}                   \r\n              </tbody>\r\n            </table>\r\n          </div>     \r\n      )\r\n    }\r\n\r\n}\r\n\r\nexport default LayoutTool\r\n","import React, { PureComponent } from 'react'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { \r\n    mdiAngleAcute,\r\n    mdiArrowAll,\r\n    mdiArrowSplitHorizontal,\r\n    mdiCheckboxIntermediate,\r\n    mdiCursorDefault, \r\n    mdiCursorPointer,\r\n    mdiEllipse,\r\n    mdiEyedropper,\r\n    mdiGesture,\r\n    mdiMagnify,\r\n    mdiRectangle,\r\n    mdiRuler,\r\n    mdiVectorLink,\r\n  } from '@mdi/js'\r\n\r\nconst styleTable = {\r\n  borderCollapse: 'collapse',\r\n  width: '120px',\r\n  height: '120px',\r\n}\r\n\r\nconst styleTableTd = {\r\n  width: '40px',\r\n  height: '40px',\r\n  padding: '3px',\r\n  //border: 'solid 1px black',\r\n}\r\n\r\nconst iconSize = '1.2rem'\r\nconst iconColor = '#FFFFFF'\r\nconst activeColor = 'rgba(0, 255, 0, 1.0)'\r\n\r\nclass ToolsPanel extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.tableRef = React.createRef()\r\n    }\r\n\r\n    componentDidMount() {\r\n      \r\n    }\r\n\r\n    colorIcon = (tool) => {\r\n        return this.props.toolActive === tool ? activeColor : iconColor\r\n    }\r\n    \r\n    render() {  \r\n      return (\r\n        <div>            \r\n            <table style={styleTable} ref={this.tableRef}>\r\n                <tbody>\r\n                <tr>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"No Tool\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('notool')}>\r\n                                <Icon path={mdiCursorDefault} size={iconSize} color={this.colorIcon('notool')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Reference Lines\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('referencelines')}>\r\n                                <Icon path={mdiArrowSplitHorizontal} size={iconSize} color={this.props.referenceLines ? activeColor : iconColor} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Link Series\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('serieslink')}>\r\n                                <Icon path={mdiVectorLink} size={iconSize} color={this.props.seriesLink ? activeColor : iconColor} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>                    \r\n                </tr>   \r\n                <tr>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"WW/WC\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Wwwc')}>\r\n                                <Icon path={mdiArrowAll} size={iconSize} color={this.colorIcon('Wwwc')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>    \r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Pan\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Pan')}>\r\n                                <Icon path={mdiCursorPointer} size={iconSize} color={this.colorIcon('Pan')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Zoom\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Zoom')}>\r\n                                <Icon path={mdiMagnify} size={iconSize} color={this.colorIcon('Zoom')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>                                    \r\n                </tr>                   \r\n                <tr>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Magnify\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Magnify')}>\r\n                                <Icon path={mdiCheckboxIntermediate} size={iconSize} color={this.colorIcon('Magnify')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>   \r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Length\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Length')}>\r\n                                <Icon path={mdiRuler} size={iconSize} color={this.colorIcon('Length')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Probe\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Probe')}>\r\n                                <Icon path={mdiEyedropper} size={iconSize} color={this.colorIcon('Probe')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>                    \r\n                </tr> \r\n                <tr>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Angle\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('Angle')}>\r\n                                <Icon path={mdiAngleAcute} size={iconSize} color={this.colorIcon('Angle')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>   \r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Elliptical Roi\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('EllipticalRoi')}>\r\n                                <Icon path={mdiEllipse} size={iconSize} color={this.colorIcon('EllipticalRoi')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Rectangle Roi\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('RectangleRoi')}>\r\n                                <Icon path={mdiRectangle} size={iconSize} color={this.colorIcon('RectangleRoi')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>                    \r\n                </tr> \r\n                <tr>\r\n                    <td style={styleTableTd}>\r\n                        <Tooltip title=\"Freehand Roi\">\r\n                            <IconButton color=\"inherit\" onClick={() => this.props.toolExecute('FreehandRoi')}>\r\n                                <Icon path={mdiGesture} size={iconSize} color={this.colorIcon('FreehandRoi')} />\r\n                            </IconButton>\r\n                        </Tooltip>\r\n                    </td>  \r\n                </tr>                                                               \r\n                </tbody>\r\n            </table>\r\n        </div>     \r\n      )\r\n    }\r\n\r\n}\r\n\r\nexport default ToolsPanel\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport Button from '@material-ui/core/Button'\r\nimport CreateIcon from '@material-ui/icons/Create'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport { withStyles } from '@material-ui/core/styles'\r\n\r\nconst styles = theme => ({\r\n    listItemText:{\r\n        fontSize:'0.9em',\r\n    }\r\n})\r\n\r\nclass MeasureItem extends PureComponent {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.noteField = React.createRef()\r\n    \r\n      }\r\n\r\n    state = { \r\n        visibleDlgNote: false,\r\n        visibleDlgDelete: false,\r\n    }\r\n\r\n    showDlgNote = () => {\r\n        this.setState({ visibleDlgNote: true })\r\n    }\r\n    \r\n    hideDlgNote = () => {\r\n        this.setState({ visibleDlgNote: false })\r\n    }\r\n\r\n    showDlgDelete = () => {\r\n        this.setState({ visibleDlgDelete: true })\r\n    }\r\n    \r\n    hideDlgDelete = () => {\r\n        this.setState({ visibleDlgDelete: false })\r\n    }\r\n\r\n    handleOnChangeNote = event => {\r\n        this.setState({ note: event.target.value })\r\n    }\r\n\r\n    confirmNote = (index) => {\r\n        this.hideDlgNote()\r\n        this.props.measurements[index].note = this.noteField.value\r\n    }   \r\n\r\n    confirmDelete = (index) => {\r\n        this.hideDlgDelete()\r\n        this.props.toolRemove(index)\r\n    }\r\n\r\n    onEdit = () => {\r\n        this.showDlgNote()\r\n    }\r\n    \r\n    onDelete = () => {\r\n        this.showDlgDelete()\r\n    }\r\n    \r\n    render() {    \r\n        const { classes } = this.props\r\n\r\n        const item = this.props.item\r\n        let index = this.props.index\r\n        let pText = ''\r\n        let sText = ''\r\n        //console.log('item: ', item)\r\n        switch (item.tool) {\r\n            case 'Length':\r\n                pText = `${item.data.length.toFixed(2)} ${item.data.unit}`\r\n                sText = item.note\r\n                break\r\n            case 'Angle':\r\n                pText = `${item.data.rAngle} °`\r\n                sText = item.note\r\n                break\r\n            case 'EllipticalRoi':\r\n                pText = <div>\r\n                            <div> A: {item.data.cachedStats.area.toFixed(2)} mm² </div>\r\n                            <div> M: {item.data.cachedStats.mean.toFixed(2)} {item.data.unit} </div>\r\n                            <div> SD: {item.data.cachedStats.stdDev.toFixed(2)} {item.data.unit} </div>\r\n                        </div>\r\n                sText = item.note            \r\n                break    \r\n            case 'RectangleRoi':\r\n                pText = <div>\r\n                            <div> A: {item.data.cachedStats.area.toFixed(2)} mm² </div>\r\n                            <div> M: {item.data.cachedStats.mean.toFixed(2)} {item.data.unit} </div>\r\n                            <div> SD: {item.data.cachedStats.stdDev.toFixed(2)} {item.data.unit} </div>\r\n                        </div>\r\n                sText = item.note\r\n                break          \r\n            case 'FreehandRoi':\r\n                //console.log('item: ', item.data.area)\r\n                //if (item.data.area !== undefined) {\r\n                pText = <div>\r\n                            <div> A: {item.data.area.toFixed(2)} mm² </div>\r\n                            <div> M: {item.data.meanStdDev.mean.toFixed(2)} {item.data.unit} </div>\r\n                            <div> SD: {item.data.meanStdDev.stdDev.toFixed(2)} {item.data.unit} </div>\r\n                        </div>\r\n                sText = item.note\r\n                //}\r\n                break                                  \r\n            default:\r\n                break    \r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <ListItem>\r\n                    <ListItemText classes={{primary:classes.listItemText}} primary={pText} secondary={sText} />\r\n                    <Toolbar>\r\n                        <IconButton edge=\"end\" onClick={() => this.onEdit(index)}>\r\n                            <CreateIcon />\r\n                        </IconButton>\r\n                        <IconButton edge=\"end\" onClick={() => this.onDelete(index)}>\r\n                            <DeleteIcon />\r\n                        </IconButton>\r\n                    </Toolbar>\r\n                </ListItem>\r\n                \r\n                { this.state.visibleDlgNote ?\r\n                    <Dialog\r\n                        open={this.state.visibleDlgNote}\r\n                        onClose={this.hideDlgNote}\r\n                        aria-labelledby=\"form-dialog-title\"\r\n                    >\r\n                        <DialogTitle id=\"form-dialog-title\">{\"Note for measurement:\"}</DialogTitle>\r\n                        <DialogContent>\r\n                            <TextField\r\n                                ref=\"noteField\"\r\n                                autoFocus\r\n                                margin=\"dense\"\r\n                                id=\"note\"\r\n                                fullWidth\r\n                                defaultValue={this.props.measurements[index].note}\r\n                                inputRef={input => (this.noteField = input)}\r\n                            />\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={this.hideDlgNote} >\r\n                                Cancel\r\n                            </Button>\r\n                            <Button onClick={() => this.confirmNote(index)} autoFocus>\r\n                                Ok\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </Dialog>\r\n                : null }\r\n\r\n                <Dialog\r\n                    open={this.state.visibleDlgDelete}\r\n                    onClose={this.hideDlgNote}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                >\r\n                    <DialogTitle id=\"alert-dialog-title\">{\"Are you sure to delete the measurement?\"}</DialogTitle>\r\n                    <DialogActions>\r\n                        <Button onClick={this.hideDlgDelete}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button onClick={() => this.confirmDelete(index)} autoFocus>\r\n                            Ok\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        measurements: state.measurements,\r\n    }\r\n}\r\n\r\n//export default connect(mapStateToProps, )(MeasureItem)\r\nexport default connect(mapStateToProps)(withStyles(styles)(MeasureItem))\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport MeasureItem from './MeasureItem'\r\n\r\nclass Measurements extends PureComponent {\r\n\r\n  state = { \r\n    visibleClearMeasureDlg: false,\r\n  }\r\n\r\n  showClearMeasureDlg = () => {\r\n    this.setState({ visibleClearMeasureDlg: true })\r\n  }\r\n\r\n  hideClearMeasureDlg = () => {\r\n      this.setState({ visibleClearMeasureDlg: false })\r\n  }\r\n\r\n  confirmClearMeasureDlg = () => {\r\n    this.hideClearMeasureDlg()\r\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('removetools')\r\n  }\r\n\r\n  render() {   \r\n    //const classes = this.props.classes\r\n\r\n    return (\r\n      <div>\r\n\r\n        <div>\r\n          { this.props.measurements !== null ?\r\n              this.props.measurements.map((item, index) => {\r\n                  return <MeasureItem item={item} index={index} toolRemove={this.props.toolRemove} key={index} />\r\n              }) \r\n            : null }\r\n        </div>\r\n        \r\n        <Dialog\r\n            open={this.state.visibleClearMeasureDlg}\r\n            onClose={this.hideClearMeasureDlg}\r\n            aria-labelledby=\"alert-dialog-title\"\r\n        >\r\n            <DialogTitle id=\"alert-dialog-title\">{\"Are you sure to remove all the measurements?\"}</DialogTitle>\r\n            <DialogActions>\r\n                <Button onClick={this.hideClearMeasureDlg}>\r\n                    Cancel\r\n                </Button>\r\n                <Button onClick={this.confirmClearMeasureDlg} autoFocus>\r\n                    Ok\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    measurements: state.measurements,\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Measurements)\r\n","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormLabel from '@material-ui/core/FormLabel'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Radio from '@material-ui/core/Radio'\r\nimport RadioGroup from '@material-ui/core/RadioGroup'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport 'react-perfect-scrollbar/dist/css/styles.css'\r\nimport PerfectScrollbar from 'react-perfect-scrollbar'\r\nimport { \r\n  getSettingsSaveAs, \r\n  setSettingsSaveAs, \r\n  getSettingsSaveInto,\r\n  setSettingsSaveInto,\r\n  getSettingsDcmHeader, \r\n  setSettingsDcmHeader, \r\n  getSettingsOverlay, \r\n  setSettingsOverlay,\r\n  getSettingsFsView,\r\n  setSettingsFsView,\r\n  getSettingsDicomdirView,\r\n  setSettingsDicomdirView,\r\n  getSettingsMprInterpolation,\r\n  setSettingsMprInterpolation,\r\n} from '../functions'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  formControl: {\r\n    margin: theme.spacing(3),\r\n  },\r\n  formLabel: {\r\n    fontSize: '0.85em',\r\n  },\r\n  radioControl: {\r\n    size: 'small',\r\n  },  \r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n    fontSize: '0.95em',\r\n  },\r\n}))\r\n\r\n/*const Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"right\" ref={ref} {...props} />;\r\n})*/\r\n\r\nconst Settings = ({ onClose }) => {\r\n  \r\n  let saveAs = getSettingsSaveAs()\r\n  let saveInto = getSettingsSaveInto()\r\n  let exportAs = getSettingsDcmHeader()\r\n  let overlay = getSettingsOverlay()\r\n  let fsView = getSettingsFsView()\r\n  let dicomdirView = getSettingsDicomdirView()\r\n  let mprInterpolation = getSettingsMprInterpolation()\r\n\r\n  //const isIndexedDB = false // 'indexedDB' in window\r\n  \r\n  const handleChangeSaveAs = event => {\r\n    setState({ ...state, 'saveAs': event.target.value })\r\n    setSettingsSaveAs(event.target.value)\r\n  }\r\n  \r\n  const handleChangeSaveInto = event => {\r\n    setState({ ...state, 'saveInto': event.target.value })\r\n    setSettingsSaveInto(event.target.value)\r\n  }\r\n\r\n  const handleChangeExportAs = event => {\r\n    setState({ ...state, 'exportAs': event.target.value })\r\n    setSettingsDcmHeader(event.target.value)\r\n  }\r\n\r\n  const handleChangeOverlay = event => {\r\n    setState({ ...state, 'overlay': event.target.checked })\r\n    setSettingsOverlay(event.target.checked)\r\n  }\r\n\r\n  const handleChangeFsView = event => {\r\n    setState({ ...state, 'fsView': event.target.value })\r\n    setSettingsFsView(event.target.value)\r\n  }\r\n\r\n  const handleChangeDicomdirView = event => {\r\n    setState({ ...state, 'dicomdirView': event.target.value })\r\n    setSettingsDicomdirView(event.target.value)\r\n  }  \r\n\r\n  const handleChangeMprInterpolation = event => {\r\n    setState({ ...state, 'mprInterpolation': event.target.value })\r\n    setSettingsMprInterpolation(event.target.value)\r\n  }  \r\n  const classes = useStyles()\r\n\r\n  const [state, setState] = React.useState({\r\n    saveAs: saveAs,\r\n    saveInto: saveInto,\r\n    exportAs: exportAs,\r\n    overlay: overlay,\r\n    fsView: fsView,\r\n    dicomdirView: dicomdirView,\r\n    mprInterpolation: mprInterpolation,\r\n  })\r\n\r\n  return (\r\n    <Dialog fullScreen open={true} onClose={onClose}> {/* TransitionComponent={Transition} */}\r\n      <AppBar className={classes.appBar} elevation={0}>\r\n        <Toolbar variant=\"dense\">\r\n          <IconButton edge=\"start\" color=\"inherit\" onClick={onClose} aria-label=\"close\">\r\n            <CloseIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            Settings\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <PerfectScrollbar> \r\n      <div>\r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox \r\n                checked={state.overlay} \r\n                onChange={handleChangeOverlay}\r\n                value=\"overlay\" \r\n                size='small'\r\n              />\r\n            }\r\n            label=\"Show overlay Information\"\r\n          />\r\n        </FormControl>\r\n        </div>\r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormLabel component=\"legend\" className={classes.formLabel}>Open sandbox file system from:</FormLabel>\r\n          <RadioGroup size='small' aria-label=\"filesystem\" name=\"filesystem\" value={state.fsView} onChange={handleChangeFsView}>\r\n            <FormControlLabel value=\"left\" control={<Radio size='small' />} label=\"left\" />\r\n            <FormControlLabel value=\"right\" control={<Radio size='small' />} label=\"right\" />\r\n            <FormControlLabel value=\"bottom\" control={<Radio size='small' />} label=\"bottom\" />\r\n          </RadioGroup>\r\n        </FormControl>    \r\n        </div>\r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormLabel component=\"legend\" className={classes.formLabel}>Open DICOMDIR panel from:</FormLabel>\r\n          <RadioGroup size='small' aria-label=\"dicomdir\" name=\"dicomdir\" value={state.dicomdirView} onChange={handleChangeDicomdirView}>\r\n            <FormControlLabel value=\"left\" control={<Radio size='small' />} label=\"left\" />\r\n            <FormControlLabel value=\"right\" control={<Radio size='small' />} label=\"right\" />\r\n            <FormControlLabel value=\"bottom\" control={<Radio size='small' />} label=\"bottom\" />\r\n          </RadioGroup>\r\n        </FormControl>                    \r\n        </div>\r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormLabel component=\"legend\" className={classes.formLabel}>Save screenshot as:</FormLabel>\r\n          <RadioGroup aria-label=\"saveas\" name=\"saveas\" value={state.saveAs} onChange={handleChangeSaveAs}>\r\n            <FormControlLabel value=\"jpeg\" control={<Radio size='small' />} label=\"JPEG\" />\r\n            <FormControlLabel value=\"png\" control={<Radio size='small' />} label=\"PNG\" />\r\n          </RadioGroup>\r\n        </FormControl>\r\n        </div>\r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormLabel component=\"legend\" className={classes.formLabel}>Save screenshot into:</FormLabel>\r\n          <RadioGroup aria-label=\"saveinto\" name=\"saveinto\" value={state.saveInto} onChange={handleChangeSaveInto}>\r\n            <FormControlLabel value=\"local\" control={<Radio size='small' />} label=\"local file system\" />\r\n            <FormControlLabel value=\"sandbox\" control={<Radio size='small' />} label=\"sandbox file system\" />\r\n          </RadioGroup>\r\n        </FormControl>          \r\n        </div>\r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormLabel component=\"legend\" className={classes.formLabel}>Export Dicom header as:</FormLabel>\r\n          <RadioGroup aria-label=\"exportas\" name=\"exportas\" value={exportAs} onChange={handleChangeExportAs}>\r\n            <FormControlLabel value=\"json\" control={<Radio size='small' />} label=\"JSON\" />\r\n            <FormControlLabel value=\"csv\" control={<Radio size='small' />} label=\"CSV\" />\r\n          </RadioGroup>\r\n        </FormControl> \r\n        </div> \r\n        <div>\r\n        <FormControl component=\"fieldset\" className={classes.formControl}>\r\n          <FormLabel component=\"legend\" className={classes.formLabel}>MPR interpolation method:</FormLabel>\r\n          <RadioGroup aria-label=\"mprinterpolation\" name=\"mprinterpolation\" value={mprInterpolation} onChange={handleChangeMprInterpolation}>\r\n            <FormControlLabel value=\"no\" control={<Radio size='small' />} label=\"No interpolation (duplicate planes)\" />\r\n            <FormControlLabel value=\"weightedlinear\" control={<Radio size='small' />} label=\"Weighted linear interpolation\" />\r\n          </RadioGroup>\r\n        </FormControl> \r\n        </div>            \r\n      </div>\r\n      </PerfectScrollbar>\r\n    </Dialog>\r\n  )\r\n\r\n}\r\n\r\nexport default Settings\r\n","import React, { PureComponent } from 'react'\nimport { withStyles } from '@material-ui/core/styles'\nimport {connect} from 'react-redux'\nimport AboutDlg from './components/AboutDlg'\nimport Dicomdir from './components/Dicomdir'\nimport DicomViewer from './components/DicomViewer'\nimport DicomHeader from './components/DicomHeader'\nimport DownloadZipDlg from './components/DownloadZipDlg'\nimport Explorer from './components/Explorer'\nimport FsUI from './components/FsUI'\nimport Histogram from './components/Histogram'\nimport LayoutTool from './components/LayoutTool'\nimport ToolsPanel from './components/ToolsPanel'\nimport Measurements from './components/Measurements'\nimport OpenMultipleFilesDlg from './components/OpenMultipleFilesDlg'\nimport Settings from './components/Settings'\nimport AppBar from '@material-ui/core/AppBar'\nimport Collapse from '@material-ui/core/Collapse'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Divider from '@material-ui/core/Divider'\nimport Drawer from '@material-ui/core/Drawer'\nimport ExpandLess from '@material-ui/icons/ExpandLess'\nimport ExpandMore from '@material-ui/icons/ExpandMore'\nimport Icon from '@mdi/react'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport Popover from '@material-ui/core/Popover'\nimport Slider from '@material-ui/core/Slider'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport TextField from '@material-ui/core/TextField'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport Typography from '@material-ui/core/Typography'\nimport 'react-perfect-scrollbar/dist/css/styles.css'\nimport PerfectScrollbar from 'react-perfect-scrollbar'\n\nimport { \n  isMobile, \n  isTablet,\n} from 'react-device-detect'\n\nimport {\n  clearStore,\n  localFileStore,\n  dcmIsOpen,\n  activeDcm,\n  activeDcmIndex,\n  activeMeasurements,\n  setLayout,\n  dcmTool, \n  setDicomdir,\n  setZippedFile,\n  setVolume,\n  filesStore,\n  explorerActiveSeriesIndex,\n} from './actions/index'\n\nimport { \n  log,\n  getDicomPixelSpacing,\n  getDicomSpacingBetweenSlice,\n  getDicomSliceThickness,\n  getDicomSliceLocation,\n  getDicomStudyId,\n  getDicomIpp,\n  getDicomEchoNumber,\n  getFileExtReal,\n  isInputDirSupported,\n  getSettingsFsView,\n  getSettingsDicomdirView,\n  getSettingsMprInterpolation,\n  groupBy,\n  objectIsEmpty,\n} from './functions'\n\nimport { \n  mdiAngleAcute,\n  mdiAnimationOutline,\n  mdiArrowAll,\n  mdiArrowSplitHorizontal,\n  mdiAxisArrow,\n  mdiCamera,\n  mdiChartHistogram,\n  mdiCheck,\n  mdiCheckboxIntermediate,\n  mdiContentSaveOutline,   \n  mdiCursorDefault, \n  mdiCursorPointer,\n  mdiDelete,\n  mdiEllipse,\n  mdiEyedropper,\n  mdiFileCabinet,\n  mdiFileDocument, \n  mdiFileCad, \n  mdiFolder,\n  mdiFolderMultiple,\n  mdiGesture,\n  mdiCog,\n  mdiViewGridPlusOutline,\n  mdiImageEdit,\n  mdiInformationOutline,\n  mdiInvertColors,\n  mdiMagnify,\n  mdiFolderOpen,\n  mdiRefresh,\n  mdiRectangle,\n  mdiRuler,\n  //mdiToolbox,\n  mdiTools,\n  mdiTrashCanOutline, \n  mdiVectorLink,\n  mdiVideo,\n  mdiWeb,\n  mdiPlay,\n  mdiPause,\n  mdiSkipBackward,\n  mdiSkipForward,\n  mdiSkipNext,\n  mdiSkipPrevious,\n} from '@mdi/js'\n\nimport './App.css'\n\n//import * as cornerstoneTools from \"cornerstone-tools\"\n\nlog()\n\n//localStorage.setItem(\"debug\", \"cornerstoneTools\")\n\nconst drawerWidth = 240\nconst iconColor = '#FFFFFF'\nconst activeColor = 'rgba(0, 255, 0, 1.0)'\n\nconst styles = theme => ({\n  '@global': {\n    body: {\n        backgroundColor: theme.palette.common.black,\n    },\n  },\n\n  grow: {\n    flexGrow: 1,\n  },\n\n  root: {\n    display: 'flex',\n  },\n\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n\n  title: {\n    flexGrow: 1,\n  },\n\n  appBar: {\n    position: 'relative',\n    zIndex: theme.zIndex.drawer + 1,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n  },\n\n  appBarShift: {\n    marginLeft: drawerWidth,\n    width: `calc(100% - ${drawerWidth}px)`,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n\n  hide: {\n    display: 'none',\n  },\n\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n    whiteSpace: 'nowrap',\n  },\n\n  drawerOpen: {\n    width: drawerWidth,\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n\n  drawerClose: {\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n    overflowX: 'hidden',\n    width: theme.spacing(7) + 1,\n    [theme.breakpoints.up('sm')]: {\n      width: theme.spacing(9) + 1,\n    },\n  },\n\n  // Loads information about the app bar, including app bar height\n  toolbar: theme.mixins.toolbar,\n\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(3),\n  },\n\n  listItemText: {\n    fontSize: '0.85em',\n    marginLeft: '-20px'\n  },\n\n})\n\nclass App extends PureComponent {\n\n  constructor(props) {\n    super(props)\n    this.files = []\n    this.folder = null\n    this.file = null\n    this.url = null\n    this.explorer = null\n    this.series = null\n  \n    this.mprData = {}\n    this.mprPlane = ''\n    this.echoNumber = 0\n    \n    this.volume = []\n\n    this.fileOpen = React.createRef()\n    this.showFileOpen = this.showFileOpen.bind(this)\n\n    this.openDicomdir = React.createRef()\n    this.showOpenDicomdir = this.showOpenDicomdir.bind(this)\n\n    this.openFolder = React.createRef()\n    this.showOpenFolder = this.showOpenFolder.bind(this)    \n\n    this.openUrlField = React.createRef()\n    \n    this.dicomViewersActive = []\n    this.dicomViewersActiveSameStudy = []\n    this.dicomViewersActiveSamePlane = []\n    this.dicomViewersRefs = []\n    this.dicomViewers = []\n    for(let i=0; i < 16; i++) {\n      this.dicomViewers.push(this.setDcmViewer(i))\n    }\n\n    this.activeDcmViewersNum = 0\n\n    this.referenceLines = {}\n  }\n\n  state = {\n    anchorElLayout: null,   \n    anchorElToolsPanel: null,   \n    openMenu: false,\n    openImageEdit: false,\n    openTools: false,\n    mprMenu: false,\n    mprMode: false,\n    textMessage: '',\n    titleMessage: '',\n    visibleMainMenu: true,\n    visibleHeader: false,\n    visibleSettings: false,\n    visibleToolbar: true,\n    visibleOpenUrl: false,\n    visibleToolbox: false,\n    visibleTools: false,\n    visibleMeasure: false,\n    visibleClearMeasureDlg: false,\n    visibleAbout: false,\n    visibleDicomdir: false,\n    visibleFileManager: false,\n    visibleZippedFileDlg: false,\n    visibleDownloadZipDlg: false,\n    visibleOpenMultipleFilesDlg: false,\n    toolState: 1,\n    toolActive: 'notool',\n    sliceIndex: 0,\n    sliceMax: 1,\n    listOpenFilesScrolling: false,\n    visibleVolumeBuilding: false,\n    visibleMprOrthogonal: false,\n    visibleMprCoronal: false,\n    visibleMprSagittal: false,\n    visibleMprAxial: false,\n    visibleExplorer: false,\n    visibleMessage: false,\n    visibleReferenceLines: true,\n    visibleSeriesLink: true,\n  }\n\n  /*componentDidUpdate() {\n    console.log('App - componentDidUpdate: ', this.props.explorerActiveSeriesIndex)\n\n  }*/\n\n  setDcmViewer = (index) => {\n    return (\n      <DicomViewer \n        dcmRef={(ref) => {this.dicomViewersRefs[index] = ref}}\n        index={index}\n        dicomViewersRefs={this.dicomViewersRef}\n        runTool={ref => (this.runTool = ref)} \n        changeTool={ref => (this.changeTool = ref)}\n        onLoadedImage={this.onLoadedImage}\n        onRenderedImage={this.onRenderedImage}\n        listOpenFilesPreviousFrame={this.listOpenFilesPreviousFrame}\n        listOpenFilesNextFrame={this.listOpenFilesNextFrame}\n        overlay={true}\n        visible={true}\n      />   \n    )\n  }\n\n  onLoadedImage = () => {\n    //console.log('App - onLoadedImage: ')\n\n  }\n\n  onRenderedImage = (index) => {\n    //console.log('App - onRenderedImage: ', index)\n\n    if (this.referenceLines.crossViewer !== undefined && \n        this.state.visibleReferenceLines \n        && this.isSliceChange \n        && this.referenceLines.crossViewer.layoutIndex === index) {\n      this.isSliceChange = false\n      this.referenceLinesShow()\n    }\n  }\n\n  getDcmViewerRef = (index) => {\n    return this.dicomViewersRefs[index]\n  }\n\n  getDcmViewer = (index) => {\n    return this.dicomViewers[index]\n  }\n\n  getActiveDcmViewer = () => {\n    return this.dicomViewersRefs[this.props.activeDcmIndex]\n  }  \n\n  showFileOpen() {\n    this.props.isOpenStore(false)\n    this.fileOpen.current.click()\n  }\n\n  handleOpenLocalFs = (filesSelected) => {\n    //console.log('handleOpenLocalFs: ', filesSelected)\n    if (filesSelected.length > 1) {\n      this.files = filesSelected\n      this.changeLayout(1, 1)\n      this.mprPlane = ''\n      this.volume = []\n      this.setState({sliceIndex: 0,\n                     sliceMax: 1,\n                     visibleMprOrthogonal: false, \n                     visibleMprCoronal: false, \n                     visibleMprSagittal: false, \n                     visibleMprAxial: false}, () => {\n                       this.setState({visibleOpenMultipleFilesDlg: true})\n                     })\n    } else {\n      const file = filesSelected[0]\n      if (file.type === 'application/x-zip-compressed' || file.type === 'application/zip') {\n        this.file = file\n        this.url = null\n        this.setState({visibleZippedFileDlg: true})\n      } else {\n        this.setState({sliceIndex: 0, sliceMax: 1})\n        this.props.setLocalFileStore(file)\n        this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n        this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openLocalFs', file)      \n      }\n    }\n  }\n\n  handleOpenSandboxFs = (fsItem) => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openSandboxFs', fsItem)\n  }\n\n  handleOpenImage = (index) => {\n    //console.log('handleOpenImage 1: ', index)\n    \n    this.dicomViewersRefs[this.props.activeDcmIndex].sliceIndex = index // this.state.sliceIndex\n\n    const visibleMprOrthogonal = this.state.visibleMprOrthogonal\n    const visibleMprSagittal = this.state.visibleMprSagittal\n    const visibleMprCoronal = this.state.visibleMprCoronal\n    const visibleMprAxial = this.state.visibleMprAxial\n    const plane = this.mprPlanePosition() // plane of source\n    //console.log('handleOpenImage - this.mprPlane: ', this.mprPlane)\n    \n    if (visibleMprOrthogonal) {\n      if (this.props.activeDcmIndex === 0) {\n        this.dicomViewersRefs[0].runTool('openimage', index)\n        if (this.state.mprMode) {\n          this.dicomViewersRefs[1].mprSliceLocation(index)\n          this.dicomViewersRefs[2].mprSliceLocation(index)\n        }\n      } else if (this.props.activeDcmIndex === 1) {\n        if (plane === 'sagittal') { // then open axial plane in second view\n          this.dicomViewersRefs[1].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        } else if (plane === 'axial') { // then open coronal plane in second view\n          this.dicomViewersRefs[1].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        } else { // plane is coronal, then open axial in second view\n          this.dicomViewersRefs[1].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        }\n\n      } else if (this.props.activeDcmIndex === 2) {\n        if (plane === 'sagittal') { // then open axial plane in second view\n          this.dicomViewersRefs[2].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        } else if (plane === 'axial') { // then open coronal plane in second view\n          this.dicomViewersRefs[2].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        } else { // plane is coronal, then open axial in second view\n          this.dicomViewersRefs[2].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        }        \n      }\n\n    } else { \n      if (objectIsEmpty(this.mprData)) { // works on new image\n        this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', index)\n      } else if ((plane === 'sagittal' && visibleMprSagittal) ||\n          (plane === 'axial' && visibleMprAxial) ||\n          (plane === 'coronal' && visibleMprCoronal))\n        this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', index)\n      else if (plane === 'sagittal' && visibleMprAxial)\n        this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)  \n      else if (plane === 'sagittal' && visibleMprCoronal)\n        this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)   \n      else if (plane === 'axial' && visibleMprSagittal)\n        this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n      else if (plane === 'axial' && visibleMprCoronal)\n        this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n      else if (plane === 'coronal' && visibleMprSagittal)\n        this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData) \n      else if (plane === 'coronal' && visibleMprAxial)\n        this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData) \n      else { // it's not a possible MPR, then open as normal dicom file\n        this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', index)           \n      }\n    }\n\n    this.activeDcmViewersNum = this.getActiveDcmViewers()\n    if (this.activeDcmViewersNum > 0) {\n      this.getActiveDcmViewersSameStudy()\n      this.getActiveDcmViewersSamePlane()\n      if (this.state.visibleReferenceLines && this.dicomViewersActive.length > 1) {\n        console.log('handleOpenImage - referenceLinesShow: ')\n        this.referenceLinesShow()      \n      }\n    }\n  }\n  \n  handleOpenFileDicomdir = (file) => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openLocalFs', file)\n  }\n\n  showOpenFolder() {\n    this.openFolder.current.click()\n  }\n\n  showOpenDicomdir() {\n    this.openDicomdir.current.click()\n  }\n\n  handleOpenFolder = (files) => {\n    //console.log('handleOpenFolder: ', files)\n\n    if (this.state.visibleExplorer) {\n      this.setState({visibleExplorer: false}, () => {\n        this.handleOpenFolderDo(files)\n      })\n    } else this.handleOpenFolderDo(files)\n    \n  }\n\n  handleOpenFolderDo = (files) => {\n    //console.log('handleOpenFolderDo: ', files)\n\n    this.changeLayout(1, 1)\n    this.mprPlane = ''\n    this.volume = []\n    this.files = []\n    this.clear()\n\n    this.folder = files[0].webkitRelativePath.split('/')[0]\n\n    for (let i=0; i < files.length; i++) {\n      this.files.push(files[i])\n    }\n\n    this.setState({sliceIndex: 0,\n                    sliceMax: 1,\n                    visibleMprOrthogonal: false, \n                    visibleMprCoronal: false, \n                    visibleMprSagittal: false, \n                    visibleMprAxial: false})\n    this.setState({visibleOpenMultipleFilesDlg: true})        \n  }  \n\n\n  handleOpenDicomdir = (files) => {\n    this.setState({ visibleDicomdir: false }, () => {\n      let dicomdir = null\n      let datafiles = []\n      for (let i=0; i < files.length; i++) {\n        if (files[i].webkitRelativePath.includes('DICOMDIR')) {\n          dicomdir = files[i]\n        } else {\n          datafiles.push(files[i])\n        }\n      }\n      if (dicomdir !== null) {\n        this.props.setDicomdirStore({origin: 'local', dicomdir: dicomdir, files: datafiles})\n        this.toggleDicomdir()\n      } else {\n        this.setState({titleMessage: 'Warning', textMessage: 'The selected folder does not contains any DICOMDIR file.'}, () => {\n          this.setState({ visibleMessage: true })\n        })\n      }\n    })\n  }\n\n  handleOpenFsDicomdir = (fsItem) => {\n    this.props.setDicomdirStore({origin: 'fs', dicomdir: fsItem, files: []})\n    this.toggleDicomdir()\n  }\n\n  componentDidMount() {\n    // Need to set the renderNode since the drawer uses an overlay\n    //this.dialog = document.getElementById('drawer-routing-example-dialog')\n    window.scrollTo(0, 0)\n  }\n\n\n  showAppBar = () => {\n    window.scrollTo(0, 0)\n  }\n  \n\n  toggleMainMenu = () => {\n    const visibleMainMenu = this.state.visibleMainMenu\n    if (getSettingsFsView() === 'left') {\n      this.setState({ visibleMainMenu: !visibleMainMenu, visibleFileManager: false })\n    } else {\n      this.setState({ visibleMainMenu: !visibleMainMenu })\n    }\n  }\n  \n  showMainMenu = () => {\n    this.setState({ visibleMainMenu: true })\n  }\n\n  hideMainMenu = () => {\n    this.setState({ visibleMainMenu: false })\n  }\n\n  handleVisibility = (visibleMainMenu) => {\n    this.setState({ visibleMainMenu })\n  }\n\n\n  toggleFileManager = () => {\n    if (getSettingsFsView() === 'left') {\n      this.setState({visibleMainMenu: false, visibleFileManager: !this.state.visibleFileManager})\n    } else {\n      const visible = !this.state.visibleFileManager\n      this.setState({ visibleFileManager: visible })\n      if (visible) \n        this.setState({ \n          visibleMeasure: false, \n          visibleHeader: false,\n          visibleToolbox: false, \n          visibleDicomdir: false, \n          visibleExplorer: false\n        })        \n    }\n  }\n  \n  toggleExplorer = () => {\n    const visible = !this.state.visibleExplorer\n    this.setState({ visibleExplorer: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleHeader: false,\n        visibleToolbox: false, \n        visibleDicomdir: false, \n        visibleFileManager: false\n      })    \n  }\n\n  toggleHeader = () => {\n    const visible = !this.state.visibleHeader\n    this.setState({ visibleHeader: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleToolbox: false, \n        visibleDicomdir: false, \n        visibleFileManager: false,\n        visibleExplorer: false\n      })    \n  }\n\n\n  toggleToolbox = () => {\n    const visible = !this.state.visibleToolbox\n    this.setState({ visibleToolbox: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleHeader: false, \n        visibleDicomdir: false, \n        visibleFileManager: false,\n        visibleExplorer: false \n      })\n  }\n\n  saveMeasure = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('savetools')\n  }\n  \n  toggleMeasure = () => {\n    const visible = !this.state.visibleMeasure\n    this.setState({ visibleMeasure: visible })\n    if (visible) \n      this.setState({ \n        visibleToolbox: false, \n        visibleHeader: false, \n        visibleDicomdir: false, \n        visibleFileManager: false,\n        visibleExplorer: false\n      })\n  }\n\n  hideMeasure = () => {\n    this.setState({ visibleMeasure: false })\n  }\n\n  handleVisibilityMeasure = (visibleMeasure) => {\n    this.setState({ visibleMeasure })\n  }\n\n\n  toggleDicomdir = () => {\n    const visible = !this.state.visibleDicomdir\n    this.setState({ visibleDicomdir: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleToolbox: false, \n        visibleHeader: false, \n        visibleFileManager: false\n      })\n  }\n  \n\n  clearMeasure = () => {\n    this.showClearMeasureDlg()\n  }\n\n  showClearMeasureDlg = () => {\n    this.setState({ visibleClearMeasureDlg: true })\n  }\n\n  hideClearMeasureDlg = () => {\n      this.setState({ visibleClearMeasureDlg: false })\n  }\n\n  confirmClearMeasureDlg = () => {\n    this.hideClearMeasureDlg()\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('removetools')\n  }\n\n\n  showZippedFileDlg = () => {\n    this.setState({ visibleZippedFileDlg: true })\n  }  \n\n  hideZippedFileDlg = () => {\n      this.setState({ visibleZippedFileDlg: false })\n  }\n\n  confirmZippedFileDlg = () => {\n    this.hideZippedFileDlg()\n    this.setState({ visibleFileManager: true }, () => {\n      if (this.url !== null) {\n        this.setState({visibleDownloadZipDlg: true})\n      } else {\n        this.props.setFsZippedFile(this.file)\n      }\n    })\n  }\n\n\n  showAbout = () => {\n    this.setState({ visibleAbout: !this.state.visibleAbout })\n  }\n  \n  showSettings = () => {\n    this.setState({ \n      visibleMainMenu: false, \n      visibleSettings: true, \n      visibleToolbar: false, \n      position: 'right' \n    })\n  }\n\n  hideSettings = () => {\n    this.setState({ \n      visibleMainMenu: true, \n      visibleSettings: false, \n      visibleToolbar: true,\n      visibleFileManager: false,\n      visibleDicomdir: false, \n    })\n  }\n\n  handleVisibilitySettings = (visibleSettings) => {\n    this.setState({ visibleSettings })\n  }\n\n  hideDownloadZipDlg = () => {\n    this.setState({ visibleDownloadZipDlg: false })\n  }\n\n  hideOpenMultipleFilesDlg = () => {\n    this.setState({ visibleOpenMultipleFilesDlg: false })\n    this.openMultipleFilesCompleted()\n  }\n\n  openMultipleFilesCompleted = () => {\n    //console.log('openMultipleFilesCompleted: ', this.props.files)\n\n    if (this.props.files !== null) {\n      this.changeLayout(1, 1)\n\n      this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', 0)\n\n      const sliceMax = this.props.files.length\n\n      this.setState({sliceMax: sliceMax}, () => {\n \n      })\n\n      // check if there are studies and series, if so then prepare Explorer\n      \n      const patientList = groupBy(this.props.files, a => a.patient.patientName)\n      const patientKeys = [...patientList.keys()]\n      const patient = {\n        list: patientList,\n        keys: patientKeys\n      }\n\n      this.explorer = {\n        folder: this.folder,\n        patient: patient,\n      }\n\n      if (sliceMax > 1)\n        this.setState({visibleExplorer: true, visibleFileManager: false})\n    } \n  }\n\n  showOpenUrl = () => {\n    this.setState({ visibleOpenUrl: true })\n  }\n\n  hideOpenUrl = (openDlg) => {\n    this.setState({ visibleOpenUrl: false },\n      () => {\n        if (openDlg) {\n          this.hideMainMenu()\n          this.file = null\n          this.url = this.openUrlField.value\n          if (getFileExtReal(this.url) === 'zip') {\n            this.setState({visibleZippedFileDlg: true})\n          } else {\n            return this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openurl', this.openUrlField.value)\n          }\n        } \n    })\n  }\n\n  downloadOpenUrl = () => {\n    this.setState({ visibleOpenUrl: false, visibleToolbar: true })\n  }\n  \n  resetImage = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('reset')\n  }\n  \n  saveShot = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('saveas')\n  }\n\n  cinePlayer = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('cine')\n  }\n\n  clear = () => {  \n    this.setState({openImageEdit: false, \n                   openTools: false, \n                   mprMenu: false, \n                   visibleToolbox: false, \n                   visibleMeasure: false, \n                   visibleHeader: false, \n                   visibleDicomdir: false})\n    this.changeLayout(1, 1)\n    this.props.setFilesStore(null)\n    this.props.setDicomdirStore(null)\n    this.props.clearingStore()\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n  }\n\n  //#region Layout handler\n  handleLayout = (event) => {\n    this.setState({anchorElLayout: event.currentTarget})\n  }\n  \n  closeLayout = () => {\n    this.setState({anchorElLayout: null})\n  }\n\n  changeLayout = (row, col) => {\n    // if reduce the grid clear the unused views\n    if (row < this.props.layout[0] || col < this.props.layout[1]) {\n      for(let i=0; i < 4; i++) {\n        for(let j=0; j < 4; j++) {\n          if ((i+1 > row) || (j+1 > col)) {\n            const index = i*4+j\n            this.dicomViewersRefs[index] = undefined\n            if (index === this.props.activeDcmIndex) this.layoutGridClick(index-1)\n          }\n        }\n      }\n      this.activeDcmViewersNum = this.getActiveDcmViewers()\n      if (this.isMultipleFiles && this.activeDcmViewersNum === 1) this.setState({mprMenu: true})\n    }\n    this.props.setLayoutStore(row, col)\n  }\n\n  //#endregion \n\n  //#region Tools panel handler\n  handleToolsPanel = (event) => {\n    this.setState({anchorElToolsPanel: event.currentTarget})\n  }\n\n  closeToolsPanel = () => {\n    this.setState({anchorElToolsPanel: null})\n  }\n  //#endregion\n\n  toolExecute = (tool) => {\n    this.closeToolsPanel()\n    if (tool === 'referencelines') {\n      this.referenceLinesToggle()\n    } else if (tool === 'serieslink') {\n      this.seriesLinkToggle()\n    } else {\n      this.setState({toolActive: tool})\n      this.props.toolStore(tool)\n      this.dicomViewersRefs[this.props.activeDcmIndex].runTool(tool)\n    }    \n  }\n\n  toolChange = () => {\n    const toolState = 1-this.state.toolState\n    this.setState({toolState: toolState}, () => {\n      this.changeTool.changeTool(this.props.tool, toolState)\n    })\n  }\n\n  toolRemove = (index) => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('removetool', index)\n  }\n\n  toggleOpenMenu = () => {\n    this.setState({openMenu: !this.state.openMenu})\n  } \n\n  toggleImageEdit = () => {\n    this.setState({openImageEdit: !this.state.openImageEdit})\n  }\n\n  toggleTools = () => {\n    this.setState({openTools: !this.state.openTools})\n  } \n\n  toggleMpr = () => {\n    this.setState({mprMenu: !this.state.mprMenu})\n  } \n\n  layoutGridClick = (index) => {\n    if (isMobile && index === this.props.activeDcmIndex) return\n\n    console.log('layoutGridClick: ', index)\n\n    this.mprPlanePosition(true, index)\n\n    const sliceMax = this.dicomViewersRefs[index].sliceMax\n    const sliceIndex = this.dicomViewersRefs[index].sliceIndex\n    this.setState({sliceMax: sliceMax, sliceIndex: sliceIndex})\n\n    this.props.setActiveDcmIndex(index)\n\n    if (this.state.visibleMprOrthogonal) {\n      this.setState({sliceMax: sliceMax, sliceIndex: sliceIndex})\n    }  \n\n    const dcmViewer = this.getDcmViewerRef(index)\n    //console.log('layoutGridClick - dcmViewer: ', dcmViewer)\n    if (dcmViewer.image === null) return // click on empty frame\n\n    this.props.setActiveMeasurements(dcmViewer.measurements)\n    this.props.setActiveDcm({image: dcmViewer.image, element: dcmViewer.dicomImage, isDicom: dcmViewer.isDicom})\n    console.log('layoutGridClick - dcmViewer.explorerIndex: ', dcmViewer.explorerIndex)\n    this.props.setExplorerActiveSeriesIndex(dcmViewer.explorerIndex) \n    \n    if (this.state.visibleReferenceLines && this.dicomViewersActive.length > 1) {\n      if (this.referenceLines.scoutViewer !== undefined) this.referenceLines.scoutViewer.updateImage()\n      this.setState({ visibleReferenceLines: false }, () => {\n        this.referenceLinesToggle()      \n      })\n    }\n  }\n \n  layoutGridTouch = (index) => {\n    if (!isMobile && index === this.props.activeDcmIndex) return\n     \n  }\n\n  buildLayoutGrid = () => {\n    \n    //this.referenceLinesHide()\n\n    let dicomviewers = []\n    for(let i=0; i < this.props.layout[0]; i++) {\n      for(let j=0; j < this.props.layout[1]; j++) {\n        const styleLayoutGrid = {\n          border: this.props.layout[0] === 1 && this.props.layout[1] === 1 ? 'solid 1px #000000' : 'solid 1px #444444',\n        }\n        const index = i*4+j\n        dicomviewers.push(\n          <div \n            key={index} \n            style={styleLayoutGrid} \n            onClick={() => this.layoutGridClick(index)} \n            onTouchStart={() => this.layoutGridTouch(index)}\n          >\n            {this.getDcmViewer(index)}\n          </div>        \n        )\n      }\n    }\n\n    return (\n      <div\n        id=\"dicomviewer-grid\"\n        style={{\n          display: 'grid',\n          gridTemplateRows: `repeat(${this.props.layout[0]}, ${100 / this.props.layout[0]}%)`,\n          gridTemplateColumns: `repeat(${this.props.layout[1]}, ${100 / this.props.layout[1]}%)`,\n          height: '100%',\n          width: '100%',\n        }}\n      >\n        {dicomviewers}\n      </div>\n    )\n  }\n\n  getStringVisiblePlane = () => {\n    if (this.state.visibleMprOrthogonal) \n      return 'orthogonal'    \n    else if (this.state.visibleMprSagittal) \n      return 'sagittal'\n    else if (this.state.visibleMprAxial) \n      return 'axial'\n    else if (this.state.visibleMprCoronal) \n      return 'coronal'\n  }\n\n  appBarTitle = (classes, isOpen, dcmViewer) => {\n    if (isMobile && !isTablet) {\n      if (isOpen) \n        return null\n      else \n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            <strong>U</strong> <strong>D</strong>icom <strong>V</strong>iewer\n          </Typography>          \n        )\n    } else {\n      if (isOpen) {\n        const plane = this.getStringVisiblePlane()\n        if (this.state.sliceMax > 1 && this.mprPlane !== plane && this.mprPlane !== '') {\n          return (\n            <Typography variant=\"overline\" className={classes.title}>\n              {'MPR '+plane}\n            </Typography>\n          )        \n        }\n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            {dcmViewer.filename}\n          </Typography>\n        )\n      } else if (this.props.dicomdir !== null) {\n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            {this.props.dicomdir.dicomdir.webkitRelativePath}\n          </Typography>\n        )\n      } else\n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            <strong>U</strong> <strong>D</strong>icom <strong>V</strong>iewer\n          </Typography>\n        )\n    }\n  }\n\n  // ---------------------------------------------------------------------------------------------- LINK SERIES\n  // #region LINK SERIES\n\n  seriesLinkToggle = () => {\n    this.setState({ visibleSeriesLink: !this.state.visibleSeriesLink })\n  }\n\n  // ---------------------------------------------------------------------------------------------- REFERENCE LINES\n  // #region REFERENCE LINES\n\n  referenceLinesToggle = () => {\n    //console.log('referenceLinesToggle: ')\n    if (this.state.mprMode) return\n    const visible = !this.state.visibleReferenceLines\n    this.setState({ visibleReferenceLines: visible })\n    if (visible && this.dicomViewersActive.length > 1) {\n      //console.log('this.props.activeDcmIndex: ', this.props.activeDcmIndex)\n      this.referenceLines.crossViewer = this.getDcmViewerRef(this.props.activeDcmIndex) // this is cross-sectional image\n      const crossMprPlane = this.referenceLines.crossViewer.mprPlane\n      this.openViewers = this.dicomViewersActive.filter(v => v.layoutIndex !== this.props.activeDcmIndex && crossMprPlane !== v.mprPlane)\n      this.referenceLinesDraw()\n    } else {\n      this.referenceLinesHide()\n    }\n  }\n\n  referenceLinesShow = () => {\n    if (this.state.mprMode || !this.state.visibleReferenceLines || this.dicomViewersActive.length < 2) return\n    this.referenceLines.crossViewer = this.getDcmViewerRef(this.props.activeDcmIndex) // this is cross-sectional image\n    const crossMprPlane = this.referenceLines.crossViewer.mprPlane\n    this.openViewers = this.dicomViewersActive.filter(v => v.layoutIndex !== this.props.activeDcmIndex && crossMprPlane !== v.mprPlane)    \n    this.referenceLinesDraw()\n  }\n\n  referenceLinesHide = () => {\n    for(let i=0; i < this.openViewers.length; i++) {\n      this.openViewers[i].updateImage() // this is scout image\n    }\n  }\n\n  referenceLinesDraw = () => {\n    //console.log('referenceLinesDraw: ')\n    this.referenceLines.crossViewer.updateImage()\n    for(let i=0; i < this.openViewers.length; i++) {\n      this.openViewers[i].referenceLinesBuild(this.referenceLines.crossViewer.image) // this is scout image\n    }\n  }\n\n  // #endregion \n\n  // ---------------------------------------------------------------------------------------------- MPR\n  // #region MPR\n\n  getImageOrientationZ = (image) => {\n    const iop = image.data.string('x00200037').split('\\\\') // Image Orientation Patient\n\n    let v = new Array(3).fill(0).map(() => new Array(3).fill(0))\n\n    v[0][0] = parseFloat(iop[0]) // the x direction cosines of the first row X\n    v[0][1] = parseFloat(iop[1]) // the y direction cosines of the first row X\n    v[0][2] = parseFloat(iop[2]) // the z direction cosines of the first row X\n    v[1][0] = parseFloat(iop[3]) // the x direction cosines of the first column Y\n    v[1][1] = parseFloat(iop[4]) // the y direction cosines of the first column Y\n    v[1][2] = parseFloat(iop[5]) // the z direction cosines of the first column Y \n    //console.log('getImageOrientationZ: ', v[1][2])\n    return v[1][2]\n  }\n\n  mprBuildVolume = () => {\n    //console.log('mprBuildVolume: ', this.state.sliceIndex)\n    //console.log('this.files: ', this.files)\n    //console.log('this.dicomViewersRefs[0].files: ', this.dicomViewersRefs[0].files)\n\n    // \"For the specific case of dual-echo MR images select files with same EchoNumber tag of selected image.\n    // see https://groups.google.com/forum/#!topic/comp.protocols.dicom/zh2TzgbjvdE    \n    const echoNumber = getDicomEchoNumber(this.dicomViewersRefs[this.props.activeDcmIndex].image)\n    //console.log('echoNumber: ', echoNumber)\n\n    if (this.volume.length > 0 && echoNumber === this.echoNumber) return\n\n    //const files = this.dicomViewersRefs[0].files\n\n    this.t0 = performance.now()\n\n    const files = this.dicomViewersRefs[0].files.filter((a) => {\n      return a.series.echoNumber === echoNumber}\n    )\n    if (files.length < this.files.length) { // until mprMode is true temporary works on files with same EchoNumber\n      this.echoNumber = echoNumber\n      this.dicomViewersRefs[this.props.activeDcmIndex].runTool('setfiles', files)\n    }\n\n    const sliceIndex = this.state.sliceIndex\n    //const files = this.dicomViewersRefs[0].files\n    const xPixelSpacing = getDicomPixelSpacing(files[sliceIndex].image, 1)\n    const spacingBetweenSlice = getDicomSpacingBetweenSlice(files[sliceIndex].image)\n    const sliceThickness = getDicomSliceThickness(files[sliceIndex].image)\n    const length = files[sliceIndex].image.getPixelData().length\n    const sliceLocation = getDicomSliceLocation(files[sliceIndex].image)\n    this.volume = []\n\n    // see https://stackoverflow.com/questions/58412358/dicom-multiplanar-image-reconstruction\n    this.mprData.zDim = Math.round(files.length * spacingBetweenSlice / xPixelSpacing)\n\n    //console.log('this.mprData.zDim: ', this.mprData.zDim)\n    //console.log('spacingBetweenSlice: ', spacingBetweenSlice)\n    //console.log('sliceThickness: ', sliceThickness)\n    //console.log('xPixelSpacing: ', xPixelSpacing)\n    //console.log('getSliceLocation: ', sliceLocation)\n\n    // If spacing between slices is less than slice thickness, the images are not optimal for 3D reconstruction.\n    // Try an alternative algorithm based on slice distance.\n    let zDimMethod2 = false\n    if (spacingBetweenSlice < sliceThickness && sliceLocation === undefined) {\n      let max = files[sliceIndex].sliceDistance\n      let min = files[sliceIndex].sliceDistance\n      for(let i=0; i < files.length; i++) {\n        if (files[i].sliceDistance > max)\n          max = files[i].sliceDistance\n        if (files[i].sliceDistance < min)\n          min = files[i].sliceDistance  \n      }\n      //console.log('method2, max: ', max)\n      //console.log('method2, min: ', min)\n      //console.log('method2, Math.abs(max - min): ', Math.abs(max - min))\n      this.mprData.zDim = Math.round(Math.abs(max - min) / xPixelSpacing)\n      //console.log('method2, this.mprData.zDim: ', this.mprData.zDim)\n      zDimMethod2 = true\n    }\n    //console.log('this.mprData.zDim: ', this.mprData.zDim)\n    //console.log('files: ', files)\n    //console.log('files.length: ', files.length)\n    this.mprData.zStep = Math.round(this.mprData.zDim / files.length)\n    //console.log('this.mprData.zStep: ', this.mprData.zStep)\n    \n    if (files.length === this.mprData.zDim) { // slices contiguous\n      for (let i = 0, len = files.length; i < len; i++) {\n        this.volume.push(files[i].image.getPixelData())\n      }\n      \n    } else if (files.length < this.mprData.zDim) { // gap between slices\n      \n      let emptyPlane = new Int16Array(length).fill(0)\n      for (let i = 0, len = this.mprData.zDim; i < len; i++) {\n        this.volume.push(emptyPlane)\n      }\n\n      let order = []\n\n      for (let i = 0; i < files.length; i++) {\n        order.push({iFile: i, instanceNumber: files[i].instanceNumber, sliceDistance: files[i].sliceDistance, sliceLocation: files[i].sliceLocation})\n      }\n      //console.log('order: ', order) \n\n      if (zDimMethod2) {\n        // eliminate eventually duplicates\n        order = order.reduce((previous, current) => {\n          let object = previous.filter(object => object.sliceDistance === current.sliceDistance)\n          if (object.length === 0) {\n            previous.push(current)\n          }\n          return previous\n        }, [])\n\n        order.sort((l, r) => {\n          // return r.sliceDistance - l.sliceDistance\n          return l.instanceNumber - r.instanceNumber\n        })     \n        //console.log('order - zDimMethod2: ', order)     \n\n      } else {\n        // const reorder = files[0].sliceDistance < files[1].sliceDistance\n        const reorder = files[sliceIndex].sliceLocation < files[1].sliceLocation\n        if (reorder) {\n          order.sort((l, r) => {\n            // return l.instanceNumber - r.instanceNumber\n            // return r.sliceDistance - l.sliceDistance\n            return r.sliceLocation - l.sliceLocation\n          })    \n        }\n      }\n\n      order.sort((l, r) => {\n        return r.sliceDistance - l.sliceDistance\n        // return l.instanceNumber - r.instanceNumber\n      })  \n      //console.log('order: ', order)\n\n      let intervals = [0]\n      this.volume[0] = files[order[0].iFile].image.getPixelData()\n      this.volume[this.mprData.zDim-1] = files[order[order.length-1].iFile].image.getPixelData()  \n      const step = (this.mprData.zDim-2) / (order.length-2)\n      let i = 0\n      for (let k = 1; k <= order.length-2; k++) {  \n          i = Math.ceil(i+step)\n          //console.log(`i: ${i},  k: ${k},  order[k].iFile: ${order[k].iFile}`)\n          this.volume[i] = files[order[k].iFile].image.getPixelData() // order[k-1].iFile\n          intervals.push(i)\n      }\n      intervals.push(this.mprData.zDim-1)\n      //console.log('intervals: ', intervals)\n      \n      //console.log('this.volume: ', this.volume)\n\n      const interpolationMethod = getSettingsMprInterpolation()\n\n      if (interpolationMethod === 'no') {\n        // build missing planes without interpolation, simple duplicate\n        for (let i = 0; i < intervals.length-1; i++) {\n          //console.log(`intervals: ${intervals[i]} - ${intervals[i+1]}`)\n          for (let j = intervals[i]+1; j <= intervals[i+1]-1; j++) {\n            //console.log(`j: ${j}`)\n            this.volume[j] = this.volume[intervals[i+1]]\n          }\n        }\n\n      } else if (interpolationMethod === 'weightedlinear') {\n        // build the interpolate planes between original planes\n        for (let i = 0; i < intervals.length-1; i++) {\n          //console.log(`intervals: ${intervals[i]} - ${intervals[i+1]}`)\n          const step = intervals[i+1]-intervals[i]\n\n          for (let j = intervals[i]+1; j < intervals[i+1]; j++) {\n            //console.log(`i: ${i}, intervals[i]: ${intervals[i]}, j: ${j}`)\n\n            let p = new Int16Array(length)\n            const w = (j-intervals[i]) / step\n\n            for (let k = 0; k < length-1; k++) {\n              // simple linear interpolation\n              // const p0 = this.volume[intervals[i]][k]\n              // const p1 = this.volume[intervals[i+1]][k]\n              // p[k] = (p0+p1)/2   \n\n              // weighted linear interpolation\n              const p0 = this.volume[intervals[i]][k] * (1-w)\n              const p1 = this.volume[intervals[i+1]][k] * w\n              p[k] = p0+p1\n\n              // weighted bilinear interpolation\n              /*if (k-1 > 0 && k+1 < length) {\n                const p0 = this.volume[intervals[i]][k] * (1-w) * 0.5 + this.volume[intervals[i]][k-1] * (1-w) * 0.25 + this.volume[intervals[i]][k+1] * (1-w) * 0.25\n                const p1 = this.volume[intervals[i+1]][k] * w * 0.5 + this.volume[intervals[i+1]][k-1] * w * 0.25 + this.volume[intervals[i+1]][k+1] * w * 0.25\n                p[k] = p0+p1\n              } else if (k-1 < 0) {\n                const p0 = this.volume[intervals[i]][k] * (1-w) * 0.75 + this.volume[intervals[i]][k+1] * (1-w) * 0.25\n                const p1 = this.volume[intervals[i+1]][k] * w * 0.5 + this.volume[intervals[i+1]][k+1] * w * 0.25\n                p[k] = p0+p1\n              } else { // k+1 > length \n                const p0 = this.volume[intervals[i]][k] * (1-w) * 0.75 + this.volume[intervals[i]][k-1] * (1-w) * 0.25\n                const p1 = this.volume[intervals[i+1]][k] * w * 0.5 + this.volume[intervals[i+1]][k-1] * w * 0.25\n                p[k] = p0+p1\n              }*/\n            }\n\n            this.volume[j]= p\n          }\n        }\n      }\n\n      this.t1 = performance.now()\n      console.log(`performance volume building: ${this.t1-this.t0} milliseconds`)\n\n    } else { // overlapping slices\n      this.mprData.zStep = Math.round(files.length / this.mprData.zDim)\n      for (let i = 0, len = this.mprData.zDim; i < len; i++) {\n        const k = i*this.mprData.zStep\n        this.volume.push(files[k].image.getPixelData())\n      }  \n    }\n\n    const index = Math.round(files.length / 2)\n    this.setState({sliceIndex: index}, () => {\n      if (this.state.visibleMprOrthogonal) {\n        this.changeToOrthogonalView()\n\n      } else if (this.state.visibleMprSagittal) {\n        this.changeToSagittalView()\n\n      } else if (this.state.visibleMprCoronal) {\n        this.changeToCoronalView()  \n\n      } else { // axial\n        this.changeToAxialView()\n      }      \n    })\n          \n  }\n\n  changeToOrthogonalView = () => {  \n    //console.log('changeToOrthogonalView - files: ', this.dicomViewersRefs[0].files)\n    \n    this.setState({sliceMax: this.dicomViewersRefs[0].files.length})\n\n    this.changeLayout(1, 3)\n\n    const index = Math.trunc(this.dicomViewersRefs[0].files.length / 2)\n\n    this.setState({visibleVolumeBuilding: false, sliceIndex: index, mprMode: true}, () => {\n      const plane = this.mprPlanePosition()\n\n      if (this.dicomViewersRefs[0].volume === null)\n        this.dicomViewersRefs[0].volume = this.volume\n\n      this.dicomViewersRefs[0].runTool('openimage', index)\n\n      if (this.dicomViewersRefs[1].volume === null)\n        this.dicomViewersRefs[1].volume = this.volume\n      \n      this.dicomViewersRefs[1].runTool('setfiles', this.files)\n      this.dicomViewersRefs[1].explorerIndex = this.dicomViewersRefs[0].explorerIndex\n      this.dicomViewersRefs[1].sliceMax = this.dicomViewersRefs[0].files[index].image.columns\n      const xzIndex = Math.trunc(this.dicomViewersRefs[1].sliceMax / 2)\n      this.dicomViewersRefs[1].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, xzIndex, this.mprData)  \n      \n      if (this.dicomViewersRefs[2].volume === null)\n        this.dicomViewersRefs[2].volume = this.volume\n\n      this.dicomViewersRefs[2].runTool('setfiles', this.files) \n      this.dicomViewersRefs[2].explorerIndex = this.dicomViewersRefs[0].explorerIndex\n      this.dicomViewersRefs[2].sliceMax = this.dicomViewersRefs[0].files[index].image.columns\n      const yzIndex = Math.trunc(this.dicomViewersRefs[2].sliceMax / 2) \n      this.dicomViewersRefs[2].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, yzIndex, this.mprData)      \n    })\n\n  }\n\n  changeToSagittalView = () => {\n    //console.log('changeToSagittalView: ')\n\n    this.changeLayout(1, 1)\n\n    this.setState({visibleVolumeBuilding: false}, () => {\n      const plane = this.mprPlanePosition()\n\n      if (this.dicomViewersRefs[this.props.activeDcmIndex].volume === null)\n        this.dicomViewersRefs[this.props.activeDcmIndex].volume = this.volume\n\n      if (plane === 'sagittal') { \n        this.dicomViewersRefs[0].runTool('setfiles', this.files) // due to EchoNumber can be changed\n        const sliceMax = this.dicomViewersRefs[0].files === null ? 1 : this.dicomViewersRefs[0].files.length\n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax, mprMode: false}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', index)\n        })\n      } else if (plane === 'axial') {\n        const sliceMax = this.dicomViewersRefs[0].files[0].image.rows // this.mprData.zDim \n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        })   \n      } else {\n        const sliceMax = this.dicomViewersRefs[0].files[0].image.columns // this.mprData.zDim \n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        }) \n      }      \n    })\n  }\n\n  changeToCoronalView = () => {  \n    this.changeLayout(1, 1)\n\n    this.setState({visibleVolumeBuilding: false}, () => {\n      const plane = this.mprPlanePosition()\n\n      if (this.dicomViewersRefs[this.props.activeDcmIndex].volume === null)\n        this.dicomViewersRefs[this.props.activeDcmIndex].volume = this.volume\n\n      if (plane === 'coronal') {\n        this.dicomViewersRefs[0].runTool('setfiles', this.files) // due to EchoNumber can be changed\n        const sliceMax = this.dicomViewersRefs[0].files === null ? 1 : this.dicomViewersRefs[0].files.length\n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax, mprMode: false}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', index)\n        })       \n\n      } else if (plane === 'axial') {\n        const sliceMax = this.dicomViewersRefs[0].files[0].image.columns // this.mprData.zDim \n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        })\n\n      } else { // plane is sagittal\n        const sliceMax = this.dicomViewersRefs[0].files[0].image.rows // this.mprData.zDim \n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        })  \n      }      \n    })\n  }\n\n  changeToAxialView = () => {  \n    this.changeLayout(1, 1)\n\n    this.setState({visibleVolumeBuilding: false}, () => {\n      const plane = this.mprPlanePosition()\n          \n      if (this.dicomViewersRefs[this.props.activeDcmIndex].volume === null)\n        this.dicomViewersRefs[this.props.activeDcmIndex].volume = this.volume\n\n      if (plane === 'axial') {\n        this.dicomViewersRefs[0].runTool('setfiles', this.files) // due to EchoNumber can be changed\n        const sliceMax = this.dicomViewersRefs[0].files === null ? 1 : this.dicomViewersRefs[0].files.length\n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax, mprMode: false}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openimage', index)\n        })\n        \n\n      } else if (plane === 'sagittal') {\n        const sliceMax = this.dicomViewersRefs[0].files[0].image.columns // this.mprData.zDim \n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderXZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        })\n        \n\n      } else {\n        const sliceMax = this.dicomViewersRefs[0].files[0].image.rows // this.mprData.zDim \n        const index = Math.trunc(sliceMax / 2)\n        this.setState({sliceIndex: index, sliceMax: sliceMax}, () => {\n          this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax = sliceMax\n          this.dicomViewersRefs[this.props.activeDcmIndex].mprRenderYZPlane(this.dicomViewersRefs[0].filename, plane, index, this.mprData)\n        })             \n      }      \n    })\n  }\n\n  mprPlanePosition = (force = false, index = this.props.activeDcmIndex) => {\n    //console.log('App - mprPlanePosition: ', index)\n    if (this.mprPlane === '' || force) {\n      this.mprPlane = this.dicomViewersRefs[index].mprPlanePosition()\n      if (!this.state.visibleMprOrthogonal) {\n        if (this.mprPlane === 'sagittal')\n          this.setState({ visibleMprOrthogonal: false, visibleMprSagittal: true, visibleMprAxial: false, visibleMprCoronal: false})\n        else if (this.mprPlane === 'coronal')\n          this.setState({ visibleMprOrthogonal: false, visibleMprSagittal: false, visibleMprAxial: false, visibleMprCoronal: true })  \n        else \n          this.setState({ visibleMprOrthogonal: false, visibleMprSagittal: false, visibleMprAxial: true, visibleMprCoronal: false })        \n      }\n    }\n    return this.mprPlane  \n  }\n\n  mprOrthogonal = () => {\n    const visibleMprOrthogonal = this.state.visibleMprOrthogonal\n    if (!visibleMprOrthogonal) {\n      this.mprData.plane = {\n        from: this.mprPlane,\n        to: 'orthogonal'\n      }\n      this.setState({visibleMprOrthogonal: true, \n                    visibleMprCoronal: false, \n                    visibleMprSagittal: false, \n                    visibleMprAxial: false}, () => {\n        if (this.volume.length === 0) {   \n          this.setState({visibleVolumeBuilding: true}, () => {           \n            setTimeout(() => {\n              this.mprBuildVolume()\n            }, 100)   \n          })\n        } else {\n          this.changeToOrthogonalView()\n        }\n      })\n    }\n  }\n\n  mprSagittal = () => {\n    const visibleMprSagittal = this.state.visibleMprSagittal\n    if (!visibleMprSagittal) {\n      this.mprData.plane = {\n        from: this.mprPlane,\n        to: 'sagittal'\n      }\n      this.setState({visibleMprOrthogonal: false, \n                    visibleMprSagittal: true, \n                    visibleMprCoronal: false, \n                    visibleMprAxial: false}, () => {\n        if (this.volume.length === 0) {   \n          this.setState({visibleVolumeBuilding: true}, () => {           \n            setTimeout(() => {\n              this.mprBuildVolume()\n            }, 100)   \n          })\n        } else {\n          this.changeToSagittalView()\n        }\n      })\n    }\n  }\n    \n  mprCoronal = () => {\n    const visibleMprCoronal = this.state.visibleMprCoronal\n    if (!visibleMprCoronal) {\n      this.mprData.plane = {\n        from: this.mprPlane,\n        to: 'coronal'\n      }\n      this.setState({visibleMprOrthogonal: false, \n                     visibleMprSagittal: false, \n                     visibleMprCoronal: true, \n                     visibleMprAxial: false}, () => {\n        if (this.volume.length === 0) {   \n          this.setState({visibleVolumeBuilding: true}, () => {           \n            setTimeout(() => {\n              this.mprBuildVolume()\n            }, 100)   \n          })\n        } else {\n          this.changeToCoronalView()\n        }\n      })\n    }\n  }\n\n  mprAxial = () => {\n    const visibleMprAxial = this.state.visibleMprAxial\n    if (!visibleMprAxial) {\n      this.mprData.plane = {\n        from: this.mprPlane,\n        to: 'axial'\n      }\n      this.setState({visibleMprOrthogonal: false, \n                     visibleMprSagittal: false, \n                     visibleMprCoronal: false, \n                     visibleMprAxial: true}, () => {\n        if (this.volume.length === 0) {   \n          this.setState({visibleVolumeBuilding: true}, () => {           \n            setTimeout(() => {\n              this.mprBuildVolume()\n            }, 100)   \n          })\n        } else {\n          this.changeToAxialView()\n        }\n      })\n    }\n  }\n\n  // #endregion \n  \n  // ---------------------------------------------------------------------------------------------- FILES/SLICE MANIPULATION\n  //#region FILES/SLICE MANIPULATION\n\n  listOpenFilesFirstFrame = () => {\n    const index = 0\n    this.setState({sliceIndex: index}, () => {\n      this.isSliceChange = true\n      this.handleOpenImage(index)\n    })\n  }\n\n  listOpenFilesPreviousFrame = () => {\n    let index = this.state.sliceIndex\n    index = index === 0 ? this.state.sliceMax-1 : index-1\n    this.setState({sliceIndex: index}, () => {\n      this.isSliceChange = true\n      this.handleOpenImage(index)\n      this.syncActiveDcmViewersSamePlane(-1)\n    })\n  } \n\n  listOpenFilesNextFrame = () => {\n    let index = this.state.sliceIndex\n    index = index === this.state.sliceMax-1 ? 0 : index+1\n    this.setState({sliceIndex: index}, () => {\n      this.isSliceChange = true\n      this.handleOpenImage(index)\n      this.syncActiveDcmViewersSamePlane(+1)\n    })\n  }  \n\n  listOpenFilesLastFrame = () => {\n    const index = this.state.sliceMax-1\n    this.setState({sliceIndex: index}, () => {\n      this.isSliceChange = true\n      this.handleOpenImage(index)\n    })\n  }  \n\n  listOpenFilesScrolling = () => {  \n    const scrolling = this.state.listOpenFilesScrolling\n    this.setState({listOpenFilesScrolling: !scrolling}, () => {\n      if (scrolling) {\n        clearInterval(this.timerScrolling)\n      } else {\n        this.timerScrolling = setInterval(() => {\n          this.listOpenFilesNextFrame()\n        }, 500)\n      }      \n    })\n  }\n\n  handleSliceChange = (event, value) => {\n    this.setState({sliceIndex: Math.floor(value)}, () => {\n      let index = this.state.sliceIndex\n      this.isSliceChange = true\n      this.handleOpenImage(index)\n    })\n  }\n\n  //#endregion\n\n  // ---------------------------------------------------------------------------------------------- EXPLORER\n  //#region EXPLORER\n\n  explorerOnSelectSeries = (files, explorerIndex) => {\n    //console.log('explorerOnSelectSeries: ', files)\n    if (this.state.mprMode) return\n\n    this.files = files\n    this.mprPlane = ''\n    this.mprData = {}\n    this.volume = []\n\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('setfiles', this.files)\n    this.dicomViewersRefs[this.props.activeDcmIndex].explorerIndex = explorerIndex\n\n    const sliceMax = this.dicomViewersRefs[this.props.activeDcmIndex].sliceMax\n    const sliceIndex = this.dicomViewersRefs[this.props.activeDcmIndex].sliceIndex\n    this.setState({sliceMax: sliceMax, sliceIndex: sliceIndex})\n\n    this.handleOpenImage(sliceIndex)\n  }\n\n  //#endregion EXPLORER\n\n  getActiveDcmViewers = () => {\n    this.dicomViewersActive = this.dicomViewersRefs.filter(v => v !== undefined && v.image !== null)\n    //console.log('App - this.dicomViewersActive', this.dicomViewersActive)\n    return this.dicomViewersActive.length\n  }  \n\n  getActiveDcmViewersSameStudy = () => {\n    const studyId = getDicomStudyId(this.dicomViewersRefs[this.props.activeDcmIndex].image)\n    this.dicomViewersActiveSameStudy = this.dicomViewersRefs.filter(v => v !== undefined && getDicomStudyId(v.image) === studyId)\n    //console.log('App - this.dicomViewersActiveSameStudy', this.dicomViewersActiveSameStudy)\n    return this.dicomViewersActiveSameStudy.length\n  }  \n\n  getActiveDcmViewersSamePlane = () => {\n    this.dicomViewersActiveSamePlane = []\n    const plane = this.dicomViewersRefs[this.props.activeDcmIndex].mprPlane\n    //console.log('App - getActiveDcmViewersSamePlane - plane: ', plane)\n    for(let i=0; i < this.dicomViewersActiveSameStudy.length; i++) {\n      //console.log('App - getActiveDcmViewersSamePlane - i: ', i)\n      //console.log('App - getActiveDcmViewersSamePlane - this.dicomViewersActiveSameStudy[i].mprPlane: ', this.dicomViewersActiveSameStudy[i].mprPlane)\n      if (this.dicomViewersActiveSameStudy[i].mprPlane === plane && \n          this.dicomViewersActiveSameStudy[i].layoutIndex !== this.props.activeDcmIndex)\n        this.dicomViewersActiveSamePlane.push(this.dicomViewersActiveSameStudy[i])\n    }\n    //console.log('App - getActiveDcmViewersSamePlane - this.dicomViewersActiveSamePlane: ', this.dicomViewersActiveSamePlane)\n  }\n\n  syncActiveDcmViewersSamePlane = (direction) => {\n    if (!this.state.visibleSeriesLink) return\n    if (this.dicomViewersActiveSamePlane.length > 0) {\n      const plane = this.dicomViewersRefs[this.props.activeDcmIndex].mprPlane\n      const ippX = getDicomIpp(this.dicomViewersRefs[this.props.activeDcmIndex].image, 0)\n      const ippY = getDicomIpp(this.dicomViewersRefs[this.props.activeDcmIndex].image, 1)\n      const ippZ = getDicomIpp(this.dicomViewersRefs[this.props.activeDcmIndex].image, 2)\n\n      //console.log('App - syncActiveDcmViewersSamePlane - plane: ', plane)\n      //console.log('App - syncActiveDcmViewersSamePlane - ippX: ', ippX)\n      //console.log('App - syncActiveDcmViewersSamePlane - ippY: ', ippY)\n      //console.log('App - syncActiveDcmViewersSamePlane - ippZ: ', ippZ)\n\n      let j = 0\n      for(let i=0; i < this.dicomViewersActiveSamePlane.length; i++) {\n        if (plane === 'sagittal')\n          j = this.dicomViewersActiveSamePlane[i].findFirstSliceWithIppValue(ippX, 0)\n        else if (plane === 'coronal') \n          j = this.dicomViewersActiveSamePlane[i].findFirstSliceWithIppValue(ippY, 1)\n        else if (plane === 'axial') \n          j = this.dicomViewersActiveSamePlane[i].findFirstSliceWithIppValue(ippZ, 2)\n        //console.log('App - syncActiveDcmViewersSamePlane - j: ', j)\n        if (j >= 0) \n          this.dicomViewersActiveSamePlane[i].runTool('openimage', j)\n      }\n    }\n  }\n  \n\n  colorIcon = (tool) => {\n    return this.state.toolActive === tool ? activeColor : iconColor\n  }\n\n  render() {\n    //console.log('App render: ')\n\n    const { classes } = this.props\n\n    const primaryClass = {primary:classes.listItemText}\n    const iconSize = '1.2rem'\n    const iconSizeSmall = '1.0rem'\n    \n    //const isMultipleView = this.props.layout[0] > 1 || this.props.layout[1] > 1\n    const isOpen = this.props.isOpen[this.props.activeDcmIndex]\n    const isDicomdir = this.props.dicomdir !== null\n    this.isMultipleFiles = false\n    if (this.dicomViewersRefs[this.props.activeDcmIndex] === undefined) {\n      this.isMultipleFiles = false\n    } else {\n      if (this.dicomViewersRefs[this.props.activeDcmIndex].files !== null) \n        this.isMultipleFiles = this.dicomViewersRefs[this.props.activeDcmIndex].files.length > 1\n      else\n        this.isMultipleFiles = false\n    }\n    //console.log('isMultipleFiles: ', this.isMultipleFiles)\n    //const isMultipleView = this.activeDcmViewersNum > 1\n\n    const openMenu = this.state.openMenu\n    const openImageEdit = this.state.openImageEdit\n    const openTools = this.state.openTools\n    const visibleMainMenu = this.state.visibleMainMenu\n    const visibleHeader = this.state.visibleHeader\n    const visibleSettings = this.state.visibleSettings\n    const visibleAbout = this.state.visibleAbout\n    const visibleMeasure = this.state.visibleMeasure\n    const visibleToolbox = this.state.visibleToolbox\n    const visibleDicomdir = this.state.visibleDicomdir\n    const visibleFileManager = this.state.visibleFileManager\n    const visibleClearMeasureDlg = this.state.visibleClearMeasureDlg\n    const visibleZippedFileDlg = this.state.visibleZippedFileDlg \n    const visibleDownloadZipDlg = this.state.visibleDownloadZipDlg\n    const visibleOpenMultipleFilesDlg = this.state.visibleOpenMultipleFilesDlg\n    const visibleLayout = Boolean(this.state.anchorElLayout)\n    const visibleVolumeBuilding = this.state.visibleVolumeBuilding\n    const visibleMprOrthogonal = this.state.visibleMprOrthogonal\n    const visibleMprCoronal = this.state.visibleMprCoronal\n    const visibleMprSagittal = this.state.visibleMprSagittal\n    const visibleMprAxial = this.state.visibleMprAxial\n    const visibleExplorer = this.state.visibleExplorer\n    const visibleReferenceLines = this.state.visibleReferenceLines\n    const visibleSeriesLink = this.state.visibleSeriesLink\n    const visibleToolsPanel = Boolean(this.state.anchorElToolsPanel)\n    const mprMenu = this.state.mprMenu && this.mprPlane !== '' //  && isMultipleFiles\n\n    //let iconToolColor = this.state.toolState === 1 ? '#FFFFFF' : '#999999'\n\n    const dcmViewer = this.getActiveDcmViewer()\n\n    const sliceMax = this.state.sliceMax\n\n    //console.log('dcmViewer: ', dcmViewer)\n    //console.log('this.mprPlane: ', this.mprPlane)\n    //console.log('mprMenu: ', mprMenu)\n    //console.log('mprMode: ', this.state.mprMode)\n    \n    return (\n      <div>\n        <AppBar className={classes.appBar} position='static' elevation={0}>\n          <Toolbar variant=\"dense\">\n            <IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\" onClick={this.toggleMainMenu}>\n              <MenuIcon />\n            </IconButton>\n            { this.appBarTitle(classes, isOpen, dcmViewer) }\n            \n            <div className={classes.grow} />\n            { !isOpen && !isDicomdir ? (\n              <IconButton onClick={this.showAbout}>\n                <Icon path={mdiInformationOutline} size={iconSize} color={iconColor} />\n              </IconButton> \n             ) : null\n            }        \n            {/*    \n            { iconTool !== null && this.props.tool !== null &&  isOpen ? (\n                <IconButton onClick={this.toolChange}>\n                  <Icon path={iconTool} size={iconSize} color={iconToolColor} />\n                </IconButton>\n              ) : null\n            }\n            */}\n            { isOpen && dcmViewer.numberOfFrames > 1 &&  isOpen ? (\n              <Tooltip title=\"Cine Player\">\n                <IconButton onClick={this.cinePlayer}>\n                  <Icon path={mdiVideo} size={iconSize} color={iconColor} />\n                </IconButton> \n              </Tooltip>\n              ): null\n            }\n            { isOpen ? (\n              <Tooltip title=\"Reset Image\">\n                <IconButton onClick={this.resetImage}>\n                  <Icon path={mdiRefresh} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n             ) : null\n            }            \n            { isOpen ? (\n              <Tooltip title=\"Tools\">\n                <IconButton onClick={this.handleToolsPanel}>\n                  <Icon path={mdiTools} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n             ) : null\n            }            \n            { isOpen ? (\n              <Tooltip title=\"Save Screenshot\">\n                <IconButton color=\"inherit\" onClick={this.saveShot}>\n                  <Icon path={mdiCamera} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n             ) : null\n            }\n            {/* isOpen ? (\n              <Tooltip title=\"Toolbox\">\n                <IconButton color=\"inherit\" onClick={this.toggleToolbox}>\n                  <Icon path={mdiToolbox} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n              ) : null\n            */}              \n            { isOpen ? (\n              <Tooltip title=\"Measurements\">\n                <IconButton color=\"inherit\" onClick={this.toggleMeasure}>\n                  <Icon path={mdiFileCad} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n              ) : null\n            }  \n            { isOpen && dcmViewer.isDicom ? (\n              <Tooltip title=\"Dicom Header\">\n                <IconButton color=\"inherit\" onClick={this.toggleHeader}>\n                  <Icon path={mdiFileDocument} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n              ) : null\n            }  \n            { isDicomdir ? (\n              <Tooltip title=\"DICOMDIR\">\n                <IconButton color=\"inherit\" onClick={this.toggleDicomdir}>\n                  <Icon path={mdiFolderOpen} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n              ) : null\n            }    \n            { (isOpen && this.isMultipleFiles) || visibleMprOrthogonal ? (\n              <Tooltip title=\"Explorer\">\n                <IconButton color=\"inherit\" onClick={this.toggleExplorer}>\n                  <Icon path={mdiAnimationOutline} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n              ) : null\n            }             \n            { isOpen ? (\n              <Tooltip title=\"Sandbox File Manager\">\n                <IconButton color=\"inherit\" onClick={this.toggleFileManager}>\n                  <Icon path={mdiFileCabinet} size={iconSize} color={iconColor} />\n                </IconButton>\n              </Tooltip>\n              ) : null\n            }                        \n          </Toolbar>\n        </AppBar>\n\n        <Drawer \n          variant=\"persistent\"\n          open={visibleMainMenu} \n          style={{position:'relative', zIndex: 1}}\n          onClose={this.toggleMainMenu}\n        >\n          <div className={classes.toolbar}>\n          <PerfectScrollbar>   \n            <List dense={true}>\n              <ListItem button onClick={() => this.showAppBar()}>\n                <ListItemIcon><MenuIcon /></ListItemIcon>\n                <ListItemText primary='Tool Bar' />\n              </ListItem>    \n              <ListItem button onClick={() => this.toggleFileManager()}>\n                <ListItemIcon><Icon path={mdiFileCabinet} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='File Manager' />\n              </ListItem>      \n              \n              <ListItem button onClick={() => this.toggleOpenMenu()}>\n                <ListItemIcon><Icon path={mdiFolderMultiple} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Open ...' />\n                {openMenu ? <ExpandLess /> : <ExpandMore />}\n              </ListItem>                    \n              <Collapse in={openMenu} timeout=\"auto\" unmountOnExit>\n                <List dense={true} component=\"div\">\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.showFileOpen()}>\n                    <ListItemIcon><Icon path={mdiFolder} size={'1.0rem'} color={iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-20px'}}>File</Typography>\n                      } />\n                  </ListItem>\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.showOpenUrl()}>\n                    <ListItemIcon><Icon path={mdiWeb} size={'1.0rem'} color={iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-20px'}}>URL</Typography>\n                      } />\n                  </ListItem>\n                  { isInputDirSupported() && !isMobile?\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.showOpenFolder()}>\n                    <ListItemIcon><Icon path={mdiFolderOpen} size={'1.0rem'} color={iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-20px'}}>Folder</Typography>\n                      } />\n                  </ListItem>    \n                  : null }                     \n                  { isInputDirSupported() && !isMobile?\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.showOpenDicomdir()}>\n                    <ListItemIcon><Icon path={mdiFolderOpen} size={'1.0rem'} color={iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-20px'}}>DICOMDIR</Typography>\n                      } />\n                  </ListItem>    \n                  : null }                                          \n                </List>\n              </Collapse>  \n\n              <ListItem button onClick={() => this.clear()}>\n                <ListItemIcon><Icon path={mdiDelete} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Clear All' />\n              </ListItem>  \n              <ListItem button onClick={this.handleLayout}>\n                <ListItemIcon><Icon path={mdiViewGridPlusOutline} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Layout' />              \n              </ListItem>   \n              <ListItem button onClick={() => this.showSettings()}>\n                <ListItemIcon><Icon path={mdiCog} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Settings' />\n              </ListItem>                \n              <Divider />\n              <ListItem button onClick={() => this.toggleToolbox()} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiChartHistogram} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Histogram' />\n              </ListItem>  \n              <ListItem button onClick={() => this.toggleMpr()} disabled={!isOpen || this.mprPlane === ''}>\n                <ListItemIcon><Icon path={mdiAxisArrow} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='MPR' />\n                {mprMenu ? <ExpandLess /> : <ExpandMore />}\n              </ListItem>              \n              <Collapse in={mprMenu} timeout=\"auto\" unmountOnExit>\n                <List dense={true} component=\"div\">\n                  <ListItem button style={{paddingLeft: 40}} onClick={() => this.mprOrthogonal()}>\n                    {visibleMprOrthogonal ? <ListItemIcon style={{marginLeft: '-10px'}}><Icon path={mdiCheck} size={'1.0rem'} color={iconColor} /></ListItemIcon> : null}\n                    <ListItemText \n                      style={visibleMprOrthogonal ? {marginLeft: '-7px'} : {marginLeft: '40px'}} \n                      classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Orthogonal</Typography>\n                      } />\n                  </ListItem>\n                  <ListItem button style={{paddingLeft: 40}} onClick={() => this.mprCoronal()}>\n                    {visibleMprCoronal ? <ListItemIcon style={{marginLeft: '-10px'}}><Icon path={mdiCheck} size={'1.0rem'} color={iconColor} /></ListItemIcon> : null}\n                    <ListItemText \n                      style={visibleMprCoronal ? {marginLeft: '-7px'} : {marginLeft: '40px'}}\n                      classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Coronal</Typography>\n                      } />\n                  </ListItem>    \n                  <ListItem button style={{paddingLeft: 40}} onClick={() => this.mprSagittal()}>\n                    {visibleMprSagittal ? <ListItemIcon style={{marginLeft: '-10px'}}><Icon path={mdiCheck} size={'1.0rem'} color={iconColor} /></ListItemIcon> : null}  \n                    <ListItemText \n                      style={visibleMprSagittal ? {marginLeft: '-7px'} : {marginLeft: '40px'}} \n                      classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Sagittal</Typography>\n                      } />\n                  </ListItem>    \n                  <ListItem button style={{paddingLeft: 40}} onClick={() => this.mprAxial()}>\n                    {visibleMprAxial ? <ListItemIcon style={{marginLeft: '-10px'}}><Icon path={mdiCheck} size={'1.0rem'} color={iconColor} /></ListItemIcon> : null}  \n                    <ListItemText \n                      style={visibleMprAxial ? {marginLeft: '-7px'} : {marginLeft: '40px'}} \n                      classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Axial</Typography>\n                      } />\n                  </ListItem>                                               \n                </List>\n              </Collapse>  \n              <ListItem button onClick={() => this.toggleImageEdit()} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiImageEdit} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Edit' />\n                {openImageEdit ? <ExpandLess /> : <ExpandMore />}\n              </ListItem>          \n              <Collapse in={openImageEdit} timeout=\"auto\" unmountOnExit>\n                <List dense={true} component=\"div\">\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Invert')}>\n                    <ListItemIcon><Icon path={mdiInvertColors} size={iconSize} color={iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} primary=\"Invert\" />\n                  </ListItem>\n                </List>\n              </Collapse>   \n              <ListItem button onClick={() => this.toggleTools()} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiTools} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Tools' />\n                {openTools ? <ExpandLess /> : <ExpandMore />}\n              </ListItem>   \n              <Collapse in={openTools} timeout=\"auto\" unmountOnExit>\n                <List dense={true} component=\"div\">\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('notool')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiCursorDefault} size={iconSizeSmall} color={this.colorIcon('notool')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>No Tool</Typography>\n                      }\n                    />\n                  </ListItem>     \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('referencelines')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiArrowSplitHorizontal} size={iconSizeSmall} color={visibleReferenceLines ? activeColor : iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass}\n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Reference Lines</Typography>\n                      }\n                    />\n                  </ListItem>        \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('serieslink')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiVectorLink} size={iconSizeSmall} color={visibleSeriesLink ? activeColor : iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass}\n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Link Series</Typography>\n                      }\n                    />\n                  </ListItem>                               \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Wwwc')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiArrowAll} size={iconSize} color={this.colorIcon('Wwwc')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass}\n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>WW/WC</Typography>\n                      }\n                    />\n                  </ListItem>  \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Pan')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiCursorPointer} size={iconSize} color={this.colorIcon('Pan')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Pan</Typography>\n                      } \n                    />\n                  </ListItem>  \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Zoom')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiMagnify} size={iconSize} color={this.colorIcon('Zoom')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Zoom</Typography>\n                      } \n                    />\n                  </ListItem>      \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Magnify')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiCheckboxIntermediate} size={iconSize} color={this.colorIcon('Magnify')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Magnify</Typography>\n                      } \n                    />\n                  </ListItem>       \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Length')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiRuler} size={iconSize} color={this.colorIcon('Length')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Length</Typography>\n                      }  \n                    />\n                  </ListItem>        \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Probe')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiEyedropper} size={iconSize} color={this.colorIcon('Probe')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Probe</Typography>\n                      } \n                    />\n                  </ListItem> \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Angle')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiAngleAcute} size={iconSize} color={this.colorIcon('Angle')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Angle</Typography>\n                      }  \n                    />\n                  </ListItem>  \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('EllipticalRoi')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiEllipse} size={iconSize} color={this.colorIcon('EllipticalRoi')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Elliptical Roi</Typography>\n                      } \n                    />\n                  </ListItem>     \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('RectangleRoi')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiRectangle} size={iconSize} color={this.colorIcon('RectangleRoi')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Rectangle Roi</Typography>\n                      } \n                    />\n                  </ListItem> \n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('FreehandRoi')} disabled={!isOpen}>\n                    <ListItemIcon><Icon path={mdiGesture} size={iconSize} color={this.colorIcon('FreehandRoi')} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} \n                      primary={\n                        <Typography type=\"body1\" style={{fontSize: '0.80em', marginLeft: '-23px'}}>Freehand Roi</Typography>\n                      } \n                    />\n                  </ListItem> \n                </List>\n              </Collapse> \n\n            </List>\n            \n            { this.isMultipleFiles || mprMenu ?\n              <div>     \n                <Divider />     \n                <div align='center'>\n                  <IconButton onClick={this.listOpenFilesFirstFrame} size='small'>\n                    <Icon path={mdiSkipBackward} size={'1.0rem'} color={iconColor} />\n                  </IconButton>\n                  <IconButton onClick={this.listOpenFilesPreviousFrame} size='small'>\n                      <Icon path={mdiSkipPrevious} size={'1.0rem'} color={iconColor} />\n                  </IconButton>\n                  <IconButton onClick={this.listOpenFilesScrolling} size='small'>\n                    <Icon path={this.state.listOpenFilesScrolling ? mdiPause : mdiPlay} size={'1.0rem'} color={iconColor} />\n                  </IconButton>\n                  <IconButton onClick={this.listOpenFilesNextFrame} size='small'>\n                      <Icon path={mdiSkipNext} size={'1.0rem'} color={iconColor} />\n                  </IconButton>\n                  <IconButton onClick={this.listOpenFilesLastFrame} size='small'>\n                      <Icon path={mdiSkipForward} size={'1.0rem'} color={iconColor} />\n                  </IconButton>                \n                </div>  \n                <div style={{textAlign: 'center'}}>\n                  <Typography type=\"body1\" style={{fontSize: '0.80em'}}>{`${this.state.sliceIndex+1} / ${sliceMax}`}</Typography>\n                </div>  \n                <div style={{width: '130px', margin: 'auto'}}>\n                  <Slider\n                    style={{marginTop: '-4px'}}\n                    value={this.state.sliceIndex}\n                    onChange={this.handleSliceChange}\n                    color=\"secondary\"\n                    min={0}\n                    max={sliceMax-1}\n                    step={100/sliceMax}\n                  />\n                </div>\n              </div> : null\n            }\n\n          </PerfectScrollbar>   \n          </div>\n        </Drawer>       \n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleHeader}\n          onClose={this.toggleHeader}\n        >\n          { visibleHeader ? <DicomHeader dcmViewer={dcmViewer} classes={classes} color={iconColor} /> : null } \n        </Drawer>\n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleMeasure}\n          onClose={this.toggleMeasure}\n        >\n          <div style={{marginTop: '48px'}}>\n            <Toolbar variant=\"dense\">\n              <Typography variant=\"subtitle1\" className={classes.title}>\n                Measurements&nbsp;&nbsp;\n              </Typography>\n              <div className={classes.grow} />\n              <IconButton color=\"inherit\" onClick={this.saveMeasure} edge=\"end\">\n                <Icon path={mdiContentSaveOutline} size={iconSize} color={iconColor} />\n              </IconButton>\n              <IconButton color=\"inherit\" onClick={this.clearMeasure} edge=\"end\">\n                <Icon path={mdiTrashCanOutline} size={iconSize} color={iconColor} />\n              </IconButton>\n            </Toolbar>\n            <div>  \n              { isOpen ? <Measurements dcmViewer={dcmViewer} toolRemove={this.toolRemove} classes={classes} /> : null } \n            </div>\n          </div>\n        </Drawer>  \n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleToolbox}\n          onClose={this.toggleToolbox}\n        >\n          <div style={{marginTop: '48px'}}>\n            <div>  \n              { isOpen ? <Histogram key={dcmViewer.filename} /> : null } \n            </div>\n          </div>\n        </Drawer>          \n\n        <Drawer\n          variant=\"persistent\"\n          anchor={getSettingsDicomdirView()}\n          open={visibleDicomdir}\n          onClose={this.toggleDicomdir}\n        >\n          <div>\n            <div>  \n              {visibleDicomdir ? <Dicomdir onOpenFile={this.handleOpenFileDicomdir} onOpenFs={this.handleOpenSandboxFs} /> : null} \n            </div>\n          </div>\n        </Drawer>   \n\n        <Drawer\n          variant=\"persistent\"\n          anchor={getSettingsFsView()}\n          open={visibleFileManager}\n          onClose={this.toggleFileManager}\n        >\n          <div>\n            <div>\n              {visibleFileManager ? \n                <FsUI \n                  onOpen={this.handleOpenSandboxFs} \n                  onOpenImage={this.handleOpenImage} \n                  onOpenMultipleFilesCompleted={this.openMultipleFilesCompleted}\n                  onOpenDicomdir={this.handleOpenFsDicomdir} \n                  color={iconColor} \n                /> \n              : null}\n            </div>\n          </div>\n        </Drawer>       \n\n        {visibleSettings ? <Settings onClose={this.hideSettings}/> : null}\n\n        {visibleAbout ? <AboutDlg onClose={this.showAbout}/> : null}\n\n        {visibleDownloadZipDlg ? <DownloadZipDlg onClose={this.hideDownloadZipDlg} url={this.url} /> : null}\n\n        {visibleOpenMultipleFilesDlg ? <OpenMultipleFilesDlg onClose={this.hideOpenMultipleFilesDlg} files={this.files} origin={'local'} /> : null}\n\n        <Dialog\n            open={visibleClearMeasureDlg}\n            onClose={this.hideClearMeasureDlg}\n        >\n            <DialogTitle>{\"Are you sure to remove all the measurements?\"}</DialogTitle>\n            <DialogActions>\n                <Button onClick={this.hideClearMeasureDlg}>\n                    Cancel\n                </Button>\n                <Button onClick={this.confirmClearMeasureDlg} autoFocus>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Dialog\n            open={visibleZippedFileDlg}\n            onClose={this.hideZippedFileDlg}\n        >\n            <DialogTitle>{\"This is a zipped file, would you import into sandbox file system?\"}</DialogTitle>\n            <DialogActions>\n                <Button onClick={this.hideZippedFileDlg}>\n                    Cancel\n                </Button>\n                <Button onClick={this.confirmZippedFileDlg} autoFocus>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Dialog\n            open={this.state.visibleOpenUrl}\n        >\n            <DialogTitle>{\"Open URL\"}</DialogTitle>\n              <DialogContent>\n                <DialogContentText>\n                  Insert an URL to download a DICOM or image file:\n                </DialogContentText>\n                <TextField\n                    autoFocus\n                    margin=\"dense\"\n                    id=\"id-open-url\"\n                    inputRef={input => (this.openUrlField = input)}\n                    fullWidth\n                />\n              </DialogContent>\n            <DialogActions>\n                <Button onClick={() => this.hideOpenUrl(false)} >\n                    Cancel\n                </Button>\n                <Button onClick={() => this.hideOpenUrl(true)} autoFocus>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Dialog\n            open={this.state.visibleMessage}\n        >\n            <DialogTitle>{this.state.titleMessage}</DialogTitle>\n              <DialogContent>\n                <DialogContentText>\n                  {this.state.textMessage}\n                </DialogContentText>\n              </DialogContent>\n            <DialogActions>\n                <Button onClick={() => this.setState({visibleMessage: false})} >\n                    Cancel\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Popover\n          id={'id-layout'}\n          open={visibleLayout}\n          anchorEl={this.state.anchorElLayout}\n          onClose={this.closeLayout}\n          anchorOrigin={{\n            vertical: 'center',\n            horizontal: 'right',\n          }}\n          transformOrigin={{\n            vertical: 'center',\n            horizontal: 'left',\n          }}\n        >\n          <LayoutTool \n            row={this.props.layout[0]-1} \n            col={this.props.layout[1]-1}\n            onChange={this.changeLayout}\n          />  \n        </Popover>     \n        \n        <Popover\n          id={'id-tools'}\n          open={visibleToolsPanel}\n          anchorEl={this.state.anchorElToolsPanel}\n          onClose={this.closeToolsPanel}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'right',\n          }}\n          transformOrigin={{\n            vertical: 'top',\n            horizontal: 'center',\n          }}\n        >\n          <ToolsPanel \n            toolActive={this.state.toolActive}\n            referenceLines={visibleReferenceLines}\n            seriesLink={visibleSeriesLink}\n            toolExecute={this.toolExecute}\n            onChange={this.changeLayout}\n          />  \n        </Popover>               \n\n        <Snackbar\n          anchorOrigin={{\n            vertical: 'top',\n            horizontal: 'center',\n          }}\n          open={visibleVolumeBuilding}\n          autoHideDuration={6000}\n          message=\"Volume building, wait please ...\"\n        />\n\n        <div style={{height: 'calc(100vh - 48px)'}}>\n          {this.buildLayoutGrid()}  \n        </div>\n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleExplorer}\n          onClose={this.toggleExplorer}\n        >\n          <div>\n            <div>\n              {visibleExplorer ? \n                <Explorer \n                  explorer={this.explorer}\n                  onSelectSeries={this.explorerOnSelectSeries}\n                  color={iconColor} \n                /> \n              : null}\n            </div>\n          </div>\n        </Drawer>   \n\n        <div>\n          <input\n            type=\"file\"\n            id=\"file_open\"\n            style={{ display: \"none\" }}\n            ref={this.fileOpen}\n            onChange={e => this.handleOpenLocalFs(e.target.files)}\n            multiple\n          />\n        </div>\n\n        <div>\n          <input\n            type=\"file\"\n            id=\"file_dicomdir\"\n            style={{ display: \"none\" }}\n            ref={this.openDicomdir}\n            onChange={e => this.handleOpenDicomdir(e.target.files)}\n            webkitdirectory=\"\" mozdirectory=\"\" directory=\"\" multiple\n          />\n        </div>\n\n        <div>\n          <input\n            type=\"file\"\n            id=\"file_folder\"\n            style={{ display: \"none\" }}\n            ref={this.openFolder}\n            onChange={e => this.handleOpenFolder(e.target.files)}\n            webkitdirectory=\"\" mozdirectory=\"\" directory=\"\" multiple\n          />\n        </div>    \n\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    localFileStore: state.localFileStore,\n    //allFiles: state.allFiles,\n    files: state.files,\n    series: state.series,\n    isOpen: state.isOpen,\n    tool: state.tool,\n    activeDcmIndex: state.activeDcmIndex,\n    explorerActivePatientIndex: state.explorerActivePatientIndex,\n    explorerActiveStudyIndex: state.explorerActiveStudyIndex,\n    explorerActiveSeriesIndex: state.explorerActiveSeriesIndex,\n    measurements: state.measurements,\n    layout: state.layout,\n    dicomdir: state.dicomdir,\n    fsZippedFile: state.fsZippedFile,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    clearingStore: () => dispatch(clearStore()),\n    setLocalFileStore: (file) => dispatch(localFileStore(file)),\n    toolStore: (tool) => dispatch(dcmTool(tool)),\n    isOpenStore: (value) => dispatch(dcmIsOpen(value)),\n    setActiveDcm: (dcm) => dispatch(activeDcm(dcm)),\n    setActiveDcmIndex: (index) => dispatch(activeDcmIndex(index)),\n    setActiveMeasurements: (measurements) => dispatch(activeMeasurements(measurements)),\n    setLayoutStore: (row, col) => dispatch(setLayout(row, col)),\n    setDicomdirStore: (dicomdir) => dispatch(setDicomdir(dicomdir)),\n    setFsZippedFile: (file) => dispatch(setZippedFile(file)),\n    setVolumeStore: (file) => dispatch(setVolume(file)),\n    setFilesStore: (files) => dispatch(filesStore(files)),\n    setExplorerActiveSeriesIndex: (index) => dispatch(explorerActiveSeriesIndex(index)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(App))\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import {createStore} from 'redux'\r\nimport storeReducer from '../reducers/index'\r\n\r\nlet initialState = {\r\n    localFile: null,\r\n    fsFile: null,\r\n    //allFiles: null,\r\n    files: null,\r\n    series: null,\r\n    isOpen: new Array(16).fill(false),\r\n    tool: null,\r\n    activeDcmIndex: 0,\r\n    activeDcm: null,\r\n    explorer: null,\r\n    explorerActivePatientIndex: 0,\r\n    explorerActiveStudyIndex: 0,\r\n    explorerActiveSeriesIndex: 0,\r\n    measurements: [],\r\n    layout: [1,1], // first element represents the rows, second the columns\r\n    dicomdir: null,\r\n    fsCurrentDir: '',\r\n    fsCurrentList: [],\r\n    fsZippedFile: null,\r\n    fsRefresh: false,\r\n    volume: null,\r\n    dcmEnableTool: false,\r\n}\r\n\r\nconst store = createStore(storeReducer, initialState,\r\n    window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__())\r\n\r\nexport default store\r\n","import {\r\n  CLEAR_STORE, \r\n  LOCALFILE_STORE,\r\n  FSFILE_STORE,\r\n  //ALLFILES_STORE,\r\n  FILES_STORE,\r\n  SERIES_STORE,\r\n  DCM_IS_OPEN, \r\n  DCM_TOOL, \r\n  ACTIVE_DCM_INDEX, \r\n  ACTIVE_DCM,\r\n  ACTIVE_MEASUREMENTS,\r\n  EXPLORER_STORE,\r\n  EXPLORER_ACTIVE_PATIENT_INDEX,\r\n  EXPLORER_ACTIVE_STUDY_INDEX,\r\n  EXPLORER_ACTIVE_SERIES_INDEX,\r\n  LAYOUT,\r\n  DICOMDIR,\r\n  FSCURRENTDIR,\r\n  FSCURRENTLIST,\r\n  FSZIPPEDFILE,\r\n  FSREFRESH,\r\n  VOLUME_STORE,\r\n  DCMENABLETOOL_STORE,\r\n} from '../actions'\r\n\r\nexport default function storeReducer(state={}, action) {\r\n    //console.log('storeReducer: ', action)\r\n    switch(action.type) {\r\n      \r\n      case CLEAR_STORE:\r\n        return {\r\n          localFile: state.localFile,\r\n          fsFile: state.fsFile,\r\n          //allfiles: null,\r\n          files: null, \r\n          series: null,\r\n          isOpen: state.isOpen.map((el, i) => i === state.activeDcmIndex ? false : el),\r\n          tool: null,\r\n          activeDcmIndex: state.activeDcmIndex,\r\n          activeDcm: state.activeDcm,\r\n          explorer: state.explorer,\r\n          explorerActivePatientIndex: state.explorerActivePatientIndex,\r\n          explorerActiveStudyIndex: state.explorerActiveStudyIndex,\r\n          explorerActiveSeriesIndex: state.explorerActiveSeriesIndex,\r\n          measurements: null,\r\n          layout: state.layout,\r\n          dicomdir: state.dicomdir, \r\n          fsCurrentDir: state.fsCurrentDir,\r\n          fsCurrentList: state.fsCurrentList,\r\n          fsZippedFile: null,\r\n          fsRefresh: state.fsRefresh,\r\n          volume: null,\r\n          //lut: null,\r\n          dcmEnableTool: false\r\n        }    \r\n\r\n      case LOCALFILE_STORE:\r\n          return {\r\n            ...state,\r\n            localFile: action.localFile,     \r\n            fsFile: null,   \r\n          } \r\n\r\n      case FSFILE_STORE:\r\n          return {\r\n            ...state,\r\n            localFile: null,     \r\n            fsFile: action.fsFile,   \r\n          }\r\n/*\r\n      case ALLFILES_STORE:\r\n          return {\r\n            ...state,\r\n            allFiles: action.allFiles,  \r\n          } \r\n*/\r\n      case FILES_STORE:\r\n          return {\r\n            ...state,\r\n            files: action.files,  \r\n          } \r\n\r\n      case SERIES_STORE:\r\n          return {\r\n            ...state,\r\n            series: action.series,  \r\n          }\r\n\r\n      case DCM_IS_OPEN:\r\n          return {\r\n            ...state,\r\n            isOpen: state.isOpen.map((el, i) => i === action.value.index ? action.value.value : el),    \r\n            measurements: state.measurements,\r\n            layout: state.layout,    \r\n            dicomdir: state.dicomdir,    \r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,            \r\n          }    \r\n\r\n      case DCM_TOOL:\r\n          return {\r\n            ...state,\r\n            tool: action.tool,\r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          }  \r\n\r\n      case ACTIVE_DCM_INDEX:\r\n          return {\r\n            ...state,\r\n            activeDcmIndex: action.activeDcmIndex,\r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          }  \r\n\r\n      case ACTIVE_DCM:\r\n          return {\r\n            ...state,\r\n            activeDcm: action.activeDcm,\r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          }            \r\n\r\n      case ACTIVE_MEASUREMENTS:\r\n        return {\r\n          ...state,\r\n          measurements: [...action.measurements],\r\n        }  \r\n\r\n      case EXPLORER_STORE:\r\n        return {\r\n          ...state,\r\n          explorer: action.explorer,\r\n        }  \r\n\r\n      case EXPLORER_ACTIVE_PATIENT_INDEX:\r\n        return {\r\n          ...state,\r\n          explorerActivePatientIndex: action.explorerActivePatientIndex,\r\n        }\r\n\r\n      case EXPLORER_ACTIVE_STUDY_INDEX:\r\n        return {\r\n          ...state,\r\n          explorerActiveStudyIndex: action.explorerActiveStudyIndex,\r\n        }\r\n\r\n      case EXPLORER_ACTIVE_SERIES_INDEX:\r\n        return {\r\n          ...state,\r\n          explorerActiveSeriesIndex: action.explorerActiveSeriesIndex,\r\n        }    \r\n\r\n      case LAYOUT:\r\n            return {\r\n              ...state,\r\n              measurements: state.measurements,\r\n              layout: action.layout,\r\n              dicomdir: state.dicomdir,\r\n              fsCurrentDir: state.fsCurrentDir,\r\n              fsCurrentList: state.fsCurrentList,  \r\n            }  \r\n\r\n      case DICOMDIR:\r\n            return {\r\n              ...state,\r\n              dicomdir: action.dicomdir\r\n            }  \r\n\r\n      case FSCURRENTDIR:\r\n            return {\r\n              ...state,\r\n              fsCurrentDir: action.fsCurrentDir\r\n            }  \r\n\r\n      case FSCURRENTLIST:\r\n            return {\r\n              ...state,\r\n              fsCurrentList: [...action.fsCurrentList]\r\n            }  \r\n\r\n      case FSZIPPEDFILE:\r\n            return {\r\n              ...state,\r\n              fsZippedFile: action.fsZippedFile\r\n            }  \r\n\r\n      case FSREFRESH:\r\n            return {\r\n              ...state,\r\n              fsRefresh: !state.fsRefresh\r\n            }  \r\n\r\n      case VOLUME_STORE:\r\n        return {\r\n          ...state,\r\n          volume: action.volume,        \r\n        }      \r\n\r\n      case DCMENABLETOOL_STORE:\r\n        return {\r\n          ...state,\r\n          dcmEnableTool: action.dcmEnableTool,        \r\n        }   \r\n\r\n      default:\r\n          return state\r\n    }\r\n  }\r\n  ","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\nimport WebFontLoader from 'webfontloader'\nimport {Provider} from 'react-redux'\nimport store from './store'\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles'\n\nWebFontLoader.load({\n    google: {\n        families: ['Roboto:300,400,500,700', 'Material Icons'],\n    },\n})\n\n//store.subscribe(() => console.log('store updated:', store.getState()));\n\nconst theme = createMuiTheme({\n    overrides: {\n        MuiFormControlLabel: {\n            label: {\n                fontSize: '0.85em'\n            },\n        },\n        MuiFormLabel: {\n            root: { \n                '&$focused': {\n                    color:'#CCCCCC',\n                },   \n            }\n         \n        }\n    },\n    palette: {\n        primary: {\n            main: '#004d40',\n        },\n        secondary: {\n            main: '#888888',\n        },\n        type: 'dark',\n    },\n  })\n\n  \nReactDOM.render(\n    <Provider store={store}>\n        <MuiThemeProvider theme = { theme }>\n            <App />\n        </MuiThemeProvider>\n    </Provider>, \n    document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n "],"sourceRoot":""}