{"version":3,"sources":["fs/fs.js","functions.js","constants/settings.js","actions/index.js","components/Dicomdir.js","constants/uids.js","components/OpenUrlDlg.js","components/CinePlayer.js","db/db.js","components/dicomviewer.js","components/DicomHeader.js","components/MeasureItem.js","components/Measurements.js","components/Settings.js","components/AboutDlg.js","components/Histogram.js","components/LayoutTool.js","components/FsUI.js","components/DownloadZipDlg.js","App.js","serviceWorker.js","store/index.js","reducers/index.js","index.js"],"names":["fs","Dexie","version","stores","files","open","isUrlImage","url","undefined","match","isFileImage","file","includes","isFsFileImage","fsItem","console","log","type","toLowerCase","getFileNameCorrect","filename","isAndroid","isFirefox","getFileExt","getFileName","ext","exec","getFileExtReal","name","replace","getSettingsSaveInto","saveInto","localStorage","getItem","setItem","getSettingsOverlay","overlay","getSettingsFsView","view","isMobile","isTablet","getSettingsDicomdirView","toCsvValue","theValue","t","String","dcmIsOpen","value","dcmTool","tool","activeDcm","dcm","activeMeasurements","measurements","setZippedFile","fsZippedFile","sandboxedfileStore","sandboxedFile","ExpandIcon","expanded","Dicomdir","props","state","data","buildData","id","output","images","series","study","patient","slice","reverse","forEach","obj","i","key","unshift","path","number","children","setState","buildOutput","dataset","elements","x00041220","items","e","index","toString","dataSet","string","push","split","pop","openDicomdir","reader","FileReader","onload","arrayBuffer","result","byteArray","Uint8Array","dicomParser","err","readAsArrayBuffer","openDicomdirFs","onClick","find","x","dicomdir","origin","onOpenFile","components","fsCurrentDir","parent","join","where","first","item","setSandboxedfileStore","onOpenFs","this","classes","styleComponent","marginTop","height","width","style","List","map","ListItem","button","ListItemText","primary","secondary","listItemText","Collapse","in","dense","className","PureComponent","connect","dispatch","withStyles","theme","paddingLeft","spacing","fontSize","uids","OpenUrlDlg","hide","onClose","cancel","window","stop","Dialog","aria-labelledby","DialogTitle","DialogContent","LinearProgress","variant","progress","color","DialogActions","Button","CinePlayer","firstframe","runCinePlayer","previousframe","play","pause","nextframe","lastframe","inPlay","IconButton","mdiPause","size","mdiPlay","margin","mdiSkipBackward","mdiSkipPrevious","mdiSkipNext","mdiSkipForward","db","measurement","scrollToIndex","csTools","cornerstoneTools","cornerstone","cornerstoneMath","cornerstoneFileImageLoader","cornerstoneWebImageLoader","cornerstoneWADOImageLoader","Hammer","DicomViewer","visibleOpenUrlDlg","visibleCinePlayer","errorOnOpenImage","errorOnCors","frame","viewport","onOpenUrl","eventData","detail","percentComplete","showOpenUrlDlg","addEventListener","loadImage","hideOpenUrlDlg","measurementSave","measure","measurementClear","splice","length","measurementRemove","getTransferSyntax","image","getSopClass","getSopInstanceUID","getPixelRepresentation","uint16","getPlanarConfiguration","onImageLoaded","onImageRendered","target","isDicom","document","getElementById","textContent","PatientsName","displayedArea","brhc","y","Math","round","voi","windowWidth","windowCenter","scale","toFixed","numberOfFrames","onMeasurementModified","onMeasurementAdded","note","measurementData","setActiveMeasurements","onMeasurementCompleted","onErrorOpenImageClose","onErrorCorsClose","localfile","localurl","element","dicomImage","onNewImage","imageId","then","enableTool","setActiveDcm","isOpenStore","addBuffer","add","fileManager","sopInstanceUid","stack","currentImageIdIndex","imageIds","intString","equals","each","runTool","error","pos","indexOf","substring","toolName","mouseButtonNumber","WwwcTool","LengthTool","PanTool","ZoomTouchPinchTool","ZoomTool","ProbeTool","EllipticalRoiTool","RectangleRoiTool","FreehandRoiTool","AngleTool","MagnifyTool","StackScrollMouseWheelTool","disableAllTools","opt","clearingStore","mouseButtonMask","isTouchActive","invert","canvas","getElementsByClassName","blobUtil","blob","newName","counter","done","fsCurrentList","transaction","a","async","byteLength","makeFsRefresh","reset","delete","sopinstanceuid","changeTool","cmdName","defaultViewport","dicomImageRef","el","onImageClick","dcmRef","previousProps","isOpen","layout","styleContainer","border","activeDcmIndex","position","aria-describedby","DialogContentText","autoFocus","Typography","gutterBottom","Link","href","textShadow","onContextMenu","ref","top","left","display","right","bottom","textAlign","backgroundColor","React","Component","toolStore","DicomHeader","dcmViewer","header","minPixelValue","maxPixelValue","listItems","Toolbar","title","grow","exportAs","fileData","objArray","cDelimiter","l","row","n","nl","names","sDelimiter","hasOwnProperty","toCsv","reduce","o","JSON","stringify","createElement","Blob","URL","createObjectURL","download","body","appendChild","click","mdiContentSaveOutline","component","MeasureItem","visibleDlgNote","visibleDlgDelete","showDlgNote","hideDlgNote","showDlgDelete","hideDlgDelete","handleOnChangeNote","event","confirmNote","noteField","confirmDelete","toolRemove","onEdit","onDelete","createRef","pText","sText","unit","rAngle","cachedStats","area","mean","stdDev","meanStdDev","edge","TextField","fullWidth","defaultValue","inputRef","input","Measurements","visibleClearMeasureDlg","showClearMeasureDlg","hideClearMeasureDlg","confirmClearMeasureDlg","dicomViewersRefs","useStyles","makeStyles","appBar","formControl","formLabel","radioControl","marginLeft","flex","Settings","saveAs","getSettingsSaveAs","getSettingsDcmHeader","fsView","dicomdirView","useState","fullScreen","AppBar","elevation","aria-label","FormControl","FormControlLabel","control","Checkbox","checked","onChange","label","FormLabel","RadioGroup","Radio","AboutDlg","linkRepository","packageJson","disableTypography","getRGBPixels","padding","styleSlider","styleCanvasGradient","styleTable","borderCollapse","fontFamily","styleTableTd","tableLayout","Histogram","activeDrags","deltaPosition","controlledPosition","histCount","valueScale","minHist","maxHist","handleChangeValue","newValue","binSize","hist256","onDrag","ui","deltaX","deltaY","onStart","onStop","canvasHistogram","canvasGradient","pixelData","getPixelData","updateCanvas","evt","rect","getBoundingClientRect","clientX","clientY","storedPixelData","spIndex","column","rows","red","green","blue","alpha","getRGBPixelsImage","intercept","lenHist","zero256","floor","abs","stepWW","stepWC","m","hist","Array","fill","columns","mo","getPixel","slope","s","pow","sqrt","step","max","j","canvasH","current","ctxH","getContext","translate","mousePos","getMousePos","p","beginPath","fillStyle","fillRect","strokeStyle","h","moveTo","lineTo","stroke","lineWidth","lowX","highX","ctxG","grd","createLinearGradient","addColorStop","cursor","Slider","min","parseFloat","LayoutTool","initTable","col","tableRef","cells","bgColor","cellClick","parentNode","rowIndex","cellIndex","renderTable","FsUI","textFieldLabel","textFieldValue","selected","selectedCopy","visibleTextField","visibleDeleteDlg","visibleImportExport","visibleAlreadyExistDlg","visibleOSaveAsDlg","createDir","renameItem","lastSelected","previousDir","nextDir","setCurrentDir","fsListDir","confirmText","oldParent","fsBuildParent","newParent","fsCreateDir","cancelDir","saveItem","localfileStore","buffer","copyItem","newSelectedCopy","cutItem","cut","pasteItem","startsWithIgnoreCase","deleteItem","showImportExport","exportItem","itemClick","selectedIndex","newSelected","concat","itemDoubleClick","onOpenDicomdir","onOpen","showDeleteDlg","hideDeleteDlg","confirmDeleteDlg","hideAlreadyExistDlg","hideSaveAs","closeSaveAs","saveAsField","zip","JSZip","folder","generateAsync","mouseDown","timer","setTimeout","mouseUp","clearTimeout","loadAsync","contents","relativePath","zipEntry","dir","content","fsAddItem","setFsZippedFile","put","create","sortBy","list","and","setCurrentList","Paper","textPaper","InputBase","textInput","placeholder","textButton","mdiCheck","mdiClose","leftButtons","mdiChevronLeft","toolbarButtons","Tooltip","mdiFolderPlusOutline","mdiSquareEditOutline","mdiContentCut","mdiContentCopy","mdiContentPaste","mdiDeleteOutline","mdiDotsHorizontal","mdiExportVariant","TableContainer","Table","table","TableHead","TableRow","TableCell","align","TableBody","isItemSelected","role","hover","onDoubleClick","onTouchStart","onTouchEnd","onMouseDown","onMouseUp","scope","bytes","decimals","k","dm","sizes","formatBytes","fsRefresh","setFsCurrentDir","setFsCurrentList","minWidth","marginRight","alignItems","source","axios","CancelToken","DownloadZipDlg","loading","requestDownloadZip","method","responseType","cancelToken","token","onDownloadProgress","progressEvent","percentCompleted","loaded","total","response","catch","iconTool","App","anchorElLayout","openImageEdit","visibleMainMenu","visibleHeader","visibleSettings","visibleToolbar","visibleOpenUrl","visibleToolbox","visibleMeasure","visibleAbout","visibleDicomdir","visibleFileManager","visibleZippedFileDlg","visibleDownloadZipDlg","toolState","setDcmViewer","getDcmViewerRef","getDcmViewer","dicomViewers","getActiveDcmViewer","toggleFileManager","handleOpenFile","filesSelected","setLocalfileStore","handleOpenFs","hideMainMenu","handleOpenFileDicomdir","handleOpenFsDicomdir","setDicomdirStore","toggleDicomdir","showAppBar","scrollTo","toggleMainMenu","showMainMenu","handleVisibility","toggleHeader","visible","toggleToolbox","saveMeasure","toggleMeasure","hideMeasure","handleVisibilityMeasure","clearMeasure","showZippedFileDlg","hideZippedFileDlg","confirmZippedFileDlg","showAbout","showSettings","hideSettings","handleVisibilitySettings","hideDownloadZipDlg","showOpenUrl","hideOpenUrl","openDlg","openUrlField","downloadOpenUrl","resetImage","saveShot","cinePlayer","clear","handleLayout","currentTarget","closeLayout","changeLayout","layoutGridClick","setLayoutStore","toolExecute","mdiArrowAll","mdiCursorPointer","mdiMagnify","mdiRuler","mdiEyedropper","mdiAngleAcute","mdiEllipse","mdiRectangle","mdiGesture","toolChange","toggleImageEdit","setActiveDcmIndex","layoutGridTouch","buildLayoutGrid","dicomviewers","styleLayoutGrid","gridTemplateRows","gridTemplateColumns","lastIndexOf","appBarTitle","webkitRelativePath","fileOpen","showFileOpen","bind","showOpenDicomdir","datafiles","primaryClass","isDicomdir","visibleLayout","Boolean","iconToolColor","menuButton","mdiInformationOutline","mdiVideo","mdiRefresh","mdiCamera","mdiToolbox","mdiFileCad","mdiFileDocument","mdiFolderOpen","mdiFileCabinet","Drawer","zIndex","toolbar","ListItemIcon","mdiFolder","mdiWeb","tmpInput","isInputDirSupported","mdiDelete","mdiViewGridPlusOutline","mdiSettings","Divider","disabled","mdiCursorDefault","mdiCheckboxIntermediate","mdiChartHistogram","mdiImageEdit","timeout","unmountOnExit","mdiInvertColors","anchor","mdiTrashCanOutline","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","handleOpenDicomdir","webkitdirectory","mozdirectory","directory","multiple","setLayout","setDicomdir","palette","common","black","flexGrow","root","drawer","transition","transitions","easing","sharp","duration","leavingScreen","appBarShift","enteringScreen","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","mixins","isLocalhost","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","initialState","store","createStore","action","__REDUX_DEVTOOLS_EXTENSION__","WebFontLoader","load","google","families","createMuiTheme","overrides","MuiFormControlLabel","MuiFormLabel","main","ReactDOM","render","process","fetch","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.7fa2ac16.chunk.js","sourcesContent":["import Dexie from 'dexie'\r\n\r\nconst fs = new Dexie('fsDB')\r\n\r\nfs.version(1).stores({ \r\n    files: '[parent+name], parent, name, type' \r\n})\r\n\r\nfs.open()\r\n\r\nexport default fs\r\n","import { \r\n    isAndroid,\r\n    isFirefox,\r\n    isMobile, \r\n    isTablet \r\n  } from 'react-device-detect'\r\nimport { \r\n    SETTINGS_SAVEAS, \r\n    SETTINGS_SAVEINTO,\r\n    SETTINGS_DCMHEADER, \r\n    SETTINGS_OVERLAY, \r\n    SETTINGS_MEASUREMENT,\r\n    SETTINGS_FSVIEW,\r\n    SETTINGS_DICOMDIRVIEW,    \r\n} from './constants/settings'\r\n\r\n// To see the console output set the key 'debug-u-dicom-viewer' in \r\n// 'Storage->Local Storage' panel of your browser Develop Tool\r\nexport function log() {\r\n    let log = localStorage.getItem('debug-u-dicom-viewer')\r\n    if (log === null) {\r\n        console.log = function(){}\r\n    }\r\n}\r\n\r\nexport function isInputDirSupported() {\r\n    var tmpInput = document.createElement('input')\r\n    if ('webkitdirectory' in tmpInput \r\n        || 'mozdirectory' in tmpInput \r\n        || 'odirectory' in tmpInput \r\n        || 'msdirectory' in tmpInput \r\n        || 'directory' in tmpInput) return true\r\n    return false\r\n}\r\n\r\nexport function isUrlImage(url) {\r\n    if (url === undefined || url === null) return false\r\n    return(url.match(/\\.(jpeg|jpg|png)$/) != null)\r\n}\r\n\r\nexport function isFileImage(file) {\r\n    if (file === undefined || file === null) return false \r\n    const acceptedImageTypes = ['image/jpeg', 'image/png'] // 'image/gif', \r\n    return file && acceptedImageTypes.includes(file['type'])\r\n}\r\n\r\nexport function isFsFileImage(fsItem) {\r\n    console.log('isFsFileImage: ', fsItem)\r\n    if (fsItem === undefined || fsItem === null) return false\r\n    return fsItem.type.toLowerCase() === 'jpeg' || fsItem.type.toLowerCase() === 'png'\r\n}\r\n\r\nexport function getFileNameCorrect(filename) {\r\n    if (isAndroid && isFirefox) { // possible uncorrect .null extension is found in Android Firefox, it's a bug? CHECK IT\r\n        const ext = getFileExt(filename)\r\n        if (ext === 'null') {\r\n            return getFileName(filename)\r\n        }\r\n    }\r\n    return filename \r\n}\r\n\r\nexport function getFileExt(file) {\r\n    const re = /(?:\\.([^.]+))?$/\r\n    const ext = re.exec(file)[1]\r\n    if (ext === undefined) {\r\n        return 'dcm'\r\n    }\r\n    return ext\r\n}\r\n\r\nexport function getFileExtReal(file) {\r\n    const re = /(?:\\.([^.]+))?$/\r\n    const ext = re.exec(file)[1]\r\n    if (ext === undefined) {\r\n        return ''\r\n    }\r\n    return ext\r\n}\r\n\r\nexport function getFileName(file) {\r\n    const name = file.replace(/\\.[^.$]+$/, '')\r\n    if (name === undefined) {\r\n        return ''\r\n    }\r\n    return name    \r\n}\r\n\r\nexport function formatBytes(bytes, decimals = 2) {\r\n    if (bytes === '') return ''\r\n    if (bytes === 0) return '0 Bytes'\r\n    const k = 1024\r\n    const dm = decimals < 0 ? 0 : decimals\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i]\r\n}\r\n\r\nexport function getSettingsSaveAs() {\r\n    let saveAs = localStorage.getItem(SETTINGS_SAVEAS)\r\n    if (saveAs === null) {\r\n      saveAs = \"png\"\r\n      localStorage.setItem(SETTINGS_SAVEAS, saveAs)\r\n    }\r\n    return saveAs\r\n}\r\n\r\nexport function setSettingsSaveAs(value) {\r\n    localStorage.setItem(SETTINGS_SAVEAS, value)  \r\n}\r\n\r\nexport function getSettingsSaveInto() {\r\n    let saveInto = localStorage.getItem(SETTINGS_SAVEINTO)\r\n    if (saveInto === null) {\r\n        saveInto = \"local\"\r\n      localStorage.setItem(SETTINGS_SAVEINTO, saveInto)\r\n    }\r\n    return saveInto\r\n}\r\n\r\nexport function setSettingsSaveInto(value) {\r\n    localStorage.setItem(SETTINGS_SAVEINTO, value)  \r\n}\r\n\r\nexport function getSettingsDcmHeader() {\r\n    let exportAs = localStorage.getItem(SETTINGS_DCMHEADER)\r\n    if (exportAs === null) {\r\n      exportAs = \"json\"\r\n      localStorage.setItem(SETTINGS_DCMHEADER, exportAs)\r\n    }  \r\n    return exportAs\r\n}\r\n\r\nexport function setSettingsDcmHeader(value) {\r\n    localStorage.setItem(SETTINGS_DCMHEADER, value)  \r\n}\r\n\r\nexport function getSettingsOverlay() {\r\n    let overlay = localStorage.getItem(SETTINGS_OVERLAY)\r\n    if (overlay === null) {\r\n      overlay = \"1\"\r\n      localStorage.setItem(SETTINGS_OVERLAY, overlay)\r\n    }\r\n    return overlay === '1'\r\n}\r\n\r\nexport function setSettingsOverlay(value) {\r\n    localStorage.setItem(SETTINGS_OVERLAY, value ? '1' : '0')  \r\n}\r\n\r\nexport function getSettingsMeasurement() {\r\n    let measurement = localStorage.getItem(SETTINGS_MEASUREMENT)\r\n    if (measurement === null) {\r\n        measurement = '1'\r\n        localStorage.setItem(SETTINGS_MEASUREMENT, measurement)\r\n    }\r\n    return measurement\r\n}\r\n\r\nexport function setSettingsMeasurement(value) {\r\n    localStorage.setItem(SETTINGS_MEASUREMENT, value)  \r\n}\r\n\r\nexport function getSettingsFsView() {\r\n    let view = localStorage.getItem(SETTINGS_FSVIEW)\r\n    if (view === null) {\r\n        view = isMobile && !isTablet ? 'bottom' : 'right'\r\n        localStorage.setItem(SETTINGS_FSVIEW, view)\r\n    }\r\n    return view\r\n}\r\n\r\nexport function setSettingsFsView(value) {\r\n    localStorage.setItem(SETTINGS_FSVIEW, value)  \r\n}\r\n\r\nexport function getSettingsDicomdirView() {\r\n    let view = localStorage.getItem(SETTINGS_DICOMDIRVIEW)\r\n    if (view === null) {\r\n        view = isMobile && !isTablet ? 'bottom' : 'right'\r\n        localStorage.setItem(SETTINGS_DICOMDIRVIEW, view)\r\n    }\r\n    return view\r\n}\r\n\r\nexport function setSettingsDicomdirView(value) {\r\n    localStorage.setItem(SETTINGS_DICOMDIRVIEW, value)  \r\n}\r\n\r\n/**\r\n * Converts a value to a string appropriate for entry into a CSV table.  E.g., a string value will be surrounded by quotes.\r\n * @param {string|number|object} theValue\r\n */\r\nfunction toCsvValue(theValue) {\r\n    let t = typeof theValue,\r\n        output\r\n\r\n    let sDelimiter = '\"'\r\n\r\n    if (t === 'undefined' || t === null) {\r\n        output = ''\r\n    } else if (t === 'string') {\r\n        output = sDelimiter + theValue.replace(/\"/g, '\"\"') + sDelimiter\r\n    } else {\r\n        output = sDelimiter + String(theValue).replace(/\"/g, '\"\"') + sDelimiter\r\n    }\r\n\r\n    return output\r\n}\r\n\r\n/**\r\n * Converts an array of objects (with identical schemas) into a CSV table.\r\n * @param {Array} objArray An array of objects.  Each object in the array must have the same property list.\r\n * @param {string} cDelimiter The column delimiter.  Defaults to a comma (,) if omitted.\r\n * @return {string} The CSV equivalent of objArray.\r\n */\r\nexport function toCsv(objArray, cDelimiter) {\r\n    var i,\r\n        l,\r\n        names = [],\r\n        name,\r\n        value,\r\n        obj,\r\n        row,\r\n        output = '',\r\n        n,\r\n        nl\r\n\r\n    // Initialize default parameters.\r\n\r\n    let sDelimiter = '\"'\r\n    if (typeof cDelimiter === 'undefined' || cDelimiter === null) {\r\n        cDelimiter = ','\r\n    }\r\n\r\n    for (i = 0, l = objArray.length; i < l; i += 1) {\r\n        // Get the names of the properties.\r\n        obj = objArray[i]\r\n        row = ''\r\n        if (i === 0) {\r\n            // Loop through the names\r\n            for (name in obj) {\r\n                if (obj.hasOwnProperty(name)) {\r\n                    names.push(name)\r\n                    row += [\r\n                        sDelimiter,\r\n                        name.replace(/\"/g, '\"\"'),\r\n                        sDelimiter,\r\n                        cDelimiter,\r\n                    ].join('')\r\n                }\r\n            }\r\n            row = row.substring(0, row.length - 1)\r\n            output += row\r\n        }\r\n\r\n        output += '\\n'\r\n        row = ''\r\n        for (n = 0, nl = names.length; n < nl; n += 1) {\r\n            name = names[n]\r\n            value = obj[name]\r\n            if (n > 0) {\r\n                row += cDelimiter\r\n            }\r\n            row += toCsvValue(value)\r\n        }\r\n        output += row\r\n    }\r\n\r\n    return output\r\n}\r\n\r\n","\r\nexport const SETTINGS_SAVEAS = 'saveAs'\r\nexport const SETTINGS_SAVEINTO = 'saveInto'\r\nexport const SETTINGS_DCMHEADER = 'exportAs'\r\nexport const SETTINGS_OVERLAY = 'overlay'\r\nexport const SETTINGS_MEASUREMENT = 'measurement'\r\nexport const SETTINGS_FSVIEW = 'fsView'\r\nexport const SETTINGS_DICOMDIRVIEW = 'dicomdirView'\r\n","export const CLEAR_STORE = 'CLEAR_STORE'\r\nexport const LOCALFILE_STORE = 'LOCALFILE_STORE'\r\nexport const DCM_IS_OPEN = 'DCM_IS_OPEN'\r\nexport const DCM_TOOL = 'DCM_TOOL'\r\nexport const ACTIVE_DCM_INDEX = 'ACTIVE_DCM_INDEX'\r\nexport const ACTIVE_DCM = 'ACTIVE_DCM'\r\nexport const DCM_IMAGE = 'DCM_IMAGE'\r\nexport const ACTIVE_MEASUREMENTS = 'ACTIVE_MEASUREMENTS'\r\nexport const LAYOUT = 'LAYOUT'\r\nexport const DICOMDIR = 'DICOMDIR'\r\nexport const FSCURRENTDIR = 'FSCURRENTDIR'\r\nexport const FSCURRENTLIST = 'FSCURRENTLIST'\r\nexport const FSZIPPEDFILE = 'FSZIPPEDFILE'\r\nexport const FSREFRESH = 'FSREFRESH'\r\nexport const SANDBOXEDFILE_STORE = 'SANDBOXEDFILE_STORE'\r\n\r\nexport const clearStore = () => {\r\n    return { \r\n        type: CLEAR_STORE, \r\n    }\r\n}\r\n\r\nexport const localfileStore = (file) => {\r\n    return { \r\n        type: LOCALFILE_STORE, \r\n        localfile: file\r\n    }\r\n}\r\n\r\nexport const dcmIsOpen = (value) => {\r\n    return { \r\n        type: DCM_IS_OPEN, \r\n        value: value\r\n    }\r\n}\r\n\r\nexport const dcmTool = (tool) => {\r\n    return { \r\n        type: DCM_TOOL, \r\n        tool: tool \r\n    }\r\n}\r\n\r\nexport const activeDcmIndex = (index) => {\r\n    return { \r\n        type: ACTIVE_DCM_INDEX, \r\n        activeDcmIndex: index \r\n    }\r\n}\r\n\r\nexport const activeDcm = (dcm) => {\r\n    return { \r\n        type: ACTIVE_DCM, \r\n        activeDcm: dcm \r\n    }\r\n}\r\n\r\nexport const dcmImage = (image) => {\r\n    return { \r\n        type: DCM_IMAGE, \r\n        images: image \r\n    }\r\n}\r\n\r\nexport const activeMeasurements = (measurements) => {\r\n    return { \r\n        type: ACTIVE_MEASUREMENTS, \r\n        measurements: measurements \r\n    }\r\n}\r\n\r\nexport const setLayout = (row, col) => {\r\n    return { \r\n        type: LAYOUT, \r\n        layout: [row, col]\r\n    }\r\n}\r\n\r\nexport const setDicomdir = (dicomdir) => {\r\n    return { \r\n        type: DICOMDIR, \r\n        dicomdir: dicomdir\r\n    }\r\n}\r\n\r\nexport const setFsCurrentDir = (dir) => {\r\n    return { \r\n        type: FSCURRENTDIR, \r\n        fsCurrentDir: dir\r\n    }\r\n}\r\n\r\nexport const setFsCurrentList = (list) => {\r\n    return { \r\n        type: FSCURRENTLIST, \r\n        fsCurrentList: list\r\n    }\r\n}\r\n\r\nexport const setZippedFile = (file) => {\r\n    return { \r\n        type: FSZIPPEDFILE, \r\n        fsZippedFile: file\r\n    }\r\n}\r\n\r\nexport const doFsRefresh = () => {\r\n    return { \r\n        type: FSREFRESH,\r\n    }\r\n}\r\n\r\nexport const sandboxedfileStore = (file) => {\r\n    return { \r\n        type: SANDBOXEDFILE_STORE, \r\n        sandboxedFile: file\r\n    }\r\n}\r\n","import React, { Fragment, PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport * as dicomParser from 'dicom-parser'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport fs from '../fs/fs'\r\nimport {\r\n  getSettingsDicomdirView,\r\n} from '../functions'\r\nimport {\r\n  sandboxedfileStore,\r\n} from '../actions'\r\n\r\nconst styles = theme => ({\r\n  study: { \r\n    paddingLeft: theme.spacing(3) \r\n  },\r\n  series: { \r\n    paddingLeft: theme.spacing(5) \r\n  },\r\n  images: { \r\n    paddingLeft: theme.spacing(7) \r\n  },  \r\n  listItemText:{\r\n    fontSize:'0.80em',\r\n  }\r\n})\r\n\r\nconst ExpandIcon = ({ expanded }) => expanded ? <ExpandLessIcon /> : <ExpandMoreIcon />\r\n\r\nclass Dicomdir extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.output = null\r\n    }\r\n\r\n    state = {\r\n      data: [],\r\n      expanded: [],\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.dicomdir.origin === 'local')\r\n          this.openDicomdir(this.props.dicomdir.dicomdir)   \r\n        else \r\n          this.openDicomdirFs(this.props.dicomdir.dicomdir)               \r\n    }\r\n\r\n    buildData = (id = null) => {\r\n      let output = this.output\r\n      if (id !== null) {\r\n        output[id].expanded = !output[id].expanded\r\n      }\r\n      let images = []\r\n      let series = []\r\n      let study = []\r\n      let patient = []\r\n      output.slice().reverse().forEach((obj, i) => {\r\n        if (obj.key === 'image') {\r\n          images.unshift({id: obj.id, key: obj.key, path: obj.path, value: obj.value})\r\n        } else if (obj.key === 'series') {\r\n          series.unshift({id: obj.id, key: obj.key, number: obj.number, value: obj.value, expanded: obj.expanded, children: images})\r\n          images = []\r\n        } else if (obj.key === 'study') {\r\n          study.unshift({id: obj.id, key: obj.key, value: obj.value, expanded: obj.expanded, children: series})\r\n          series = []\r\n        } else if (obj.key === 'patient') {\r\n          patient.unshift({id: obj.id, key: obj.key, value: obj.value, expanded: obj.expanded, children: study})\r\n          study = []\r\n        }\r\n      })\r\n      this.setState({data: patient})\r\n    }\r\n\r\n    buildOutput = (dataset) => {\r\n      //console.log('dataset: ', dataset)\r\n      let data = dataset.elements.x00041220.items\r\n      let output = []\r\n      if (data) {\r\n          data.forEach((e, index) => {\r\n            const id = index.toString()\r\n            if (e.dataSet.string('x00041430') === 'PATIENT') {\r\n                //console.log(\"Patient Name - \"+e.dataSet.string('x00100010'))\r\n                output.push({id: id, key: 'patient', value: e.dataSet.string('x00100010'), expanded: true})\r\n            } else if (e.dataSet.string('x00041430') === 'STUDY') {\r\n                //console.log(\"Study - \"+e.dataSet.string('x00081030'))\r\n                output.push({id: id, key: 'study', value: e.dataSet.string('x00081030'), expanded: true})\r\n            } else if (e.dataSet.string('x00041430') === 'SERIES') {\r\n                //console.log(\"Series number - \"+e.dataSet.string('x00200011'))\r\n                output.push({id: id, key: 'series', number: e.dataSet.string('x00200011'), value: e.dataSet.string('x00080060'), expanded: true})\r\n            } else if (e.dataSet.string('x00041430') === 'IMAGE') {\r\n                //console.log(\"Image - \"+e.dataSet.string('x00041500'))\r\n                output.push({id: id, key: 'image', path: e.dataSet.string('x00041500').replace(/\\\\/g, '/'), value: e.dataSet.string('x00041500').split('\\\\').pop(), expanded: true})\r\n            }              \r\n          })\r\n      }\r\n      //console.log('output: ', output)\r\n      return output\r\n    }\r\n\r\n    openDicomdir = (file) => {\r\n        var reader = new FileReader()\r\n        reader.onload = (file) => {\r\n          let arrayBuffer = reader.result\r\n          let byteArray = new Uint8Array(arrayBuffer)\r\n          // Invoke the paresDicom function and get back a DataSet object with the contents\r\n          let dataset = null\r\n          let output = []\r\n          try {\r\n              dataset = dicomParser.parseDicom(byteArray)\r\n              output = this.buildOutput(dataset)\r\n          } catch(err) {\r\n              if (typeof err.dataSet != 'undefined') {\r\n                  output = this.buildOutput(err.dataSet)\r\n              }\r\n          }\r\n          this.output = output\r\n          this.buildData()\r\n        }\r\n\r\n        reader.readAsArrayBuffer(file)\r\n    }\r\n\r\n    openDicomdirFs = (fsItem) => {\r\n      let byteArray = new Uint8Array(fsItem.data)\r\n      let dataset = null\r\n      let output = []\r\n      try {\r\n        dataset = dicomParser.parseDicom(byteArray)\r\n        output = this.buildOutput(dataset)\r\n      } catch(err) {\r\n        if (typeof err.dataSet != 'undefined') {\r\n          output = this.buildOutput(err.dataSet)\r\n        }\r\n      }\r\n      this.output = output\r\n      this.buildData()\r\n    }\r\n\r\n    onClick = (id) => {\r\n      const obj = this.output.find(x => x.id === id)\r\n      if (obj.key === 'image') {\r\n        if (this.props.dicomdir.origin === 'local') { // load it from local\r\n          const file = this.props.dicomdir.files.find(x => x.name === obj.value)\r\n          this.props.onOpenFile(file)\r\n        } else { // load it from sandboxed file system\r\n          let components = obj.path.split('/')\r\n          const name = components.pop()\r\n          components.unshift(this.props.fsCurrentDir)\r\n          const parent = components.join('/')\r\n          fs.files.where({parent: parent, name: name}).first((item) => {\r\n            this.props.setSandboxedfileStore(item)\r\n            this.props.onOpenFs(item)\r\n          })\r\n        }\r\n      } else {\r\n        this.buildData(id)\r\n      }\r\n    }\r\n\r\n    render() {   \r\n      const { classes } = this.props\r\n\r\n      let styleComponent = null\r\n      if (getSettingsDicomdirView() === 'bottom') {\r\n          styleComponent = {marginTop: '0px', height: '275px'}\r\n      } else {\r\n          styleComponent = {marginTop: '48px', width: '350px'}\r\n      }\r\n\r\n      return (\r\n        <div style={styleComponent}>\r\n          <List>\r\n            {this.state.data.map(({ ...patient }, index) => (\r\n              <Fragment key={index}>\r\n                <ListItem button onClick={() => this.onClick(patient.id)}>\r\n                  <ListItemText primary={patient.value} secondary={patient.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                  <ExpandIcon expanded={patient.expanded} />\r\n                </ListItem>\r\n                <Collapse in={patient.expanded}>\r\n                  {patient.children.map(study => (\r\n                    <Fragment key={study.id}>\r\n                      <ListItem key={study.id} button dense onClick={() => this.onClick(study.id)} className={classes.study}>\r\n                        <ListItemText primary={study.value} secondary={study.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                        <ExpandIcon expanded={study.expanded} />\r\n                      </ListItem>\r\n                      <Collapse in={study.expanded}>\r\n                        {study.children.map(series => (\r\n                          <Fragment key={series.id}>\r\n                            <ListItem key={series.id} button dense onClick={() => this.onClick(series.id)} className={classes.series}>\r\n                              <ListItemText primary={`${series.value} (${series.number})`} secondary={series.key} classes={{primary:classes.listItemText, secondary:classes.listItemText}} />\r\n                              <ExpandIcon expanded={study.expanded} />\r\n                            </ListItem>\r\n                            <Collapse in={series.expanded}>\r\n                              {series.children.map(images => (\r\n                                <ListItem key={images.id} button dense onClick={() => this.onClick(images.id)} className={classes.images}>\r\n                                  <ListItemText primary={images.value} classes={{primary:classes.listItemText}} />\r\n                                </ListItem>\r\n                              ))}\r\n                            </Collapse>\r\n                          </Fragment>\r\n                        ))}\r\n                      </Collapse>\r\n                    </Fragment>\r\n                  ))}\r\n                </Collapse>\r\n              </Fragment>\r\n            ))}\r\n          </List>\r\n        </div>\r\n      )\r\n    }\r\n}   \r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      dicomdir: state.dicomdir,\r\n      fsCurrentDir: state.fsCurrentDir,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setSandboxedfileStore: (file) => dispatch(sandboxedfileStore(file))\r\n  }\r\n}\r\n  \r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(Dicomdir))\r\n","// The table below was generated by running the following javascript in the console window while\n// viewing the HTML version of the standard here:\n// DICOM Standard here: http://dicom.nema.org/medical/dicom/current/output/html/part06.html\n// see the blog post about it here: http://chafey.blogspot.com/2015/08/parsing-dicom-standard-with-javascript.html\n\n/*\n (function () {\n var elements = document.querySelectorAll('#table_A-1 ~ div tbody tr');\n var result = \"\";for(var i=0; i < elements.length; i++) {\n result += \"'\" + elements[i].childNodes[1].childNodes[1].innerText.replace(/[^\\x20-\\x7E]+/g, '')  + \"':'\" +\n elements[i].childNodes[3].childNodes[1].innerText.replace(/[^\\x20-\\x7E]+/g, '') + \"',\\n\";\n }\n return result;\n })();\n */\n\nexport const uids = {\n  '1.2.840.10008.1.1':'Verification SOP Class',\n  '1.2.840.10008.1.2':'Implicit VR Little Endian: Default Transfer Syntax for DICOM',\n  '1.2.840.10008.1.2.1':'Explicit VR Little Endian',\n  '1.2.840.10008.1.2.1.99':'Deflated Explicit VR Little Endian',\n  '1.2.840.10008.1.2.2':'Explicit VR Big Endian (Retired)',\n  '1.2.840.10008.1.2.4.50':'JPEG Baseline (Process 1): Default Transfer Syntax for Lossy JPEG 8 Bit Image Compression',\n  '1.2.840.10008.1.2.4.51':'JPEG Extended (Process 2 & 4): Default Transfer Syntax for Lossy JPEG 12 Bit Image Compression (Process 4 only)',\n  '1.2.840.10008.1.2.4.52':'JPEG Extended (Process 3 & 5) (Retired)',\n  '1.2.840.10008.1.2.4.53':'JPEG Spectral Selection, Non-Hierarchical (Process 6 & 8) (Retired)',\n  '1.2.840.10008.1.2.4.54':'JPEG Spectral Selection, Non-Hierarchical (Process 7 & 9) (Retired)',\n  '1.2.840.10008.1.2.4.55':'JPEG Full Progression, Non-Hierarchical (Process 10 & 12) (Retired)',\n  '1.2.840.10008.1.2.4.56':'JPEG Full Progression, Non-Hierarchical (Process 11 & 13) (Retired)',\n  '1.2.840.10008.1.2.4.57':'JPEG Lossless, Non-Hierarchical (Process 14)',\n  '1.2.840.10008.1.2.4.58':'JPEG Lossless, Non-Hierarchical (Process 15) (Retired)',\n  '1.2.840.10008.1.2.4.59':'JPEG Extended, Hierarchical (Process 16 & 18) (Retired)',\n  '1.2.840.10008.1.2.4.60':'JPEG Extended, Hierarchical (Process 17 & 19) (Retired)',\n  '1.2.840.10008.1.2.4.61':'JPEG Spectral Selection, Hierarchical (Process 20 & 22) (Retired)',\n  '1.2.840.10008.1.2.4.62':'JPEG Spectral Selection, Hierarchical (Process 21 & 23) (Retired)',\n  '1.2.840.10008.1.2.4.63':'JPEG Full Progression, Hierarchical (Process 24 & 26) (Retired)',\n  '1.2.840.10008.1.2.4.64':'JPEG Full Progression, Hierarchical (Process 25 & 27) (Retired)',\n  '1.2.840.10008.1.2.4.65':'JPEG Lossless, Hierarchical (Process 28) (Retired)',\n  '1.2.840.10008.1.2.4.66':'JPEG Lossless, Hierarchical (Process 29) (Retired)',\n  '1.2.840.10008.1.2.4.70':'JPEG Lossless, Non-Hierarchical, First-Order Prediction (Process 14 [Selection Value 1]): Default Transfer Syntax for Lossless JPEG Image Compression',\n  '1.2.840.10008.1.2.4.80':'JPEG-LS Lossless Image Compression',\n  '1.2.840.10008.1.2.4.81':'JPEG-LS Lossy (Near-Lossless) Image Compression',\n  '1.2.840.10008.1.2.4.90':'JPEG 2000 Image Compression (Lossless Only)',\n  '1.2.840.10008.1.2.4.91':'JPEG 2000 Image Compression',\n  '1.2.840.10008.1.2.4.92':'JPEG 2000 Part 2 Multi-component Image Compression (Lossless Only)',\n  '1.2.840.10008.1.2.4.93':'JPEG 2000 Part 2 Multi-component Image Compression',\n  '1.2.840.10008.1.2.4.94':'JPIP Referenced',\n  '1.2.840.10008.1.2.4.95':'JPIP Referenced Deflate',\n  '1.2.840.10008.1.2.4.100':'MPEG2 Main Profile @ Main Level',\n  '1.2.840.10008.1.2.4.101':'MPEG2 Main Profile @ High Level',\n  '1.2.840.10008.1.2.4.102':'MPEG-4 AVC/H.264 High Profile / Level 4.1',\n  '1.2.840.10008.1.2.4.103':'MPEG-4 AVC/H.264 BD-compatible High Profile / Level 4.1',\n  '1.2.840.10008.1.2.4.104':'MPEG-4 AVC/H.264 High Profile / Level 4.2 For 2D Video',\n  '1.2.840.10008.1.2.4.105':'MPEG-4 AVC/H.264 High Profile / Level 4.2 For 3D Video',\n  '1.2.840.10008.1.2.4.106':'MPEG-4 AVC/H.264 Stereo High Profile / Level 4.2',\n  '1.2.840.10008.1.2.5':'RLE Lossless',\n  '1.2.840.10008.1.2.6.1':'RFC 2557 MIME encapsulation',\n  '1.2.840.10008.1.2.6.2':'XML Encoding',\n  '1.2.840.10008.1.3.10':'Media Storage Directory Storage',\n  '1.2.840.10008.1.4.1.1':'Talairach Brain Atlas Frame of Reference',\n  '1.2.840.10008.1.4.1.2':'SPM2 T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.3':'SPM2 T2 Frame of Reference',\n  '1.2.840.10008.1.4.1.4':'SPM2 PD Frame of Reference',\n  '1.2.840.10008.1.4.1.5':'SPM2 EPI Frame of Reference',\n  '1.2.840.10008.1.4.1.6':'SPM2 FIL T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.7':'SPM2 PET Frame of Reference',\n  '1.2.840.10008.1.4.1.8':'SPM2 TRANSM Frame of Reference',\n  '1.2.840.10008.1.4.1.9':'SPM2 SPECT Frame of Reference',\n  '1.2.840.10008.1.4.1.10':'SPM2 GRAY Frame of Reference',\n  '1.2.840.10008.1.4.1.11':'SPM2 WHITE Frame of Reference',\n  '1.2.840.10008.1.4.1.12':'SPM2 CSF Frame of Reference',\n  '1.2.840.10008.1.4.1.13':'SPM2 BRAINMASK Frame of Reference',\n  '1.2.840.10008.1.4.1.14':'SPM2 AVG305T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.15':'SPM2 AVG152T1 Frame of Reference',\n  '1.2.840.10008.1.4.1.16':'SPM2 AVG152T2 Frame of Reference',\n  '1.2.840.10008.1.4.1.17':'SPM2 AVG152PD Frame of Reference',\n  '1.2.840.10008.1.4.1.18':'SPM2 SINGLESUBJT1 Frame of Reference',\n  '1.2.840.10008.1.4.2.1':'ICBM 452 T1 Frame of Reference',\n  '1.2.840.10008.1.4.2.2':'ICBM Single Subject MRI Frame of Reference',\n  '1.2.840.10008.1.5.1':'Hot Iron Color Palette SOP Instance',\n  '1.2.840.10008.1.5.2':'PET Color Palette SOP Instance',\n  '1.2.840.10008.1.5.3':'Hot Metal Blue Color Palette SOP Instance',\n  '1.2.840.10008.1.5.4':'PET 20 Step Color Palette SOP Instance',\n  '1.2.840.10008.1.9':'Basic Study Content Notification SOP Class (Retired)',\n  '1.2.840.10008.1.20.1':'Storage Commitment Push Model SOP Class',\n  '1.2.840.10008.1.20.1.1':'Storage Commitment Push Model SOP Instance',\n  '1.2.840.10008.1.20.2':'Storage Commitment Pull Model SOP Class (Retired)',\n  '1.2.840.10008.1.20.2.1':'Storage Commitment Pull Model SOP Instance (Retired)',\n  '1.2.840.10008.1.40':'Procedural Event Logging SOP Class',\n  '1.2.840.10008.1.40.1':'Procedural Event Logging SOP Instance',\n  '1.2.840.10008.1.42':'Substance Administration Logging SOP Class',\n  '1.2.840.10008.1.42.1':'Substance Administration Logging SOP Instance',\n  '1.2.840.10008.2.6.1':'DICOM UID Registry',\n  '1.2.840.10008.2.16.4':'DICOM Controlled Terminology',\n  '1.2.840.10008.3.1.1.1':'DICOM Application Context Name',\n  '1.2.840.10008.3.1.2.1.1':'Detached Patient Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.1.4':'Detached Patient Management Meta SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.2.1':'Detached Visit Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.3.1':'Detached Study Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.3.2':'Study Component Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.3.3':'Modality Performed Procedure Step SOP Class',\n  '1.2.840.10008.3.1.2.3.4':'Modality Performed Procedure Step Retrieve SOP Class',\n  '1.2.840.10008.3.1.2.3.5':'Modality Performed Procedure Step Notification SOP Class',\n  '1.2.840.10008.3.1.2.5.1':'Detached Results Management SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.5.4':'Detached Results Management Meta SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.5.5':'Detached Study Management Meta SOP Class (Retired)',\n  '1.2.840.10008.3.1.2.6.1':'Detached Interpretation Management SOP Class (Retired)',\n  '1.2.840.10008.4.2':'Storage Service Class',\n  '1.2.840.10008.5.1.1.1':'Basic Film Session SOP Class',\n  '1.2.840.10008.5.1.1.2':'Basic Film Box SOP Class',\n  '1.2.840.10008.5.1.1.4':'Basic Grayscale Image Box SOP Class',\n  '1.2.840.10008.5.1.1.4.1':'Basic Color Image Box SOP Class',\n  '1.2.840.10008.5.1.1.4.2':'Referenced Image Box SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.9':'Basic Grayscale Print Management Meta SOP Class',\n  '1.2.840.10008.5.1.1.9.1':'Referenced Grayscale Print Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.14':'Print Job SOP Class',\n  '1.2.840.10008.5.1.1.15':'Basic Annotation Box SOP Class',\n  '1.2.840.10008.5.1.1.16':'Printer SOP Class',\n  '1.2.840.10008.5.1.1.16.376':'Printer Configuration Retrieval SOP Class',\n  '1.2.840.10008.5.1.1.17':'Printer SOP Instance',\n  '1.2.840.10008.5.1.1.17.376':'Printer Configuration Retrieval SOP Instance',\n  '1.2.840.10008.5.1.1.18':'Basic Color Print Management Meta SOP Class',\n  '1.2.840.10008.5.1.1.18.1':'Referenced Color Print Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.22':'VOI LUT Box SOP Class',\n  '1.2.840.10008.5.1.1.23':'Presentation LUT SOP Class',\n  '1.2.840.10008.5.1.1.24':'Image Overlay Box SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.24.1':'Basic Print Image Overlay Box SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.25':'Print Queue SOP Instance (Retired)',\n  '1.2.840.10008.5.1.1.26':'Print Queue Management SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.27':'Stored Print Storage SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.29':'Hardcopy Grayscale Image Storage SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.30':'Hardcopy Color Image Storage SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.31':'Pull Print Request SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.32':'Pull Stored Print Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.1.33':'Media Creation Management SOP Class UID',\n  '1.2.840.10008.5.1.1.40':'Display System SOP Class',\n  '1.2.840.10008.5.1.1.40.1':'Display System SOP Instance',\n  '1.2.840.10008.5.1.4.1.1.1':'Computed Radiography Image Storage',\n  '1.2.840.10008.5.1.4.1.1.1.1':'Digital X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.1.1.1':'Digital X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.1.2':'Digital Mammography X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.1.2.1':'Digital Mammography X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.1.3':'Digital Intra-Oral X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.1.3.1':'Digital Intra-Oral X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.2':'CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.2.1':'Enhanced CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.2.2':'Legacy Converted Enhanced CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.3':'Ultrasound Multi-frame Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.3.1':'Ultrasound Multi-frame Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4':'MR Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4.1':'Enhanced MR Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4.2':'MR Spectroscopy Storage',\n  '1.2.840.10008.5.1.4.1.1.4.3':'Enhanced MR Color Image Storage',\n  '1.2.840.10008.5.1.4.1.1.4.4':'Legacy Converted Enhanced MR Image Storage',\n  '1.2.840.10008.5.1.4.1.1.5':'Nuclear Medicine Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.6':'Ultrasound Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.6.1':'Ultrasound Image Storage',\n  '1.2.840.10008.5.1.4.1.1.6.2':'Enhanced US Volume Storage',\n  '1.2.840.10008.5.1.4.1.1.7':'Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.1':'Multi-frame Single Bit Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.2':'Multi-frame Grayscale Byte Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.3':'Multi-frame Grayscale Word Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.7.4':'Multi-frame True Color Secondary Capture Image Storage',\n  '1.2.840.10008.5.1.4.1.1.8':'Standalone Overlay Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.9':'Standalone Curve Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.9.1':'Waveform Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.9.1.1':'12-lead ECG Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.1.2':'General ECG Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.1.3':'Ambulatory ECG Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.2.1':'Hemodynamic Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.3.1':'Cardiac Electrophysiology Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.4.1':'Basic Voice Audio Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.4.2':'General Audio Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.5.1':'Arterial Pulse Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.9.6.1':'Respiratory Waveform Storage',\n  '1.2.840.10008.5.1.4.1.1.10':'Standalone Modality LUT Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.11':'Standalone VOI LUT Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.11.1':'Grayscale Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.2':'Color Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.3':'Pseudo-Color Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.4':'Blending Softcopy Presentation State Storage SOP Class',\n  '1.2.840.10008.5.1.4.1.1.11.5':'XA/XRF Grayscale Softcopy Presentation State Storage',\n  '1.2.840.10008.5.1.4.1.1.12.1':'X-Ray Angiographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.1.1':'Enhanced XA Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.2':'X-Ray Radiofluoroscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.2.1':'Enhanced XRF Image Storage',\n  '1.2.840.10008.5.1.4.1.1.12.3':'X-Ray Angiographic Bi-Plane Image Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.13.1.1':'X-Ray 3D Angiographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.13.1.2':'X-Ray 3D Craniofacial Image Storage',\n  '1.2.840.10008.5.1.4.1.1.13.1.3':'Breast Tomosynthesis Image Storage',\n  '1.2.840.10008.5.1.4.1.1.13.1.4':'Breast Projection X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.13.1.5':'Breast Projection X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.14.1':'Intravascular Optical Coherence Tomography Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.14.2':'Intravascular Optical Coherence Tomography Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.20':'Nuclear Medicine Image Storage',\n  '1.2.840.10008.5.1.4.1.1.30':'Parametric Map Storage',\n  '1.2.840.10008.5.1.4.1.1.66':'Raw Data Storage',\n  '1.2.840.10008.5.1.4.1.1.66.1':'Spatial Registration Storage',\n  '1.2.840.10008.5.1.4.1.1.66.2':'Spatial Fiducials Storage',\n  '1.2.840.10008.5.1.4.1.1.66.3':'Deformable Spatial Registration Storage',\n  '1.2.840.10008.5.1.4.1.1.66.4':'Segmentation Storage',\n  '1.2.840.10008.5.1.4.1.1.66.5':'Surface Segmentation Storage',\n  '1.2.840.10008.5.1.4.1.1.67':'Real World Value Mapping Storage',\n  '1.2.840.10008.5.1.4.1.1.68.1':'Surface Scan Mesh Storage',\n  '1.2.840.10008.5.1.4.1.1.68.2':'Surface Scan Point Cloud Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1':'VL Image Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.77.2':'VL Multi-frame Image Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.77.1.1':'VL Endoscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.1.1':'Video Endoscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.2':'VL Microscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.2.1':'Video Microscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.3':'VL Slide-Coordinates Microscopic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.4':'VL Photographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.4.1':'Video Photographic Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.1':'Ophthalmic Photography 8 Bit Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.2':'Ophthalmic Photography 16 Bit Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.3':'Stereometric Relationship Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.4':'Ophthalmic Tomography Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.5':'Wide Field Ophthalmic Photography Stereographic Projection Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.5.6':'Wide Field Ophthalmic Photography 3D Coordinates Image Storage',\n  '1.2.840.10008.5.1.4.1.1.77.1.6':'VL Whole Slide Microscopy Image Storage',\n  '1.2.840.10008.5.1.4.1.1.78.1':'Lensometry Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.2':'Autorefraction Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.3':'Keratometry Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.4':'Subjective Refraction Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.5':'Visual Acuity Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.6':'Spectacle Prescription Report Storage',\n  '1.2.840.10008.5.1.4.1.1.78.7':'Ophthalmic Axial Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.78.8':'Intraocular Lens Calculations Storage',\n  '1.2.840.10008.5.1.4.1.1.79.1':'Macular Grid Thickness and Volume Report Storage',\n  '1.2.840.10008.5.1.4.1.1.80.1':'Ophthalmic Visual Field Static Perimetry Measurements Storage',\n  '1.2.840.10008.5.1.4.1.1.81.1':'Ophthalmic Thickness Map Storage',\n  '1.2.840.10008.5.1.4.1.1.82.1':'Corneal Topography Map Storage',\n  '1.2.840.10008.5.1.4.1.1.88.1':'Text SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.2':'Audio SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.3':'Detail SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.4':'Comprehensive SR Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.1.1.88.11':'Basic Text SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.22':'Enhanced SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.33':'Comprehensive SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.34':'Comprehensive 3D SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.35':'Extensible SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.40':'Procedure Log Storage',\n  '1.2.840.10008.5.1.4.1.1.88.50':'Mammography CAD SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.59':'Key Object Selection Document Storage',\n  '1.2.840.10008.5.1.4.1.1.88.65':'Chest CAD SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.67':'X-Ray Radiation Dose SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.68':'Radiopharmaceutical Radiation Dose SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.69':'Colon CAD SR Storage',\n  '1.2.840.10008.5.1.4.1.1.88.70':'Implantation Plan SR Storage',\n  '1.2.840.10008.5.1.4.1.1.104.1':'Encapsulated PDF Storage',\n  '1.2.840.10008.5.1.4.1.1.104.2':'Encapsulated CDA Storage',\n  '1.2.840.10008.5.1.4.1.1.128':'Positron Emission Tomography Image Storage',\n  '1.2.840.10008.5.1.4.1.1.128.1':'Legacy Converted Enhanced PET Image Storage',\n  '1.2.840.10008.5.1.4.1.1.129':'Standalone PET Curve Storage (Retired)',\n  '1.2.840.10008.5.1.4.1.1.130':'Enhanced PET Image Storage',\n  '1.2.840.10008.5.1.4.1.1.131':'Basic Structured Display Storage',\n  '1.2.840.10008.5.1.4.1.1.481.1':'RT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.481.2':'RT Dose Storage',\n  '1.2.840.10008.5.1.4.1.1.481.3':'RT Structure Set Storage',\n  '1.2.840.10008.5.1.4.1.1.481.4':'RT Beams Treatment Record Storage',\n  '1.2.840.10008.5.1.4.1.1.481.5':'RT Plan Storage',\n  '1.2.840.10008.5.1.4.1.1.481.6':'RT Brachy Treatment Record Storage',\n  '1.2.840.10008.5.1.4.1.1.481.7':'RT Treatment Summary Record Storage',\n  '1.2.840.10008.5.1.4.1.1.481.8':'RT Ion Plan Storage',\n  '1.2.840.10008.5.1.4.1.1.481.9':'RT Ion Beams Treatment Record Storage',\n  '1.2.840.10008.5.1.4.1.1.501.1':'DICOS CT Image Storage',\n  '1.2.840.10008.5.1.4.1.1.501.2.1':'DICOS Digital X-Ray Image Storage - For Presentation',\n  '1.2.840.10008.5.1.4.1.1.501.2.2':'DICOS Digital X-Ray Image Storage - For Processing',\n  '1.2.840.10008.5.1.4.1.1.501.3':'DICOS Threat Detection Report Storage',\n  '1.2.840.10008.5.1.4.1.1.501.4':'DICOS 2D AIT Storage',\n  '1.2.840.10008.5.1.4.1.1.501.5':'DICOS 3D AIT Storage',\n  '1.2.840.10008.5.1.4.1.1.501.6':'DICOS Quadrupole Resonance (QR) Storage',\n  '1.2.840.10008.5.1.4.1.1.601.1':'Eddy Current Image Storage',\n  '1.2.840.10008.5.1.4.1.1.601.2':'Eddy Current Multi-frame Image Storage',\n  '1.2.840.10008.5.1.4.1.2.1.1':'Patient Root Query/Retrieve Information Model - FIND',\n  '1.2.840.10008.5.1.4.1.2.1.2':'Patient Root Query/Retrieve Information Model - MOVE',\n  '1.2.840.10008.5.1.4.1.2.1.3':'Patient Root Query/Retrieve Information Model - GET',\n  '1.2.840.10008.5.1.4.1.2.2.1':'Study Root Query/Retrieve Information Model - FIND',\n  '1.2.840.10008.5.1.4.1.2.2.2':'Study Root Query/Retrieve Information Model - MOVE',\n  '1.2.840.10008.5.1.4.1.2.2.3':'Study Root Query/Retrieve Information Model - GET',\n  '1.2.840.10008.5.1.4.1.2.3.1':'Patient/Study Only Query/Retrieve Information Model - FIND (Retired)',\n  '1.2.840.10008.5.1.4.1.2.3.2':'Patient/Study Only Query/Retrieve Information Model - MOVE (Retired)',\n  '1.2.840.10008.5.1.4.1.2.3.3':'Patient/Study Only Query/Retrieve Information Model - GET (Retired)',\n  '1.2.840.10008.5.1.4.1.2.4.2':'Composite Instance Root Retrieve - MOVE',\n  '1.2.840.10008.5.1.4.1.2.4.3':'Composite Instance Root Retrieve - GET',\n  '1.2.840.10008.5.1.4.1.2.5.3':'Composite Instance Retrieve Without Bulk Data - GET',\n  '1.2.840.10008.5.1.4.31':'Modality Worklist Information Model - FIND',\n  '1.2.840.10008.5.1.4.32':'General Purpose Worklist Management Meta SOP Class (Retired)',\n  '1.2.840.10008.5.1.4.32.1':'General Purpose Worklist Information Model - FIND (Retired)',\n  '1.2.840.10008.5.1.4.32.2':'General Purpose Scheduled Procedure Step SOP Class (Retired)',\n  '1.2.840.10008.5.1.4.32.3':'General Purpose Performed Procedure Step SOP Class (Retired)',\n  '1.2.840.10008.5.1.4.33':'Instance Availability Notification SOP Class',\n  '1.2.840.10008.5.1.4.34.1':'RT Beams Delivery Instruction Storage - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.2':'RT Conventional Machine Verification - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.3':'RT Ion Machine Verification - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4':'Unified Worklist and Procedure Step Service Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.1':'Unified Procedure Step - Push SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.2':'Unified Procedure Step - Watch SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.3':'Unified Procedure Step - Pull SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.4.4':'Unified Procedure Step - Event SOP Class - Trial (Retired)',\n  '1.2.840.10008.5.1.4.34.5':'UPS Global Subscription SOP Instance',\n  '1.2.840.10008.5.1.4.34.5.1':'UPS Filtered Global Subscription SOP Instance',\n  '1.2.840.10008.5.1.4.34.6':'Unified Worklist and Procedure Step Service Class',\n  '1.2.840.10008.5.1.4.34.6.1':'Unified Procedure Step - Push SOP Class',\n  '1.2.840.10008.5.1.4.34.6.2':'Unified Procedure Step - Watch SOP Class',\n  '1.2.840.10008.5.1.4.34.6.3':'Unified Procedure Step - Pull SOP Class',\n  '1.2.840.10008.5.1.4.34.6.4':'Unified Procedure Step - Event SOP Class',\n  '1.2.840.10008.5.1.4.34.7':'RT Beams Delivery Instruction Storage',\n  '1.2.840.10008.5.1.4.34.8':'RT Conventional Machine Verification',\n  '1.2.840.10008.5.1.4.34.9':'RT Ion Machine Verification',\n  '1.2.840.10008.5.1.4.37.1':'General Relevant Patient Information Query',\n  '1.2.840.10008.5.1.4.37.2':'Breast Imaging Relevant Patient Information Query',\n  '1.2.840.10008.5.1.4.37.3':'Cardiac Relevant Patient Information Query',\n  '1.2.840.10008.5.1.4.38.1':'Hanging Protocol Storage',\n  '1.2.840.10008.5.1.4.38.2':'Hanging Protocol Information Model - FIND',\n  '1.2.840.10008.5.1.4.38.3':'Hanging Protocol Information Model - MOVE',\n  '1.2.840.10008.5.1.4.38.4':'Hanging Protocol Information Model - GET',\n  '1.2.840.10008.5.1.4.39.1':'Color Palette Storage',\n  '1.2.840.10008.5.1.4.39.2':'Color Palette Information Model - FIND',\n  '1.2.840.10008.5.1.4.39.3':'Color Palette Information Model - MOVE',\n  '1.2.840.10008.5.1.4.39.4':'Color Palette Information Model - GET',\n  '1.2.840.10008.5.1.4.41':'Product Characteristics Query SOP Class',\n  '1.2.840.10008.5.1.4.42':'Substance Approval Query SOP Class',\n  '1.2.840.10008.5.1.4.43.1':'Generic Implant Template Storage',\n  '1.2.840.10008.5.1.4.43.2':'Generic Implant Template Information Model - FIND',\n  '1.2.840.10008.5.1.4.43.3':'Generic Implant Template Information Model - MOVE',\n  '1.2.840.10008.5.1.4.43.4':'Generic Implant Template Information Model - GET',\n  '1.2.840.10008.5.1.4.44.1':'Implant Assembly Template Storage',\n  '1.2.840.10008.5.1.4.44.2':'Implant Assembly Template Information Model - FIND',\n  '1.2.840.10008.5.1.4.44.3':'Implant Assembly Template Information Model - MOVE',\n  '1.2.840.10008.5.1.4.44.4':'Implant Assembly Template Information Model - GET',\n  '1.2.840.10008.5.1.4.45.1':'Implant Template Group Storage',\n  '1.2.840.10008.5.1.4.45.2':'Implant Template Group Information Model - FIND',\n  '1.2.840.10008.5.1.4.45.3':'Implant Template Group Information Model - MOVE',\n  '1.2.840.10008.5.1.4.45.4':'Implant Template Group Information Model - GET',\n  '1.2.840.10008.7.1.1':'Native DICOM Model',\n  '1.2.840.10008.7.1.2':'Abstract Multi-Dimensional Image Model',\n  '1.2.840.10008.8.1.1':'DICOM Content Mapping Resource',\n  '1.2.840.10008.15.0.3.1':'dicomDeviceName',\n  '1.2.840.10008.15.0.3.2':'dicomDescription',\n  '1.2.840.10008.15.0.3.3':'dicomManufacturer',\n  '1.2.840.10008.15.0.3.4':'dicomManufacturerModelName',\n  '1.2.840.10008.15.0.3.5':'dicomSoftwareVersion',\n  '1.2.840.10008.15.0.3.6':'dicomVendorData',\n  '1.2.840.10008.15.0.3.7':'dicomAETitle',\n  '1.2.840.10008.15.0.3.8':'dicomNetworkConnectionReference',\n  '1.2.840.10008.15.0.3.9':'dicomApplicationCluster',\n  '1.2.840.10008.15.0.3.10':'dicomAssociationInitiator',\n  '1.2.840.10008.15.0.3.11':'dicomAssociationAcceptor',\n  '1.2.840.10008.15.0.3.12':'dicomHostname',\n  '1.2.840.10008.15.0.3.13':'dicomPort',\n  '1.2.840.10008.15.0.3.14':'dicomSOPClass',\n  '1.2.840.10008.15.0.3.15':'dicomTransferRole',\n  '1.2.840.10008.15.0.3.16':'dicomTransferSyntax',\n  '1.2.840.10008.15.0.3.17':'dicomPrimaryDeviceType',\n  '1.2.840.10008.15.0.3.18':'dicomRelatedDeviceReference',\n  '1.2.840.10008.15.0.3.19':'dicomPreferredCalledAETitle',\n  '1.2.840.10008.15.0.3.20':'dicomTLSCyphersuite',\n  '1.2.840.10008.15.0.3.21':'dicomAuthorizedNodeCertificateReference',\n  '1.2.840.10008.15.0.3.22':'dicomThisNodeCertificateReference',\n  '1.2.840.10008.15.0.3.23':'dicomInstalled',\n  '1.2.840.10008.15.0.3.24':'dicomStationName',\n  '1.2.840.10008.15.0.3.25':'dicomDeviceSerialNumber',\n  '1.2.840.10008.15.0.3.26':'dicomInstitutionName',\n  '1.2.840.10008.15.0.3.27':'dicomInstitutionAddress',\n  '1.2.840.10008.15.0.3.28':'dicomInstitutionDepartmentName',\n  '1.2.840.10008.15.0.3.29':'dicomIssuerOfPatientID',\n  '1.2.840.10008.15.0.3.30':'dicomPreferredCallingAETitle',\n  '1.2.840.10008.15.0.3.31':'dicomSupportedCharacterSet',\n  '1.2.840.10008.15.0.4.1':'dicomConfigurationRoot',\n  '1.2.840.10008.15.0.4.2':'dicomDevicesRoot',\n  '1.2.840.10008.15.0.4.3':'dicomUniqueAETitlesRegistryRoot',\n  '1.2.840.10008.15.0.4.4':'dicomDevice',\n  '1.2.840.10008.15.0.4.5':'dicomNetworkAE',\n  '1.2.840.10008.15.0.4.6':'dicomNetworkConnection',\n  '1.2.840.10008.15.0.4.7':'dicomUniqueAETitle',\n  '1.2.840.10008.15.0.4.8':'dicomTransferCapability',\n  '1.2.840.10008.15.1.1':'Universal Coordinated Time',\n};\n","import React, { PureComponent } from 'react'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\n\r\nclass OpenUrlDlg extends PureComponent {\r\n\r\n  hide = () => {\r\n    this.props.onClose()\r\n  }\r\n\r\n  cancel = () => {\r\n    window.stop()\r\n    this.hide()\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Dialog\r\n            open={true}\r\n            onClose={this.hide}\r\n            aria-labelledby=\"alert-dialog-title\"\r\n        >\r\n            <DialogTitle id=\"alert-dialog-title\">{\"Downloading file ...\"}</DialogTitle>\r\n            <DialogContent>\r\n              <LinearProgress variant=\"determinate\" value={this.props.progress} color='secondary' />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={this.cancel}>\r\n                    Cancel\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default OpenUrlDlg\r\n","import React, { PureComponent } from 'react'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport { \r\n    mdiPlay,\r\n    mdiPause,\r\n    mdiSkipBackward,\r\n    mdiSkipForward,\r\n    mdiSkipNext,\r\n    mdiSkipPrevious,\r\n  } from '@mdi/js'\r\n\r\nconst iconColor = '#FFFFFF'\r\n\r\nclass CinePlayer extends PureComponent {\r\n    firstframe = () => {\r\n        this.props.runCinePlayer('firstframe') \r\n    }\r\n\r\n    previousframe = () => {\r\n        this.props.runCinePlayer('previousframe') \r\n    }\r\n\r\n    play = () => {\r\n        this.props.runCinePlayer('play') \r\n    }\r\n\r\n    pause = () => {\r\n        this.props.runCinePlayer('pause') \r\n    }\r\n\r\n    nextframe = () => {\r\n        this.props.runCinePlayer('nextframe') \r\n    }\r\n\r\n    lastframe = () => {\r\n        this.props.runCinePlayer('lastframe') \r\n    }\r\n\r\n    render() {\r\n        let play = null\r\n        if (!this.props.inPlay) {\r\n            play = <IconButton onClick={this.play}>\r\n                        <Icon path={mdiPlay} size={'1.5rem'} color={iconColor} />\r\n                   </IconButton>          \r\n        } else {\r\n            play = <IconButton onClick={this.pause}>\r\n                        <Icon path={mdiPause} size={'1.5rem'} color={iconColor} />\r\n                   </IconButton>  \r\n        }\r\n        return (\r\n            <div style={{ width:240, margin:'0 auto' }}>\r\n                <IconButton onClick={this.firstframe}>\r\n                    <Icon path={mdiSkipBackward} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n                <IconButton onClick={this.previousframe}>\r\n                    <Icon path={mdiSkipPrevious} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n                {play}\r\n                <IconButton onClick={this.nextframe}>\r\n                    <Icon path={mdiSkipNext} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n                <IconButton onClick={this.lastframe}>\r\n                    <Icon path={mdiSkipForward} size={'1.5rem'} color={iconColor} />\r\n                </IconButton>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default CinePlayer\r\n","import Dexie from 'dexie'\r\n\r\nconst db = new Dexie('udvDB')\r\n\r\ndb.version(1).stores({ \r\n    measurement: '++id, sopinstanceuid, tool' \r\n})\r\n\r\ndb.open()\r\n\r\nexport default db\r\n","import React from \"react\"\nimport {connect} from 'react-redux'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Link from '@material-ui/core/Link'\nimport Typography from '@material-ui/core/Typography'\nimport Hammer from \"hammerjs\"\nimport * as cornerstone from \"cornerstone-core\"\nimport * as cornerstoneTools from \"cornerstone-tools\"\nimport * as cornerstoneMath from \"cornerstone-math\"\nimport * as cornerstoneFileImageLoader from \"cornerstone-file-image-loader\"\nimport * as cornerstoneWebImageLoader from \"cornerstone-web-image-loader\"\nimport * as cornerstoneWADOImageLoader from \"cornerstone-wado-image-loader\"\nimport * as dicomParser from 'dicom-parser'\nimport * as blobUtil from 'blob-util'\nimport {uids} from '../constants/uids'\nimport { SETTINGS_SAVEAS } from '../constants/settings'\nimport OpenUrlDlg from './OpenUrlDlg'\nimport CinePlayer from './CinePlayer'\nimport { isMobile } from 'react-device-detect'\nimport { import as csTools } from 'cornerstone-tools'\nimport db from '../db/db'\nimport fs from '../fs/fs'\nimport {\n  clearStore, \n  dcmIsOpen, \n  activeDcm, \n  dcmTool, \n  activeMeasurements,\n  doFsRefresh} \nfrom '../actions'\nimport {\n  getFileName,\n  getSettingsOverlay,\n  isFileImage,\n  isFsFileImage,\n  isUrlImage,\n  getSettingsSaveInto\n} from '../functions'\n\nconst scrollToIndex = csTools('util/scrollToIndex')\n/*\nfunction getBlobUrl(url) {\n  const baseUrl = window.URL || window.webkitURL;\n  const blob = new Blob([`importScripts('${url}')`], {type: \"application/javascript\"});\n  return baseUrl.createObjectURL(blob);\n}\n\nlet webWorkerUrl = getBlobUrl(\n  \"https://unpkg.com/cornerstone-wado-image-loader@3.0.0/dist/cornerstoneWADOImageLoaderWebWorker.min.js\"\n)\nlet codecsUrl = getBlobUrl(\n  \"https://unpkg.com/cornerstone-wado-image-loader@3.0.0/dist/cornerstoneWADOImageLoaderCodecs.js\"\n  // \"https://unpkg.com/cornerstone-wado-image-loader/dist/cornerstoneWADOImageLoaderCodecs.js\"\n)\n// See componentDidMount line 110 for initialization, registration\n\nconst config = {\n  maxWebWorkers: 4, //\n  //startWebWorkersOnDemand: true, //\n  webWorkerPath: webWorkerUrl,\n  //webWorkerTaskPaths: [], //\n  taskConfiguration: {\n    decodeTask: {\n      //loadCodecsOnStartup: true, //\n      //initializeCodecsOnStartup: false, //\n      codecsPath: codecsUrl,\n      //usePDFJS: false, //\n      //strict: true //\n    }\n  }\n}\nvar config = {\n  maxWebWorkers: navigator.hardwareConcurrency || 1,\n  startWebWorkersOnDemand: false,\n}\n*/\ncornerstoneTools.external.cornerstone = cornerstone\ncornerstoneTools.external.cornerstoneMath = cornerstoneMath\ncornerstoneFileImageLoader.external.cornerstone = cornerstone\ncornerstoneWebImageLoader.external.cornerstone = cornerstone\ncornerstoneWADOImageLoader.external.cornerstone = cornerstone\n//cornerstoneWADOImageLoader.webWorkerManager.initialize(config)\ncornerstoneWADOImageLoader.external.dicomParser = dicomParser\ncornerstoneTools.external.Hammer = Hammer\ncornerstoneTools.init()\n\n//console.log({ cornerstone })\n//console.log({ cornerstoneWADOImageLoader })\n//console.log({ dicomParser })\n\nclass DicomViewer extends React.Component {\n    constructor(props) {\n      super(props)\n      this.localfile = null\n      this.localurl = null\n      this.fsItem = null\n      this.dicomImage = null\n      this.imageId = null\n      this.image = null\n      this.isDicom = false\n      this.numberOfFrames = 1\n      this.measurements = []\n    }\n\n    state = { \n      file: null,\n      visibleOpenUrlDlg: false,\n      progress: null,\n      visibleCinePlayer: false,\n      errorOnOpenImage: null,\n      errorOnCors: false,\n      frame: 1,\n      inPlay: false,\n      viewport: null,\n    }\n  \n    componentDidMount() {\n      this.props.runTool(this)\n      this.props.changeTool(this)\n      cornerstone.events.addEventListener('cornerstoneimageloaded', this.onImageLoaded)\n      const { dcmRef } = this.props\n      dcmRef(this)          \n    }\n\n    componentWillUnmount() {\n      this.props.runTool(undefined)\n      this.props.changeTool(undefined)\n      const { dcmRef } = this.props\n      dcmRef(undefined)            \n    }\n\n    componentDidUpdate(previousProps) {\n      const isOpen = this.props.isOpen[this.props.index]\n      if (this.props.layout !== previousProps.layout && isOpen) {\n        cornerstone.resize(this.dicomImage)        \n      }\n    }\n  \n    onOpenUrl = (e) => {\n      const eventData = e.detail\n      this.setState({ progress: eventData.percentComplete })\n    }\n\n    showOpenUrlDlg = (url) => {\n      this.setState({ visibleOpenUrlDlg: true }, () => {\n        cornerstone.events.addEventListener('cornerstoneimageloadprogress', this.onOpenUrl)\n        this.loadImage(undefined, url)\n      })\n    }\n  \n    hideOpenUrlDlg = () => {\n      this.setState({ visibleOpenUrlDlg: false, progress: null })\n    }\n\n    measurementSave = (measure) => {\n      this.measurements.push(measure) \n    }\n\n    measurementClear = () => {\n      this.measurements.splice(0, this.measurements.length)\n    }\n\n    measurementRemove = (index) => {\n      //console.log('this.measurements: ', this.measurements)\n      this.measurements.splice(index, 1)\n    }    \n\n    getTransferSyntax = () => {\n      const value = this.image.data.string('x00020010')\n      return value + ' [' + uids[value] + ']'\n    }\n\n    getSopClass = () => {\n      const value = this.image.data.string('x00080016')\n      return value + ' [' + uids[value] + ']'\n    }\n\n    getSopInstanceUID = () => {\n      const value = this.image.data.string('x00080018')\n      return value\n    }\n\n    getPixelRepresentation = () => {\n      const value = this.image.data.uint16('x00280103')\n      if (value === undefined) return\n      return value + (value === 0 ? ' (unsigned)' : ' (signed)')\n    }\n\n    getPlanarConfiguration = () => {\n      const value = this.image.data.uint16('x00280006')\n      if (value === undefined) return \n      return value + (value === 0 ? ' (pixel)' : ' (plane)')\n    }\n\n    \n    onImageLoaded = (e) => {\n      console.log('cornerstoneimageloaded: ')\n\n    }\n\n    // Listen for changes to the viewport so we can update the text overlays in the corner\n    onImageRendered = (e) => {\n      //console.log('cornerstoneimagerendered: ')\n\n      const viewport = cornerstone.getViewport(e.target)\n\n      //console.log('viewport: ', viewport)\n\n      if (this.isDicom) document.getElementById(\n        `mrtopleft-${this.props.index}`\n      ).textContent = `${this.PatientsName}`\n\n      document.getElementById(\n        `mrtopright-${this.props.index}`\n      ).textContent = `${viewport.displayedArea.brhc.x}x${viewport.displayedArea.brhc.y}`\n\n      document.getElementById(\n        `mrbottomleft-${this.props.index}`\n      ).textContent = `WW/WC: ${Math.round(viewport.voi.windowWidth)}/${Math.round(viewport.voi.windowCenter)}`\n\n      document.getElementById(\n        `mrbottomright-${this.props.index}`\n      ).textContent = `Zoom: ${Math.round(viewport.scale.toFixed(2)*100)}%`\n\n      if (this.isDicom && this.state.visibleCinePlayer && this.numberOfFrames > 1) {\n        document.getElementById(\n          `frameLabel-${this.props.index}`\n        ).textContent = `${this.state.frame} / ${this.numberOfFrames}`\n        if (this.state.inPlay) {\n          let frame = this.state.frame === this.numberOfFrames ? 1 : this.state.frame+1\n          this.setState({frame: frame})\n        }\n      }\n      \n    }\n\n    onMeasurementModified = (e) => {\n      //console.log('cornerstonetoolsmeasurementmodified: ', e.detail.measurementData)\n      \n    }\n\n    onMeasurementAdded = (e) => {\n      //console.log('cornerstonetoolsmeasurementadded: ', e.detail.measurementData)\n      if (this.props.tool !== \"Angle\") return\n      const measure = {\n        tool: this.props.tool,\n        note: '',\n        data: e.detail.measurementData\n      }\n      this.measurementSave(measure)\n      this.props.setActiveMeasurements(this.measurements)      \n\n    }\n\n    onMeasurementCompleted = (e) => {\n      //console.log('cornerstonetoolsmeasurementcompleted: ', e.detail.measurementData)\n      const measure = {\n        tool: this.props.tool,\n        note: '',\n        data: e.detail.measurementData\n      }\n      this.measurementSave(measure)\n      this.props.setActiveMeasurements(this.measurements)\n    }\n    \n    onErrorOpenImageClose = () => {\n      this.setState({errorOnOpenImage: null})\n    }\n\n    onErrorCorsClose = () => {\n      this.setState({errorOnCors: false})\n    }    \n\n    loadImage = (localfile, url=undefined, fsItem=undefined) => {\n      //console.log('loadImage, localfile: ', localfile)\n      //console.log('loadImage, url: ', url)\n\n      if (localfile === undefined && url === undefined && fsItem === undefined) return\n      \n      if (fsItem !== undefined) {\n        this.fsItem = fsItem\n      } else if (localfile !== undefined) {\n        this.localfile = localfile\n      } else {\n        this.localurl = url\n      }\n \n      const element = this.dicomImage\n\n      element.addEventListener(\"cornerstonenewimage\", this.onNewImage)\n      element.addEventListener(\"cornerstoneimagerendered\", this.onImageRendered)\n      element.addEventListener(\"cornerstonetoolsmeasurementadded\", this.onMeasurementAdded)\n      element.addEventListener(\"cornerstonetoolsmeasurementmodified\", this.onMeasurementModified)\n      element.addEventListener(\"cornerstonetoolsmeasurementcompleted\", this.onMeasurementCompleted)\n\n      let imageId = undefined\n\n      cornerstone.enable(element)\n\n      if (localfile === undefined && isUrlImage(url)) { // check if it's a simple image [jpeg or png] from url\n        //const file = \"file:///C:/GARBAGE/_DCM/\"+localfile.name\n        //console.log('image: ', file)\n        cornerstone.loadImage(url).then(image => {\n          //console.log('loadImage, image from url: ', image)\n\n          this.hideOpenUrlDlg()\n\n          this.image = image\n\n          //this.setState({isDicom: false})\n          this.isDicom = false\n\n          cornerstone.displayImage(element, image)\n          \n          this.enableTool()\n\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n          this.props.isOpenStore(true)\n\n        }, (e) => {\n          console.log('error', e)\n          this.setState({errorOnOpenImage: \"This is not a valid JPG or PNG file.\"})\n        })\n\n      } else if ((localfile !== undefined && isFileImage(localfile)) || (fsItem !== undefined && isFsFileImage(fsItem))) { // otherwise try to open as local image file (JPEG, PNG) \n        //console.log('fsItem: ', fsItem)\n        if (fsItem !== undefined) {\n          imageId = cornerstoneFileImageLoader.fileManager.addBuffer(fsItem.data)\n        } else {\n          imageId = cornerstoneFileImageLoader.fileManager.add(localfile)\n        }\n        cornerstone.loadImage(imageId).then(image => {\n          //console.log('loadImage, image from local: ', image)\n\n          this.image = image\n\n          this.isDicom = false\n\n          cornerstone.displayImage(element, image)\n          \n          this.enableTool()\n\n          this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n          this.props.isOpenStore(true)\n\n        }, (e) => {\n          console.log('error', e)\n          this.setState({errorOnOpenImage: \"This is not a valid JPG or PNG file.\"})\n        })\n\n      } else { // otherwise try to open as Dicom file\n\n        if (fsItem !== undefined) {\n          imageId = cornerstoneWADOImageLoader.wadouri.fileManager.addBuffer(fsItem.data)\n        } else if (localfile !== undefined) {\n          imageId = cornerstoneWADOImageLoader.wadouri.fileManager.add(localfile)\n        } else { // it's a web dicom image\n          imageId = \"wadouri:\"+url\n        }\n  \n        //console.log('loadImage, imageId: ', imageId)\n\n        cornerstone.loadAndCacheImage(imageId).then(image => {\n          //console.log('loadImage, image: ', image)\n\n          this.hideOpenUrlDlg()\n\n          this.image = image\n\n          this.isDicom = true\n          \n          this.PatientsName = image.data.string('x00100010')\n          this.sopInstanceUid = this.getSopInstanceUID()\n\n          let stack = { currentImageIdIndex: 0, imageIds: \"\" }\n          this.numberOfFrames = image.data.intString('x00280008')\n          if (this.numberOfFrames > 0) {\n            //console.log('nFrames: ', nFrames)\n            //this.props.numberOfFramesStore(nFrames)\n            let imageIds = []\t\n            for(var i=0; i < this.numberOfFrames; ++i) {\n              imageIds.push(imageId + \"?frame=\"+i)\n            }\t\n            stack.imageIds = imageIds\n          }\n\n          //console.log('displayImage: ')\n          cornerstone.displayImage(element, image)\n          //cornerstoneTools.mouseInput.enable(element);\n          //cornerstoneTools.mouseWheelInput.enable(element);\n\n          this.enableTool()\n\n          if (this.numberOfFrames > 1) {\n            cornerstoneTools.addStackStateManager(element, ['stack', 'playClip']);    \n            cornerstoneTools.addToolState(element, 'stack', stack)\n            //cornerstoneTools.setToolActive('StackScrollMouseWheel', { })\n            this.setState({frame: 1})\n          }\n  \n          // Load the possible measurements from DB and save in the store \n          db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).each(measure => {\n            console.log('load measure from db: ', measure)\n            //this.props.measurementStore(measure)\n            this.measurementSave(measure)\n            cornerstoneTools.addToolState(element, measure.tool, measure.data)\n            this.runTool(measure.tool)\n            cornerstone.updateImage(element)\n            cornerstoneTools.setToolEnabled(measure.tool)\n          }).then(() => {\n            //console.log('this.measurements: ', this.measurements)\n            this.props.setActiveMeasurements(this.measurements)\n            this.props.setActiveDcm({image: this.image, element: this.dicomImage, isDicom: this.isDicom})\n            this.props.isOpenStore(true)            \n          })       \n\n        }, (e) => {\n          console.log('error', e)   \n          this.hideOpenUrlDlg()      \n          //console.log('toString: ', e.error.toString())\n          if (e.error.toString() === '[object XMLHttpRequest]') {\n            this.setState({errorOnCors: true})\n          } else {\n            let pos = e.error.indexOf(\":\")\n            this.setState({errorOnOpenImage: pos < 0 ? e.error : e.error.substring(pos+1)})            \n          }\n \n        })\n\n      }\n\n    }\n  \n    enableTool = (toolName, mouseButtonNumber) => {\n      // Enable all tools we want to use with this element\n      const WwwcTool = cornerstoneTools.WwwcTool;\n      const LengthTool = cornerstoneTools['LengthTool']\n      const PanTool = cornerstoneTools.PanTool\n      const ZoomTouchPinchTool = cornerstoneTools.ZoomTouchPinchTool\n      const ZoomTool = cornerstoneTools.ZoomTool\n      const ProbeTool = cornerstoneTools.ProbeTool\n      const EllipticalRoiTool = cornerstoneTools.EllipticalRoiTool\n      const RectangleRoiTool = cornerstoneTools.RectangleRoiTool\n      const FreehandRoiTool = cornerstoneTools.FreehandRoiTool\n      const AngleTool = cornerstoneTools.AngleTool\n      const MagnifyTool = cornerstoneTools.MagnifyTool\n      const StackScrollMouseWheelTool = cornerstoneTools.StackScrollMouseWheelTool\n\n      cornerstoneTools.addTool(MagnifyTool)\n      cornerstoneTools.addTool(AngleTool)    \n      cornerstoneTools.addTool(WwwcTool)\n      cornerstoneTools.addTool(LengthTool)\n      cornerstoneTools.addTool(PanTool)\n      cornerstoneTools.addTool(ZoomTouchPinchTool)\n      cornerstoneTools.addTool(ZoomTool)\n      cornerstoneTools.addTool(ProbeTool)\n      cornerstoneTools.addTool(EllipticalRoiTool)\n      cornerstoneTools.addTool(RectangleRoiTool)\n      cornerstoneTools.addTool(FreehandRoiTool)\n      cornerstoneTools.addTool(StackScrollMouseWheelTool)      \n    }\n  \n    // helper function used by the tool button handlers to disable the active tool\n    // before making a new tool active\n    disableAllTools = () => {\n      cornerstoneTools.setToolEnabled('Length')\n      cornerstoneTools.setToolEnabled('Pan')\n      cornerstoneTools.setToolEnabled('Magnify')\n      cornerstoneTools.setToolEnabled('Angle')\n      cornerstoneTools.setToolEnabled('RectangleRoi')\n      cornerstoneTools.setToolEnabled('Wwwc')\n      cornerstoneTools.setToolEnabled('ZoomTouchPinch')\n      cornerstoneTools.setToolEnabled('Probe')\n      cornerstoneTools.setToolEnabled('EllipticalRoi')\n      cornerstoneTools.setToolEnabled('StackScrollMouseWheel')\n    }\n  \n    runTool = (toolName, opt) => {\n      console.log('run tool: ', toolName)\n//      this.disableAllTools()\n      switch (toolName) {\n        case 'openfile': {\n          console.log('openfile: ', opt)\n          cornerstone.disable(this.dicomImage)\n          this.setState({ file: opt })\n          this.loadImage(opt)\n          break   \n        } \n        case 'openurl': {\n          console.log('run tool opt: ', opt)  \n          this.showOpenUrlDlg(opt)\n          break                 \n        }\n        case 'openfs': {\n          console.log('openfs: ', opt)\n          cornerstone.disable(this.dicomImage)\n          this.setState({ file: opt })\n          this.loadImage(undefined, undefined, opt)\n          break   \n        }         \n        case 'clear': {\n          //if (this.state.visibleHistogram) this.runTool('Histogram')\n          //console.log('this.dicomImage: ', this.dicomImage)\n          this.setState({ visibleCinePlayer: false })\n          this.props.clearingStore()\n          cornerstone.disable(this.dicomImage)\n          break\n        }  \n        case 'notool': {\n          this.disableAllTools()\n\n          //const element = this.dicomImage\n\n          //cornerstoneTools.clearToolState(element, 'Length')\n          \n          //const toolStateManager = cornerstoneTools.getElementToolStateManager(element)\n          //console.log('toolStateManager.toolState: ', toolStateManager.toolState)\n          /*\n          const toolState = toolStateManager.toolState\n          // const allTools = Object.keys(toolState).map(key => toolState[key])\n          let key = Object.keys(toolState)[0]\n          let allTools = toolState[key]\n          //console.log('allTools: ', allTools)\n\n          for (let [tool, data] of Object.entries(allTools)) {\n            //console.log(`${tool}: `, data)\n            let key = Object.keys(data)[0]\n            let tools = data[key]\n            //console.log('tools: ', tools)\n            tools.forEach(item => {\n              //console.log('tool: ', tool)\n              //console.log(item)\n              const measure = {\n                tool: tool,\n                note: '',\n                data: item\n              }\n              console.log('measure: ', measure)\n              this.props.measurementStore(measure)\n            })\n          }\n          */\n          //const toolState = toolStateManager.get(element, 'Length')\n          //console.log('toolState: ', toolState)\n\n          /*\n          const measurementData = {\n            visible: true,\n            active: true,\n            invalidated: true,\n            handles: {\n                start: {\n                    x: 100,\n                    y: 100,\n                    highlight: true,\n                    active: false\n                },\n                end: {\n                    x: 200,\n                    y: 200,\n                    highlight: true,\n                    active: true\n                },\n                textBox: {\n                    active: false,\n                    hasMoved: false,\n                    movesIndependently: false,\n                    drawnIndependently: true,\n                    allowedOutsideImage: true,\n                    hasBoundingBox: true\n                }\n              }\n          }\n          cornerstoneTools.addToolState(element, 'RectangleRoi', measurementData)    \n          cornerstoneTools.setToolActive('RectangleRoi', { mouseButtonMask: 1 })\n          */  \n          //cornerstone.updateImage(element)   \n          break\n        }\n        case 'Wwwc': {\n          cornerstoneTools.setToolActive('Wwwc', { mouseButtonMask: 1 })\n          break\n        }  \n        case 'Pan': {\n          cornerstoneTools.setToolActive('Pan', { mouseButtonMask: 1 })\n          break   \n        }  \n        case 'Zoom': {\n          cornerstoneTools.setToolActive(isMobile ? 'ZoomTouchPinch' : 'Zoom', { mouseButtonMask: 1 })\n          break\n        }\n        case 'Length': {\n          cornerstoneTools.setToolActive('Length', isMobile ? { isTouchActive: true } : { mouseButtonMask: 1 })\n          break  \n        }\n        case 'Probe': {\n            cornerstoneTools.setToolActive('Probe', { mouseButtonMask: 1 })\n          break\n        }\n        case 'EllipticalRoi': {\n          cornerstoneTools.setToolActive('EllipticalRoi', { mouseButtonMask: 1 })\n          break   \n        }\n        case 'RectangleRoi': {\n          cornerstoneTools.setToolActive('RectangleRoi', { mouseButtonMask: 1 })\n          break  \n        }\n        case 'Angle': {\n          cornerstoneTools.setToolActive('Angle', { mouseButtonMask: 1 })\n          break \n        }\n        case 'Magnify': {\n          cornerstoneTools.setToolActive('Magnify', { mouseButtonMask: 1 })\n          break  \n        }\n        case 'FreehandRoi': {\n          cornerstoneTools.setToolActive('FreehandRoi', { mouseButtonMask: 1 })\n          break \n        }\n        case 'Invert': {\n          const element = this.dicomImage\n          const viewport = cornerstone.getViewport(element)\n          viewport.invert = !viewport.invert\n          cornerstone.setViewport(element, viewport)\n          break \n        }         \n        case 'saveas': {\n            let type = localStorage.getItem(SETTINGS_SAVEAS)\n            if (getSettingsSaveInto() === 'local') {\n              cornerstoneTools.SaveAs(this.dicomImage, `${this.state.file.name}.${type}`, `image/${type}`)   \n            } else { // store image into sandboxed file system\n              const canvas = document.getElementsByClassName('cornerstone-canvas')[0]\n              blobUtil.canvasToBlob(canvas, `image/${type}`).then(blob => {\n                blobUtil.blobToArrayBuffer(blob).then(arrayBuffer => {\n                  const name = getFileName(this.state.file.name)    \n                  let newName = name\n                  let counter = 1\n                  let done = false             \n                  do {\n                      let filename = `${newName}.${type}`\n                      const checkName = this.props.fsCurrentList.find(e => e.name === filename)\n                      if (checkName === undefined) {\n                          fs.transaction('rw', fs.files, async () => {\n                              await fs.files.add({\n                                  parent: this.props.fsCurrentDir,\n                                  name: filename,\n                                  type: type,\n                                  size: arrayBuffer.byteLength,\n                                  data: arrayBuffer\n                              })\n                          }).then(() => {\n                            this.props.makeFsRefresh()\n                          })\n                          done = true\n                      } else {\n                          newName = `${name} - ${counter}`\n                          counter++\n                      }\n                  } while (!done)\n                })\n              })\n            }  \n          break\n        }\n        case 'cine': {\n          this.setState({ visibleCinePlayer: !this.state.visibleCinePlayer })\n          break\n        }\n        case 'reset': {\n          this.reset()\n          break\n        }\n        case 'removetool': {\n          console.log('removetool index: ', opt)\n          const element = this.dicomImage\n          cornerstoneTools.removeToolState(element, this.measurements[opt].tool, this.measurements[opt].data)\n          cornerstone.updateImage(element)\n          //this.props.measurementRemoveStore(opt)\n          this.measurementRemove(opt)\n          this.props.setActiveMeasurements(this.measurements)\n          break\n        }  \n        case 'removetools': {   \n          const element = this.dicomImage\n          // for each measurement remove it \n          this.measurements.forEach(measure => {\n            cornerstoneTools.clearToolState(element, measure.tool)         \n          })\n          cornerstone.updateImage(element)\n          this.measurementClear()\n          // also remove all measurements from db\n          db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).delete()\n          this.props.setActiveMeasurements(this.measurements)\n          break\n        }  \n        case 'savetools': {\n          // first, remove eventually previous measurements from db\n          db.measurement.where('sopinstanceuid').equals(this.sopInstanceUid).delete()\n          // then save all the current measurements\n          this.measurements.forEach(measure => {\n            try {\n              db.measurement.add({\n                sopinstanceuid: this.sopInstanceUid, \n                tool: measure.tool,\n                note: measure.note,\n                data: measure.data\n              })\n            } catch(error) {\n              console.error(error)\n            }                       \n          })\n          break\n        }\n        default: {\n          break\n        }\n      }\n    } \n\n    changeTool = (toolName, value) => {\n      console.log('change tool, value: ', toolName, value)\n\n      switch (toolName) {\n        case 'Wwwc':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Wwwc', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Wwwc')\n          }\n          break  \n        case 'Pan':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Pan', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Pan')\n          }\n          break    \n        case 'Zoom':\n          if (value === 1) {\n            cornerstoneTools.setToolActive(isMobile ? 'ZoomTouchPinch' : 'Zoom', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive(isMobile ? 'ZoomTouchPinch' : 'Zoom')\n          }\n          break                             \n        case 'Length':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Length', isMobile ? { isTouchActive: true } : { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Length')\n          }\n          break   \n        case 'Probe':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Probe', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Probe')\n          }\n          break        \n        case 'Angle':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Angle', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Angle')\n          }          \n          break   \n        case 'Magnify':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('Magnify', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('Magnify')\n          }          \n          break        \n        case 'EllipticalRoi':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('EllipticalRoi', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('EllipticalRoi')\n          }\n          break   \n        case 'RectangleRoi':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('RectangleRoi', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('RectangleRoi')\n          }\n          break\n        case 'FreehandRoi':\n          if (value === 1) {\n            cornerstoneTools.setToolActive('FreehandRoi', { mouseButtonMask: 1 })\n          } else if (value === 0) {\n            cornerstoneTools.setToolPassive('FreehandRoi')\n          }\n          break     \n        default:\n            break\n        }  \n    }\n\n    runCinePlayer = (cmdName) => {\n      //console.log('this.state.frame: ', this.state.frame)\n      const element = this.dicomImage\n      switch (cmdName) {\n        case 'firstframe': {\n          let frame = 1\n          this.setState({frame: frame})\n          scrollToIndex(element, 0)\n          break\n        }\n        case 'previousframe': {\n          if (this.state.frame > 1) {\n            let frame = this.state.frame-1\n            this.setState({frame: frame})     \n            scrollToIndex(element, frame-1)       \n          }\n          break\n        }\n        case 'play': {\n          cornerstoneTools.playClip(element, 30)\n          this.setState({inPlay: true})\n          break\n        }\n        case 'pause': {\n            cornerstoneTools.stopClip(element)\n            this.setState({inPlay: false})\n          break\n        }\n        case 'nextframe': {\n          if (this.state.frame < this.numberOfFrames) {\n            let frame = this.state.frame+1\n            this.setState({frame: frame})            \n            scrollToIndex(element, frame-1)\n          }\n          break  \n        }\n        case 'lastframe': {\n          let frame = this.numberOfFrames\n          this.setState({frame: frame})   \n          scrollToIndex(element, frame-1)      \n          break    \n        }                       \n        default:\n          break\n      }\n    }\n\n    reset = () => {\n      const element = this.dicomImage\n      const defaultViewport = cornerstone.getDefaultViewportForImage(element, this.image)\n      let viewport = cornerstone.getViewport(element)\n      viewport.voi.windowWidth = defaultViewport.voi.windowWidth\n      viewport.voi.windowCenter = defaultViewport.voi.windowCenter\n      viewport.invert = false\n      cornerstone.setViewport(element, viewport)\n    }\n\n    dicomImageRef = el => {\n      this.dicomImage = el\n    }\n\n    onImageClick = () => {\n      console.log('onImageClick: ')\n    }\n    \n    render() {\n      //console.log('DicomViewer render: ')\n\n      //this.props.visible ? document.body.style = 'background: #000000;' : document.body.style = 'background: $md-grey-700;'\n\n      const isOpen = this.props.isOpen[this.props.index]\n      //const visibleHistogram = this.state.visibleHistogram\n      const visibleOpenUrlDlg = this.state.visibleOpenUrlDlg\n      const errorOnOpenImage = this.state.errorOnOpenImage\n      const progress = this.state.progress\n\n      const styleContainer = {\n        width: '100%', \n        height: '100%', \n        border: this.props.activeDcmIndex === this.props.index && (this.props.layout[0] > 1 || this.props.layout[1] > 1) ? 'solid 1px #AAAAAA' : 'solid 1px #000000',\n        position: 'relative',\n      }\n\n      const styleDicomImage = {\n        width: '100%', \n        height: '100%', \n        position: 'relative',\n      }\n\n      const overlay = getSettingsOverlay() \n\n      return ( \n        <div className=\"container\" style={styleContainer} >\n\n          {visibleOpenUrlDlg ? <OpenUrlDlg progress={progress} onClose={this.hideOpenUrlDlg} /> : null}\n\n          <Dialog\n            open={errorOnOpenImage !== null}\n            onClose={this.onErrorOpenImageClose}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n          >\n            <DialogTitle id=\"alert-dialog-title\">{\"Error on opening image\"}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                {this.state.errorOnOpenImage}\n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={this.onErrorOpenImageClose} autoFocus>\n                Ok\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <Dialog\n            open={this.state.errorOnCors}\n            onClose={this.onErrorCorsClose}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n          >\n            <DialogTitle id=\"alert-dialog-title\">{\"Error on loading image\"}</DialogTitle>\n            <DialogContent>\n              <DialogContentText id=\"alert-dialog-description\">\n                <Typography gutterBottom>\n                  CORS or Cross Origin Resource Sharing is a browser security policy \n                  that prevents javascript from loading data from a server with a different base URL \n                  than the server that served up the javascript file. \n                </Typography> \n                <Typography gutterBottom>\n                  See the &nbsp; \n                  <Link href=\"http://enable-cors.org/\" target='_blank' color='textPrimary'>\n                    Enable CORS site\n                  </Link>\n                  &nbsp; for information about CORS.                     \n                </Typography>                                \n              </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={this.onErrorCorsClose} autoFocus>\n                Ok\n              </Button>\n            </DialogActions>\n          </Dialog>\n\n          <div\n            //tabIndex=\"0\"\n            style={{\n              width: '100%', \n              height: '100%', \n              position: \"relative\",\n              //display: \"inline-block\",\n              color: '#FFFFFF',\n              textShadow: '1px 1px #000000'\n            }}\n            onContextMenu={() => false}\n            className=\"cornerstone-enabled-image\"\n            //unselectable=\"on\"\n            //onMouseDown={() => false}\n          >\n            <div \n              ref={this.dicomImageRef} style={styleDicomImage}\n            >\n            </div>\n            <div\n              id={`mrtopleft-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, left: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              Patient Name\n            </div>\n            <div\n              id={`mrtopright-${this.props.index}`}\n              style={{ position: \"absolute\", top: 0, right: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              Size\n            </div>\n            <div\n              id={`mrbottomright-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, right: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              Zoom:\n            </div>\n            <div\n              id={`mrbottomleft-${this.props.index}`}\n              style={{ position: \"absolute\", bottom: 0, left: 3, display: isOpen && overlay ? \"\" : \"none\" }}\n            >\n              WW/WC:\n            </div>    \n            { this.state.visibleCinePlayer && this.numberOfFrames > 1 ? (\n              <div style={{position:\"absolute\", width:'100%', bottom:0, textAlign:'center'}}>\n                <div style={{margin:'0 auto', width:'240px', backgroundColor:'rgba(136, 136, 136, 0.5)'}}>\n                  <CinePlayer runCinePlayer={this.runCinePlayer} inPlay={this.state.inPlay} />  \n                  <div \n                    id={`frameLabel-${this.props.index}`}\n                    style={{ width:230, margin:'0 auto', marginTop:-10, textAlign:\"center\" }}\n                  >\n                    {this.state.frame} / {this.numberOfFrames}\n                  </div> \n                </div>               \n              </div> \n              ) : null\n            }  \n            {/*<div style={{position:\"absolute\", width:'100%', height:'100%', top:0, left:0}}></div>*/}\n          </div>\n        </div>\n      )\n    }\n  }\n  \nconst mapStateToProps = (state) => {\n  return {\n    url: state.url,\n    isOpen: state.isOpen,\n    tool: state.tool,\n    activeDcmIndex: state.activeDcmIndex,\n    measurements: state.measurements,\n    layout: state.layout,\n    fsCurrentDir: state.fsCurrentDir,\n    fsCurrentList: state.fsCurrentList,\n    sandboxedFile: state.sandboxedFile,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    clearingStore: () => dispatch(clearStore()),\n    isOpenStore: (value) => dispatch(dcmIsOpen(value)),\n    toolStore: (tool) => dispatch(dcmTool(tool)),\n    setActiveDcm: (dcm) => dispatch(activeDcm(dcm)),\n    setActiveMeasurements: (measurements) => dispatch(activeMeasurements(measurements)),\n    makeFsRefresh: (dcm) => dispatch(doFsRefresh()),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DicomViewer)\n","import React from 'react'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport { SETTINGS_DCMHEADER } from '../constants/settings'\r\nimport { toCsv } from '../functions'\r\nimport {\r\n    mdiContentSaveOutline\r\n} from '@mdi/js'\r\n\r\nconst DicomHeader = ({dcmViewer, classes, color}) => {\r\n    let header = []\r\n    header.push({name: 'Transfer Syntax', value: dcmViewer.getTransferSyntax()})\r\n    header.push({name: 'SOP Class', value: dcmViewer.getSopClass()})\r\n    header.push({name: 'SOP Instance UID', value: dcmViewer.getSopInstanceUID()})\r\n    header.push({name: 'Patient Name', value: dcmViewer.image.data.string('x00100010')})\r\n    header.push({name: 'Frame Rate', value: dcmViewer.image.data.string('x00082144')})\r\n    header.push({name: 'Samples per Pixel', value: dcmViewer.image.data.uint16('x00280002')})\r\n    header.push({name: 'Photometric Interpretation', value: dcmViewer.image.data.string('x00280004')})\r\n    header.push({name: 'Number of Frames', value: dcmViewer.image.data.string('x00280008')})\r\n    header.push({name: 'Planar Configuration', value: dcmViewer.getPlanarConfiguration()})\r\n    header.push({name: 'Rows', value: dcmViewer.image.data.uint16('x00280010')})\r\n    header.push({name: 'Columns', value: dcmViewer.image.data.uint16('x00280011')})\r\n    header.push({name: 'Pixel Spacing', value: dcmViewer.image.data.string('x00280030')})\r\n    header.push({name: 'Bits Allocated', value: dcmViewer.image.data.uint16('x00280100')})\r\n    header.push({name: 'Bits Stored', value: dcmViewer.image.data.uint16('x00280101')})\r\n    header.push({name: 'High Bit', value: dcmViewer.image.data.uint16('x00280102')})\r\n    header.push({name: 'Pixel Representation', value: dcmViewer.getPixelRepresentation()})\r\n    header.push({name: 'Window Center', value: dcmViewer.image.data.string('x00281050')})\r\n    header.push({name: 'Window Width', value: dcmViewer.image.data.string('x00281051')})\r\n    header.push({name: 'Rescale Intercept', value: dcmViewer.image.data.string('x00281052')})\r\n    header.push({name: 'Rescale Slope', value: dcmViewer.image.data.string('x00281053')})\r\n    header.push({name: 'Min Stored Pixel Value', value: dcmViewer.image.minPixelValue})\r\n    header.push({name: 'Max Stored Pixel Value', value: dcmViewer.image.maxPixelValue})\r\n\r\n    const listItems = header.map((item, index) => {\r\n        if (item.value !== undefined) \r\n            return (\r\n                <ListItem dense={true} key={index}>\r\n                    <ListItemText primary={item.name} secondary={item.value} />\r\n                </ListItem>\r\n            ) \r\n        else return null\r\n    })\r\n\r\n    const saveHeader = () => {\r\n        let exportAs = localStorage.getItem(SETTINGS_DCMHEADER)\r\n        if (exportAs === null) {\r\n          exportAs = \"json\"\r\n          localStorage.setItem(SETTINGS_DCMHEADER, exportAs)\r\n        }  \r\n    \r\n        let fileData = ''\r\n        \r\n        if (exportAs === 'csv') {\r\n          fileData = toCsv(header)\r\n        } else {\r\n          const obj = header.reduce((o, item) => ({ ...o, [item.name]: item.value}), {})\r\n          fileData = JSON.stringify(obj)\r\n        }\r\n        \r\n        const element = document.createElement(\"a\")\r\n        const file = new Blob([fileData], {type: 'text/plain'})\r\n        element.href = URL.createObjectURL(file)\r\n        element.download = `${dcmViewer.localfile.name}.${exportAs}`\r\n        document.body.appendChild(element) // Required for this to work in FireFox\r\n        element.click()\r\n    }\r\n\r\n    console.log('dcmViewer', dcmViewer)\r\n\r\n    return (\r\n        <div style={{marginTop: '48px'}}>\r\n        <Toolbar variant=\"dense\">\r\n          <Typography variant=\"subtitle1\" className={classes.title}>\r\n            Dicom Header\r\n          </Typography>\r\n          <div className={classes.grow} />\r\n          <IconButton color=\"inherit\" onClick={saveHeader}>\r\n            <Icon path={mdiContentSaveOutline} size={'1.2rem'} color={color} />\r\n          </IconButton>\r\n        </Toolbar>\r\n        <div>\r\n            <List dense={true} component=\"div\">\r\n                {listItems}             \r\n            </List>\r\n        </div>      \r\n      </div>\r\n\r\n    )\r\n}\r\n  \r\nexport default DicomHeader\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport Button from '@material-ui/core/Button'\r\nimport CreateIcon from '@material-ui/icons/Create'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport { withStyles } from '@material-ui/core/styles'\r\n\r\nconst styles = theme => ({\r\n    listItemText:{\r\n        fontSize:'0.9em',\r\n    }\r\n})\r\n\r\nclass MeasureItem extends PureComponent {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.noteField = React.createRef()\r\n    \r\n      }\r\n\r\n    state = { \r\n        visibleDlgNote: false,\r\n        visibleDlgDelete: false,\r\n    }\r\n\r\n    showDlgNote = () => {\r\n        this.setState({ visibleDlgNote: true })\r\n    }\r\n    \r\n    hideDlgNote = () => {\r\n        this.setState({ visibleDlgNote: false })\r\n    }\r\n\r\n    showDlgDelete = () => {\r\n        this.setState({ visibleDlgDelete: true })\r\n    }\r\n    \r\n    hideDlgDelete = () => {\r\n        this.setState({ visibleDlgDelete: false })\r\n    }\r\n\r\n    handleOnChangeNote = event => {\r\n        this.setState({ note: event.target.value })\r\n    }\r\n\r\n    confirmNote = (index) => {\r\n        this.hideDlgNote()\r\n        this.props.measurements[index].note = this.noteField.value\r\n    }   \r\n\r\n    confirmDelete = (index) => {\r\n        this.hideDlgDelete()\r\n        this.props.toolRemove(index)\r\n    }\r\n\r\n    onEdit = () => {\r\n        this.showDlgNote()\r\n    }\r\n    \r\n    onDelete = () => {\r\n        this.showDlgDelete()\r\n    }\r\n    \r\n    render() {    \r\n        const { classes } = this.props\r\n\r\n        let item = this.props.item\r\n        let index = this.props.index\r\n        let pText = ''\r\n        let sText = ''\r\n        \r\n        switch (item.tool) {\r\n            case 'Length':\r\n                pText = `${item.data.length.toFixed(2)} ${item.data.unit}`\r\n                sText = item.note\r\n                break\r\n            case 'Angle':\r\n                pText = `${item.data.rAngle} °`\r\n                sText = item.note\r\n                break\r\n            case 'EllipticalRoi':\r\n                pText = <div>\r\n                            <div> A: {item.data.cachedStats.area.toFixed(2)} mm² </div>\r\n                            <div> M: {item.data.cachedStats.mean.toFixed(2)} {item.data.unit} </div>\r\n                            <div> SD: {item.data.cachedStats.stdDev.toFixed(2)} {item.data.unit} </div>\r\n                        </div>\r\n                sText = item.note            \r\n                break    \r\n            case 'RectangleRoi':\r\n                pText = <div>\r\n                            <div> A: {item.data.cachedStats.area.toFixed(2)} mm² </div>\r\n                            <div> M: {item.data.cachedStats.mean.toFixed(2)} {item.data.unit} </div>\r\n                    <       div> SD: {item.data.cachedStats.stdDev.toFixed(2)} {item.data.unit} </div>\r\n                        </div>\r\n                sText = item.note\r\n                break          \r\n            case 'FreehandRoi':\r\n                pText = <div>\r\n                            <div> A: {item.data.area.toFixed(2)} mm² </div>\r\n                            <div> M: {item.data.meanStdDev.mean.toFixed(2)} {item.data.unit} </div>\r\n                    <       div> SD: {item.data.meanStdDev.stdDev.toFixed(2)} {item.data.unit} </div>\r\n                        </div>\r\n                sText = item.note\r\n                break                                  \r\n            default:\r\n                break    \r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <ListItem>\r\n                    <ListItemText classes={{primary:classes.listItemText}} primary={pText} secondary={sText} />\r\n                    <Toolbar>\r\n                        <IconButton edge=\"end\" onClick={() => this.onEdit(index)}>\r\n                            <CreateIcon />\r\n                        </IconButton>\r\n                        <IconButton edge=\"end\" onClick={() => this.onDelete(index)}>\r\n                            <DeleteIcon />\r\n                        </IconButton>\r\n                    </Toolbar>\r\n                </ListItem>\r\n                \r\n                { this.state.visibleDlgNote ?\r\n                    <Dialog\r\n                        open={this.state.visibleDlgNote}\r\n                        onClose={this.hideDlgNote}\r\n                        aria-labelledby=\"form-dialog-title\"\r\n                    >\r\n                        <DialogTitle id=\"form-dialog-title\">{\"Note for measurement:\"}</DialogTitle>\r\n                        <DialogContent>\r\n                            <TextField\r\n                                ref=\"noteField\"\r\n                                autoFocus\r\n                                margin=\"dense\"\r\n                                id=\"note\"\r\n                                fullWidth\r\n                                defaultValue={this.props.measurements[index].note}\r\n                                inputRef={input => (this.noteField = input)}\r\n                            />\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={this.hideDlgNote} >\r\n                                Cancel\r\n                            </Button>\r\n                            <Button onClick={() => this.confirmNote(index)} autoFocus>\r\n                                Ok\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </Dialog>\r\n                : null }\r\n\r\n                <Dialog\r\n                    open={this.state.visibleDlgDelete}\r\n                    onClose={this.hideDlgNote}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                >\r\n                    <DialogTitle id=\"alert-dialog-title\">{\"Are you sure to delete the measurement?\"}</DialogTitle>\r\n                    <DialogActions>\r\n                        <Button onClick={this.hideDlgDelete}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button onClick={() => this.confirmDelete(index)} autoFocus>\r\n                            Ok\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        measurements: state.measurements,\r\n    }\r\n}\r\n\r\n//export default connect(mapStateToProps, )(MeasureItem)\r\nexport default connect(mapStateToProps)(withStyles(styles)(MeasureItem))\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport MeasureItem from './MeasureItem'\r\n\r\nclass Measurements extends PureComponent {\r\n\r\n  state = { \r\n    visibleClearMeasureDlg: false,\r\n  }\r\n\r\n  showClearMeasureDlg = () => {\r\n    this.setState({ visibleClearMeasureDlg: true })\r\n  }\r\n\r\n  hideClearMeasureDlg = () => {\r\n      this.setState({ visibleClearMeasureDlg: false })\r\n  }\r\n\r\n  confirmClearMeasureDlg = () => {\r\n    this.hideClearMeasureDlg()\r\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('removetools')\r\n  }\r\n\r\n  render() {   \r\n    //const classes = this.props.classes\r\n\r\n    return (\r\n      <div>\r\n\r\n        <div>\r\n          { this.props.measurements !== null ?\r\n              this.props.measurements.map((item, index) => {\r\n                  return <MeasureItem item={item} index={index} toolRemove={this.props.toolRemove} key={index} />\r\n              }) \r\n            : null }\r\n        </div>\r\n        \r\n        <Dialog\r\n            open={this.state.visibleClearMeasureDlg}\r\n            onClose={this.hideClearMeasureDlg}\r\n            aria-labelledby=\"alert-dialog-title\"\r\n        >\r\n            <DialogTitle id=\"alert-dialog-title\">{\"Are you sure to remove all the measurements?\"}</DialogTitle>\r\n            <DialogActions>\r\n                <Button onClick={this.hideClearMeasureDlg}>\r\n                    Cancel\r\n                </Button>\r\n                <Button onClick={this.confirmClearMeasureDlg} autoFocus>\r\n                    Ok\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    measurements: state.measurements,\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Measurements)\r\n","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormLabel from '@material-ui/core/FormLabel'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Radio from '@material-ui/core/Radio'\r\nimport RadioGroup from '@material-ui/core/RadioGroup'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { \r\n  getSettingsSaveAs, \r\n  setSettingsSaveAs, \r\n  getSettingsSaveInto,\r\n  setSettingsSaveInto,\r\n  getSettingsDcmHeader, \r\n  setSettingsDcmHeader, \r\n  getSettingsOverlay, \r\n  setSettingsOverlay,\r\n  getSettingsFsView,\r\n  setSettingsFsView,\r\n  getSettingsDicomdirView,\r\n  setSettingsDicomdirView,\r\n} from '../functions'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  formControl: {\r\n    margin: theme.spacing(3),\r\n  },\r\n  formLabel: {\r\n    fontSize: '0.85em',\r\n  },\r\n  radioControl: {\r\n    size: 'small',\r\n  },  \r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n    fontSize: '0.95em',\r\n  },\r\n}))\r\n\r\n/*const Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"right\" ref={ref} {...props} />;\r\n})*/\r\n\r\nconst Settings = ({ onClose }) => {\r\n  \r\n  let saveAs = getSettingsSaveAs()\r\n  let saveInto = getSettingsSaveInto()\r\n  let exportAs = getSettingsDcmHeader()\r\n  let overlay = getSettingsOverlay()\r\n  let fsView = getSettingsFsView()\r\n  let dicomdirView = getSettingsDicomdirView()\r\n\r\n  //const isIndexedDB = false // 'indexedDB' in window\r\n  \r\n  const handleChangeSaveAs = event => {\r\n    setState({ ...state, 'saveAs': event.target.value })\r\n    setSettingsSaveAs(event.target.value)\r\n  }\r\n  \r\n  const handleChangeSaveInto = event => {\r\n    setState({ ...state, 'saveInto': event.target.value })\r\n    setSettingsSaveInto(event.target.value)\r\n  }\r\n\r\n  const handleChangeExportAs = event => {\r\n    setState({ ...state, 'exportAs': event.target.value })\r\n    setSettingsDcmHeader(event.target.value)\r\n  }\r\n\r\n  const handleChangeOverlay = event => {\r\n    setState({ ...state, 'overlay': event.target.checked })\r\n    setSettingsOverlay(event.target.checked)\r\n  }\r\n\r\n  const handleChangeFsView = event => {\r\n    setState({ ...state, 'fsView': event.target.value })\r\n    setSettingsFsView(event.target.value)\r\n  }\r\n\r\n  const handleChangeDicomdirView = event => {\r\n    setState({ ...state, 'dicomdirView': event.target.value })\r\n    setSettingsDicomdirView(event.target.value)\r\n  }  \r\n\r\n  const classes = useStyles()\r\n\r\n  const [state, setState] = React.useState({\r\n    saveAs: saveAs,\r\n    saveInto: saveInto,\r\n    exportAs: exportAs,\r\n    overlay: overlay,\r\n    fsView: fsView,\r\n    dicomdirView: dicomdirView,\r\n  })\r\n\r\n  return (\r\n    <div>\r\n      <Dialog fullScreen open={true} onClose={onClose}> {/* TransitionComponent={Transition} */}\r\n        <AppBar className={classes.appBar} elevation={0}>\r\n          <Toolbar variant=\"dense\">\r\n            <IconButton edge=\"start\" color=\"inherit\" onClick={onClose} aria-label=\"close\">\r\n              <CloseIcon />\r\n            </IconButton>\r\n            <Typography variant=\"h6\" className={classes.title}>\r\n              Settings\r\n            </Typography>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <div>\r\n          <div>\r\n          <FormControl component=\"fieldset\" className={classes.formControl}>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox \r\n                  checked={state.overlay} \r\n                  onChange={handleChangeOverlay}\r\n                  value=\"overlay\" \r\n                  size='small'\r\n                />\r\n              }\r\n              label=\"Show overlay Information\"\r\n            />\r\n          </FormControl>\r\n          </div>\r\n          <div>\r\n          <FormControl component=\"fieldset\" className={classes.formControl}>\r\n            <FormLabel component=\"legend\" className={classes.formLabel}>Open sandboxed file system from:</FormLabel>\r\n            <RadioGroup size='small' aria-label=\"filesystem\" name=\"filesystem\" value={state.fsView} onChange={handleChangeFsView}>\r\n              <FormControlLabel value=\"left\" control={<Radio size='small' />} label=\"left\" />\r\n              <FormControlLabel value=\"right\" control={<Radio size='small' />} label=\"right\" />\r\n              <FormControlLabel value=\"bottom\" control={<Radio size='small' />} label=\"bottom\" />\r\n            </RadioGroup>\r\n          </FormControl>    \r\n          </div>\r\n          <div>\r\n          <FormControl component=\"fieldset\" className={classes.formControl}>\r\n            <FormLabel component=\"legend\" className={classes.formLabel}>Open DICOMDIR panel from:</FormLabel>\r\n            <RadioGroup size='small' aria-label=\"dicomdir\" name=\"dicomdir\" value={state.dicomdirView} onChange={handleChangeDicomdirView}>\r\n              <FormControlLabel value=\"left\" control={<Radio size='small' />} label=\"left\" />\r\n              <FormControlLabel value=\"right\" control={<Radio size='small' />} label=\"right\" />\r\n              <FormControlLabel value=\"bottom\" control={<Radio size='small' />} label=\"bottom\" />\r\n            </RadioGroup>\r\n          </FormControl>                    \r\n          </div>\r\n          <div>\r\n          <FormControl component=\"fieldset\" className={classes.formControl}>\r\n            <FormLabel component=\"legend\" className={classes.formLabel}>Save screenshot as:</FormLabel>\r\n            <RadioGroup aria-label=\"saveas\" name=\"saveas\" value={state.saveAs} onChange={handleChangeSaveAs}>\r\n              <FormControlLabel value=\"jpeg\" control={<Radio size='small' />} label=\"JPEG\" />\r\n              <FormControlLabel value=\"png\" control={<Radio size='small' />} label=\"PNG\" />\r\n            </RadioGroup>\r\n          </FormControl>\r\n          </div>\r\n          <div>\r\n          <FormControl component=\"fieldset\" className={classes.formControl}>\r\n            <FormLabel component=\"legend\" className={classes.formLabel}>Save screenshot into:</FormLabel>\r\n            <RadioGroup aria-label=\"saveinto\" name=\"saveinto\" value={state.saveInto} onChange={handleChangeSaveInto}>\r\n              <FormControlLabel value=\"local\" control={<Radio size='small' />} label=\"local file system\" />\r\n              <FormControlLabel value=\"sandboxed\" control={<Radio size='small' />} label=\"sandboxed file system\" />\r\n            </RadioGroup>\r\n          </FormControl>          \r\n          </div>\r\n          <div>\r\n          <FormControl component=\"fieldset\" className={classes.formControl}>\r\n            <FormLabel component=\"legend\" className={classes.formLabel}>Export Dicom header as:</FormLabel>\r\n            <RadioGroup aria-label=\"exportas\" name=\"exportas\" value={exportAs} onChange={handleChangeExportAs}>\r\n              <FormControlLabel value=\"json\" control={<Radio size='small' />} label=\"JSON\" />\r\n              <FormControlLabel value=\"csv\" control={<Radio size='small' />} label=\"CSV\" />\r\n            </RadioGroup>\r\n          </FormControl> \r\n          </div>  \r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nexport default Settings\r\n","import React from 'react'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport Link from '@material-ui/core/Link'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport packageJson from '../../package.json'\r\n\r\nconst AboutDlg = ({ onClose }) => {\r\n\r\n    const urlRepository = \"https://github.com/webnamics/u-dicom-viewer/\"\r\n\r\n    const linkRepository = (\r\n        <Typography variant='body2'>\r\n            <Link \r\n                href={urlRepository} \r\n                target='_blank'\r\n                style={{ color: '#999999' }}\r\n            >\r\n                https://github.com/webnamics/u-dicom-viewer\r\n            </Link>\r\n        </Typography>\r\n    )\r\n\r\n    const version = (\r\n        <Typography variant='body2' style={{ color: '#999999' }}>\r\n            {packageJson.version}\r\n        </Typography>        \r\n    )\r\n\r\n    return (\r\n      <div>\r\n        <Dialog onClose={onClose} open={true}>\r\n            <DialogTitle onClose={onClose} disableTypography={true}>\r\n                <Typography variant='h6'>\r\n                    About <strong>U</strong>niversal <strong>D</strong>icom <strong>V</strong>iewer\r\n                </Typography>\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <List>\r\n                    <ListItem>\r\n                        <ListItemText \r\n                            primary='Repository URL:' \r\n                            secondary={linkRepository} \r\n                        />\r\n                    </ListItem>    \r\n                    <ListItem>\r\n                        <ListItemText \r\n                            primary='Version Number:' \r\n                            secondary={version} \r\n                        />\r\n                    </ListItem>                        \r\n                </List>        \r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button autoFocus onClick={onClose}>\r\n                    Close\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default AboutDlg\r\n","import React, { PureComponent } from 'react'\r\n//import Draggable from 'react-draggable'\r\n//import IconButton from '@material-ui/core/IconButton'\r\nimport Slider from '@material-ui/core/Slider'\r\n//import HighlightOffIcon from '@material-ui/icons/HighlightOff'\r\nimport {connect} from 'react-redux'\r\nimport * as cornerstone from 'cornerstone-core'\r\nimport { import as csTools } from 'cornerstone-tools'\r\n\r\nconst getRGBPixels = csTools('util/getRGBPixels')\r\n\r\nconst HIST_WIDTH = 256\r\nconst HIST_HEIGHT = 128\r\nconst N_BINS = 256\r\n\r\nconst style = {\r\n  width: '273px', \r\n  padding: '8px 8px 8px 8px', \r\n  backgroundColor: '#444444',\r\n}\r\n\r\nconst styleSlider = {\r\n  width: '255px',\r\n  marginTop: '-9px',\r\n}\r\n\r\nconst styleCanvasGradient = {\r\n  marginTop: '-9px',\r\n}\r\n\r\nconst styleTable = {\r\n  borderCollapse: 'collapse',\r\n  fontFamily: 'Courier, monospace',\r\n  fontSize: '67%',\r\n  width: '100%',\r\n}\r\n\r\nconst styleTableTd = {\r\n  tableLayout: 'fixed',\r\n  width: '25%',\r\n}\r\n\r\nclass Histogram extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.canvasHistogram = React.createRef()\r\n      this.canvasGradient = React.createRef()\r\n    }\r\n\r\n    state = {\r\n      activeDrags: 0,\r\n      deltaPosition: {\r\n        x: 0, y: 0\r\n      },\r\n      controlledPosition: {\r\n        x: -400, y: 200\r\n      },\r\n      value: 128,\r\n      histCount: 0,\r\n      valueScale: 0,\r\n      minHist: 0,\r\n      maxHist: 0,\r\n      mean: 0,\r\n      stdDev: 0,\r\n    }\r\n\r\n    componentDidMount() {\r\n      //console.log('componentDidMount: ', this.props.activeDcmIndex)\r\n      this.image = this.props.activeDcm.image\r\n      this.element = this.props.activeDcm.element\r\n      this.isDicom = this.props.activeDcm.isDicom\r\n      this.pixelData = this.props.activeDcm.image.getPixelData()\r\n      this.updateCanvas()  \r\n    }\r\n    \r\n    componentDidUpdate() {\r\n      //console.log('componentDidUpdate: ')\r\n      //this.updateCanvas() \r\n    }\r\n\r\n    getMousePos(canvas, evt) {\r\n      const rect = canvas.getBoundingClientRect()\r\n      return {\r\n        x: evt.clientX - rect.left,\r\n        y: evt.clientY - rect.top\r\n      }\r\n    }\r\n\r\n    getRGBPixelsImage(x, y, width, height) {\r\n      //const image = this.props.image\r\n      const storedPixelData = []\r\n      x = Math.round(x)\r\n      y = Math.round(y)   \r\n      let index = 0\r\n      let spIndex, row, column\r\n    \r\n      for (row = 0; row < height; row++) {\r\n        for (column = 0; column < width; column++) {\r\n          spIndex = ((row + y) * this.image.rows + (column + x)) * 4\r\n          const red = this.pixelData[spIndex]\r\n          const green = this.pixelData[spIndex + 1]\r\n          const blue = this.pixelData[spIndex + 2]\r\n          const alpha = this.pixelData[spIndex + 3]\r\n  \r\n          storedPixelData[index++] = red\r\n          storedPixelData[index++] = green\r\n          storedPixelData[index++] = blue\r\n          storedPixelData[index++] = alpha\r\n        }\r\n      }\r\n    \r\n      return storedPixelData\r\n    }\r\n\r\n    getPixel(x, y) {\r\n      //const image = this.props.image\r\n      //const element = this.props.element\r\n      //const isDicom = this.props.isDicom\r\n      let sp = []\r\n      if (this.isDicom) {\r\n        if (this.image.color) {\r\n          sp = getRGBPixels(this.element, x, y, 1, 1)\r\n        } else {\r\n          sp = cornerstone.getStoredPixels(this.element, x, y, 1, 1)\r\n        }\r\n      } else {\r\n        sp = this.getRGBPixelsImage(x, y, 1, 1)\r\n      }\r\n      return sp[0]\r\n    }\r\n\r\n    updateCanvas() {\r\n      const image = this.image\r\n      //const element = this.props.element\r\n      const maxPixelValue = image.maxPixelValue\r\n      const minPixelValue = image.minPixelValue\r\n      //const k = Math.pow(2, this.props.bitsStored)\r\n      const minHist = minPixelValue+image.intercept\r\n      const maxHist = maxPixelValue+image.intercept\r\n      const lenHist = maxHist-minHist+1\r\n      const binSize = lenHist / N_BINS\r\n      let zero256 = Math.floor(Math.abs(minHist) / binSize)\r\n      let stepWW = Math.round(image.windowWidth / binSize / 2)\r\n      let stepWC = Math.round(image.windowCenter / binSize)\r\n\r\n      this.setState({minHist: minHist})\r\n      this.setState({maxHist: maxHist})\r\n      this.binSize = binSize\r\n\r\n      //console.log('bitsStored: ', k)\r\n      //console.log('minHist: ', minHist)\r\n      //console.log('maxHist: ', maxHist)\r\n      //console.log('lenHist: ', lenHist)\r\n      //console.log('binSize: ', binSize)\r\n      //console.log('zeroHist: ', zero256)\r\n      //console.log('stepWW: ', stepWW)\r\n      //console.log('stepWC: ', stepWC)\r\n      //console.log('zero256-stepWW: ', zero256-stepWW)\r\n      //console.log('zero256+stepWW: ', zero256+stepWW)   \r\n      //console.log('image.color: ', image.color)  \r\n      //console.log('isDicom: ', this.isDicom)  \r\n      //console.log('pixelData: ', this.pixelData)\r\n      //console.log('image.columns: ', image.columns)\r\n      //console.log('image.rows: ', image.rows)\r\n\r\n      let m = 0 // the mean\r\n\r\n      // build histogram\r\n      let hist = Array(lenHist).fill(0) \r\n\r\n      for (let y = 0; y < image.columns; y++) {\r\n        for (let x = 0; x < image.rows; x++) {\r\n          let sp = this.getPixel(x, y)\r\n          let mo = sp * image.slope + image.intercept\r\n          hist[mo-minHist] += 1\r\n          m += mo\r\n        } \r\n      }  \r\n\r\n      m = m / (image.columns * image.rows)\r\n      this.setState({mean: m})  \r\n\r\n      //console.log('hist: ', hist)\r\n\r\n      // calculate standard deviation\r\n      let s = 0\r\n      for (let y = 0; y < image.columns; y++)\r\n        for (let x = 0; x < image.rows; x++) {\r\n          let sp = this.getPixel(x, y)\r\n          let mo = sp * image.slope + image.intercept\r\n          s += Math.pow(mo-m, 2)\r\n        }  \r\n      s = Math.sqrt(s / (image.columns * image.rows))\r\n      this.setState({stdDev: s})\r\n\r\n      // binning the histogram \r\n      let hist256 = Array(N_BINS).fill(0) \r\n      let step = 0\r\n      let max = 0\r\n      for (let i=0; i < N_BINS; i++) {\r\n        for (let j=step; j < Math.round(step+binSize); j++) {\r\n          if (j >= lenHist) break\r\n          hist256[i] += hist[j]\r\n        }\r\n        if (max < hist256[i]) { max = hist256[i] }\r\n        step = Math.round(step+binSize)\r\n      }\r\n      this.hist256 = hist256\r\n\r\n      //console.log('hist256: ', hist256)\r\n      //console.log('max: ', max)\r\n      \r\n      const canvasH = this.canvasHistogram.current\r\n      const ctxH = this.canvasHistogram.current.getContext(\"2d\")\r\n      ctxH.translate(0, canvasH.height)\r\n      ctxH.scale(1, -1)\r\n\r\n      canvasH.addEventListener('pointermove', (evt) => {\r\n        const mousePos = this.getMousePos(canvasH, evt)\r\n        this.setState({histCount: hist256[mousePos.x]})\r\n        let p = Math.round(mousePos.x * this.binSize)\r\n        this.setState({valueScale: p+minHist})\r\n      }, true)\r\n\r\n      //console.log('value: ', (m-minHist)/binSize)\r\n      let value = Math.round((m-minHist)/binSize)\r\n      this.setState({value: value})\r\n      this.setState({valueScale: m})\r\n      this.setState({histCount: hist256[value]})\r\n\r\n      // draw WindowWidth area\r\n      ctxH.beginPath()\r\n      ctxH.fillStyle = 'rgba(210, 210, 210, 0.5)'\r\n      ctxH.fillRect(zero256-stepWW+stepWC, 0, stepWW*2, HIST_HEIGHT)\r\n\r\n      // draw histogram\r\n      ctxH.beginPath()\r\n      ctxH.strokeStyle = 'rgba(0, 0, 0, 1.0)'\r\n      for (let i = 0; i < N_BINS; i++) {\r\n        let h = Math.round((hist256[i]/max)*HIST_HEIGHT)\r\n        ctxH.moveTo(i, 0)\r\n        ctxH.lineTo(i, h)\r\n        ctxH.stroke()\r\n      }\r\n      \r\n      // draw WindowCenter cursor\r\n      ctxH.beginPath()\r\n      ctxH.strokeStyle = 'rgba(140, 140, 140, 0.5)'\r\n      ctxH.moveTo(zero256+stepWC, 0)\r\n      ctxH.lineTo(zero256+stepWC, HIST_HEIGHT)\r\n      ctxH.lineWidth = 1\r\n      ctxH.stroke()\r\n          \r\n      let lowX = zero256-stepWW+stepWC\r\n      let highX = zero256+stepWW+stepWC\r\n\r\n      // draw gradient scale\r\n      const canvasG = this.canvasGradient.current\r\n      const ctxG = canvasG.getContext(\"2d\")\r\n\r\n      ctxG.fillStyle = \"#000000\"\r\n      ctxG.fillRect(0, 0, lowX, 10)\r\n\r\n      let grd = ctxG.createLinearGradient(lowX, 0, highX+(lowX < 0 ? lowX : 0), 0)\r\n      grd.addColorStop(0, \"black\")\r\n      grd.addColorStop(1, \"white\")\r\n      ctxG.fillStyle = grd\r\n      ctxG.fillRect(lowX, 0, highX, 10)\r\n    }\r\n        \r\n    handleChangeValue = (event, newValue) => {\r\n      //console.log('newValue: ', newValue)\r\n      //console.log('(newValue*this.binSize)+this.state.minHist: ', (newValue*this.binSize)+this.state.minHist)\r\n      //console.log('this.hist256[newValue]: ', this.hist256[newValue])\r\n      this.setState({value: newValue})\r\n      this.setState({valueScale: (newValue*this.binSize)+this.state.minHist})\r\n      this.setState({histCount: this.hist256[newValue]})\r\n    }\r\n      \r\n    hide = () => {\r\n      this.props.onClose()\r\n    }\r\n\r\n    onDrag = (e, ui) => {\r\n      const {x, y} = this.state.deltaPosition;\r\n      this.setState({\r\n        deltaPosition: {\r\n          x: x + ui.deltaX,\r\n          y: y + ui.deltaY,\r\n        }\r\n      })\r\n    }\r\n  \r\n    onStart = () => {\r\n      this.setState({activeDrags: this.state.activeDrags+1})\r\n    }\r\n  \r\n    onStop = () => {\r\n      this.setState({activeDrags: this.state.activeDrags-1})\r\n    }\r\n\r\n    render() {  \r\n      return (\r\n        <div style={style}>\r\n          <div>\r\n            <canvas \r\n              ref={this.canvasHistogram} \r\n              width={HIST_WIDTH} \r\n              height={HIST_HEIGHT} \r\n              style={{backgroundColor: \"#FFFFFF\", cursor:'crosshair'}} \r\n            />\r\n          </div>  \r\n          <div style={styleCanvasGradient}>\r\n            <canvas ref={this.canvasGradient} width={HIST_WIDTH} height={10} style={{backgroundColor: \"#FFFFFF\"}} />\r\n          </div>\r\n          <div style={styleSlider}>\r\n            <Slider\r\n              value={this.state.value}\r\n              onChange={this.handleChangeValue}\r\n              aria-labelledby=\"continuous-slider\"\r\n              color=\"secondary\"\r\n              min={0}\r\n              max={255}\r\n            />\r\n          </div>\r\n          <div>\r\n            <table style={styleTable}>\r\n              <tbody>\r\n                <tr>\r\n                  <td style={styleTableTd}>min:</td>\r\n                  <td style={styleTableTd}>{this.state.minHist}</td>\r\n                  <td style={styleTableTd}>max:</td>\r\n                  <td style={styleTableTd}>{this.state.maxHist}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>mean:</td>\r\n                  <td>{parseFloat(this.state.mean).toFixed(3)}</td>\r\n                  <td>std dev:</td>\r\n                  <td>{parseFloat(this.state.stdDev).toFixed(3)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>count:</td>\r\n                  <td>{this.state.histCount}</td>\r\n                  <td>value:</td>\r\n                  <td>{parseFloat(this.state.valueScale).toFixed(3)}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n      </div>\r\n      )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    activeDcmIndex: state.activeDcmIndex,\r\n    activeDcm: state.activeDcm,\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Histogram)\r\n","import React, { PureComponent } from 'react'\r\n\r\nconst styleTable = {\r\n  borderCollapse: 'collapse',\r\n  width: '100px',\r\n  height: '100px',\r\n}\r\n\r\nconst styleTableTd = {\r\n  width: '25px',\r\n  height: '25px',\r\n  border: 'solid 1px black',\r\n}\r\n\r\nclass LayoutTool extends PureComponent {\r\n    constructor(props) {\r\n      super(props)\r\n      this.tableRef = React.createRef()\r\n      this.state = {\r\n        row: this.props.row,\r\n        col: this.props.col,\r\n      }\r\n    }\r\n\r\n    componentDidMount() {\r\n      this.initTable()\r\n    }\r\n\r\n    initTable = () => {\r\n      let row = this.state.row\r\n      let col = this.state.col\r\n      let rows = this.tableRef.current.rows\r\n      for (let i=0; i <= row; i++) {\r\n        for(let j=0; j <= col; j++) {\r\n          rows[i].cells[j].bgColor = '#AAAAAA'\r\n        }\r\n      }\r\n    }\r\n\r\n    cellClick = (e) => {\r\n      let row = e.target.parentNode.rowIndex\r\n      let col = e.target.cellIndex\r\n\r\n      this.setState({row: row, col: col})\r\n\r\n      let rows = this.tableRef.current.rows\r\n      for (let i=0; i <= 3; i++) {\r\n        for(let j=0; j <= 3; j++) {\r\n          rows[i].cells[j].bgColor = '#444444'\r\n        }\r\n      }\r\n      for (let i=0; i <= row; i++) {\r\n        for(let j=0; j <= col; j++) {\r\n          rows[i].cells[j].bgColor = '#AAAAAA'\r\n        }\r\n      }\r\n      this.props.onChange(row+1, col+1)\r\n    }\r\n\r\n    renderTable() {\r\n      const rows = ['', '', '', '']\r\n      return (\r\n        rows.map((row, i) => {\r\n          return (\r\n            <tr key={`${i}`}>\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n               <td style={styleTableTd} onClick={this.cellClick} />\r\n            </tr>\r\n          )\r\n        })\r\n      )\r\n   }\r\n\r\n    render() {  \r\n      return (\r\n          <div>            \r\n            <table style={styleTable} ref={this.tableRef}>\r\n              <tbody>\r\n                {this.renderTable()}                   \r\n              </tbody>\r\n            </table>\r\n          </div>     \r\n      )\r\n    }\r\n\r\n}\r\n\r\nexport default LayoutTool\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogContentText from '@material-ui/core/DialogContentText'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport Icon from '@mdi/react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableContainer from '@material-ui/core/TableContainer'\r\nimport TableHead from '@material-ui/core/TableHead'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport JSZip from 'jszip'\r\nimport { saveAs } from 'file-saver'\r\nimport fs from '../fs/fs'\r\nimport {\r\n    getFileExt,\r\n    getFileExtReal,\r\n    getFileName,\r\n    formatBytes,\r\n    getSettingsFsView,\r\n    getFileNameCorrect,\r\n} from '../functions'\r\nimport {\r\n    //setFsCurrentId,\r\n    setFsCurrentDir,\r\n    setFsCurrentList,\r\n    setZippedFile,\r\n    sandboxedfileStore,\r\n} from '../actions'\r\nimport {\r\n    mdiCheck,\r\n    mdiChevronLeft,\r\n    mdiClose,\r\n    mdiContentCopy,\r\n    mdiContentCut,\r\n    mdiContentPaste,\r\n    mdiContentSaveOutline,\r\n    mdiDeleteOutline,\r\n    mdiDotsHorizontal,\r\n    mdiExportVariant,    \r\n    mdiFolderPlusOutline,\r\n    mdiSquareEditOutline,\r\n} from '@mdi/js'\r\n\r\nconst styles = theme => ({\r\n    table: {\r\n        minWidth: 250,\r\n    },\r\n    toolbarButtons: {\r\n        marginLeft: 'auto',\r\n        marginRight: -20,\r\n    },\r\n    leftButtons: {\r\n        marginLeft: -25,\r\n    },\r\n    textPaper: {\r\n        padding: '2px 4px',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        width: 250,\r\n    },\r\n    textInput: {\r\n        marginLeft: theme.spacing(1),\r\n        flex: 1,\r\n    },\r\n    textButton: {\r\n        padding: 10,\r\n    },\r\n})\r\n\r\nclass FsUI extends PureComponent {\r\n    constructor(props) {\r\n        super(props)\r\n        this.cut = false\r\n        this.saveAsField = React.createRef()\r\n      }\r\n\r\n    state = {\r\n        textFieldLabel: '',\r\n        textFieldValue: '',\r\n        selected: [],\r\n        selectedCopy: [],\r\n        visibleTextField: false,\r\n        visibleDeleteDlg: false,\r\n        visibleImportExport: false,\r\n        visibleAlreadyExistDlg: false,\r\n        visibleOSaveAsDlg: false,\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.fsListDir(this.props.fsCurrentDir)\r\n    }\r\n\r\n    componentDidUpdate(previousProps) {\r\n        //console.log('componentDidUpdate: ', this.props)\r\n        if (this.props.fsZippedFile !== null) {\r\n            const zip = new JSZip()\r\n            zip.loadAsync(this.props.fsZippedFile).then((contents) => {\r\n                //console.log('zip file contents: ', contents)\r\n                contents.forEach((relativePath, zipEntry) => {\r\n                    //console.log('zipEntry: ', zipEntry)\r\n                    if (zipEntry.dir) { \r\n                        //console.log('dir relativePath: ', relativePath)\r\n                    } else {                  \r\n                        //console.log('file relativePath: ', relativePath)\r\n                        zip.file(relativePath).async('uint8array').then((content) => {\r\n                            this.fsAddItem(relativePath, content)\r\n                        })\r\n                    }\r\n                })\r\n            }).then(() => {\r\n                this.props.setFsZippedFile(null)\r\n                //this.fsListDir(this.props.fsCurrentDir)\r\n            })\r\n        } else {\r\n            this.fsListDir(this.props.fsCurrentDir)\r\n        }\r\n    }\r\n\r\n    fsBuildParent(parent, name) {\r\n        let newParent = ''\r\n        if (parent === '') {\r\n            if (name !== '') \r\n                newParent = name\r\n        } else {\r\n            if (name !== '') \r\n                newParent = `${parent}/${name}` \r\n            else\r\n                newParent = parent\r\n        }\r\n        return newParent\r\n    }\r\n\r\n    fsAddItem(filename, data) {\r\n        //console.log('fsAddItem filename: ', filename)\r\n        //console.log('fsAddItem data: ', data)\r\n        let components = filename.split('/')\r\n        const name = components.pop()\r\n        const parent = this.fsBuildParent(this.props.fsCurrentDir, components.join('/'))\r\n        //console.log(`add file, parent: ${parent}, name: ${name}`)\r\n        fs.transaction('rw', fs.files, async () => {\r\n            await fs.files.add({\r\n                parent: parent,\r\n                name: name,\r\n                type: getFileExt(name),\r\n                size: data.length,\r\n                data: data\r\n            })             \r\n        }).then(() => {\r\n            // store subdirectory\r\n            while (components.length > 0) {\r\n                const name = components.pop()\r\n                const parent = this.fsBuildParent(this.props.fsCurrentDir, components.join('/'))\r\n                //console.log(`put dir, parent: ${parent}, name: ${name}`)\r\n                fs.transaction('rw', fs.files, async () => {\r\n                    await fs.files.put({\r\n                        parent: parent,\r\n                        name: name,\r\n                        type: 'dir',\r\n                        size: '' \r\n                    }) \r\n                }).then(() => {\r\n                    this.fsListDir(this.props.fsCurrentDir)\r\n                })\r\n            }            \r\n        })\r\n    }\r\n\r\n    fsExistDir(dir, create = true) {\r\n        const item = this.props.fsCurrentList.find(e => e.name === dir)\r\n        if (item !== undefined) {\r\n            if (create) {\r\n                this.fsCreateDir(this.props.fsCurrentDir, dir)\r\n                return true\r\n            } else return false\r\n        } else return false\r\n    }\r\n\r\n    fsListDir(dir) {\r\n        //console.log('fsListDir: ', dir)\r\n        let listItems = []\r\n        fs.transaction('r', fs.files, async ()=> {\r\n            await fs.files.where({parent: dir, type: 'dir'}).sortBy('name').then((list) => { // first list all dirs\r\n                listItems = list\r\n            }).then(() => { // after list all files\r\n                fs.files.where({parent: dir}).and(item => item.type !== 'dir').sortBy('name').then((list) => {\r\n                    listItems = listItems.concat(list)\r\n                    this.props.setCurrentList(listItems)\r\n                })\r\n            })\r\n        })\r\n    }\r\n\r\n    fsCreateDir(parent, name) {\r\n        fs.files.add({parent: parent, name: name, type: 'dir', size: ''}).then(() => { \r\n            this.fsListDir(this.props.fsCurrentDir)\r\n        })\r\n    }\r\n\r\n    createDir = () => {\r\n        this.setState({textFieldLabel: 'new folder name', visibleTextField: !this.state.visibleTextField})\r\n    }\r\n\r\n    renameItem = () => {\r\n        this.lastSelected = this.state.selected[this.state.selected.length-1]\r\n        this.setState({textFieldLabel: '', textFieldValue: this.lastSelected, visibleTextField: !this.state.visibleTextField})\r\n    }\r\n\r\n    previousDir = () => {\r\n        //console.log('this.state.parentDir: ', this.state.parentDir)\r\n        if (this.props.fsCurrentDir === '') return\r\n        const nextDir = this.props.fsCurrentDir.split('/').slice(0, -1).join('/')\r\n        this.props.setCurrentDir(nextDir)\r\n        this.fsListDir(nextDir)\r\n    }\r\n\r\n    confirmText = (e) => {\r\n        if (this.state.textFieldLabel === '') { // it's a rename\r\n            // check if the new name already exist\r\n            const check = this.props.fsCurrentList.find(e => e.name === this.state.textFieldValue)\r\n            if (check !== undefined) {\r\n                this.setState({visibleAlreadyExistDlg: true})\r\n                return\r\n            }\r\n            const item = this.props.fsCurrentList.find(e => e.name === this.lastSelected)\r\n            if (item !== undefined) {\r\n                if (item.type === 'dir') {\r\n                    const oldParent = this.fsBuildParent(item.parent, item.name)\r\n                    const newParent = this.fsBuildParent(item.parent, this.state.textFieldValue)\r\n                    // rename parent for all subitems\r\n                    fs.transaction('rw', fs.files, async ()=> {\r\n                        await fs.files.where({parent: oldParent}).each((e) => {\r\n                            fs.transaction('rw', fs.files, async () => { // since is a new primary key then add it as new item \r\n                                await fs.files.add({\r\n                                parent: newParent,\r\n                                name: e.name,\r\n                                type: e.type,\r\n                                size: e.size,\r\n                                data: e.data\r\n                                }).then(() => { // then delete old one\r\n                                    fs.files.where({parent: oldParent}).delete()\r\n                                })\r\n                            })\r\n                        })\r\n                    })\r\n                } \r\n                fs.transaction('rw', fs.files, async () => { // a new primary key, add it as new item \r\n                    await fs.files.add({\r\n                      parent: item.parent,\r\n                      name: this.state.textFieldValue,\r\n                      type: item.type,\r\n                      size: item.size,\r\n                      data: item.data\r\n                    }).then(() => { // then delete old one\r\n                        fs.files.where({parent: item.parent, name: item.name}).delete()\r\n                    })\r\n                })\r\n                this.setState({visibleTextField: false})\r\n                this.fsListDir(this.props.fsCurrentDir)                \r\n            }\r\n        } else { // it's a new directory\r\n            this.setState({visibleTextField: false}, () => {\r\n                this.fsCreateDir(this.props.fsCurrentDir, this.state.textFieldValue)\r\n            })\r\n        }\r\n    }\r\n\r\n    cancelDir = () => {\r\n         this.setState({visibleTextField: false})\r\n    }\r\n\r\n    saveItem = () => {\r\n        //console.log('this.props.localfileStore: ', this.props.localfileStore)\r\n        //console.log('this.props.sandboxedFile: ', this.props.sandboxedFile)\r\n        if (this.props.localfileStore !== null) {\r\n            const file = this.props.localfileStore\r\n            if (file === null) return\r\n            let reader = new FileReader()\r\n            reader.onload = (event) => {\r\n                let buffer = event.target.result\r\n                const ext = getFileExtReal(file.name)\r\n                const name = getFileName(getFileNameCorrect(file.name))   \r\n                let newName = name\r\n                let counter = 0\r\n                let done = false             \r\n                do {\r\n                    let filename = ext === '' ? newName : `${newName}.${ext}`\r\n                    const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                    if (checkName === undefined) {\r\n                        fs.transaction('rw', fs.files, async () => {\r\n                            await fs.files.add({\r\n                                parent: this.props.fsCurrentDir,\r\n                                name: filename,\r\n                                type: getFileExt(name),\r\n                                size: file.size,\r\n                                data: buffer\r\n                            })\r\n                        }).then(() => {\r\n                            this.fsListDir(this.props.fsCurrentDir)\r\n                        })\r\n                        done = true\r\n                    } else {\r\n                        newName = `${name} - Copy`\r\n                        if (counter > 0) newName = `${newName} (${counter})`\r\n                        counter++\r\n                    }\r\n                } while (!done)\r\n            }\r\n            reader.readAsArrayBuffer(file)\r\n        } else if (this.props.sandboxedFile !== null) {\r\n            const file = this.props.sandboxedFile\r\n            let buffer = file.data\r\n            const ext = getFileExtReal(file.name)\r\n            const name = getFileName(getFileNameCorrect(file.name))   \r\n            let newName = name\r\n            let counter = 0\r\n            let done = false             \r\n            do {\r\n                let filename = ext === '' ? newName : `${newName}.${ext}`\r\n                const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                if (checkName === undefined) {\r\n                    fs.transaction('rw', fs.files, async () => {\r\n                        await fs.files.add({\r\n                            parent: this.props.fsCurrentDir,\r\n                            name: filename,\r\n                            type: getFileExt(name),\r\n                            size: file.size,\r\n                            data: buffer\r\n                        })\r\n                    }).then(() => {\r\n                        this.fsListDir(this.props.fsCurrentDir)\r\n                    })\r\n                    done = true\r\n                } else {\r\n                    newName = `${name} - Copy`\r\n                    if (counter > 0) newName = `${newName} (${counter})`\r\n                    counter++\r\n                }\r\n            } while (!done)           \r\n        }\r\n    }\r\n\r\n    copyItem = () => {\r\n        let newSelectedCopy = []\r\n        this.state.selected.forEach(name => {\r\n            const item = this.props.fsCurrentList.find(e => e.name === name)\r\n            if (item !== undefined) {\r\n                newSelectedCopy.push({parent: item.parent, name: item.name})\r\n            }\r\n        })\r\n        this.setState({selectedCopy: newSelectedCopy})\r\n    }\r\n\r\n    cutItem = () => {\r\n        let newSelectedCopy = []\r\n        this.state.selected.forEach(name => {\r\n            let item = this.props.fsCurrentList.find(e => e.name === name)\r\n            if (item !== undefined) {\r\n                newSelectedCopy.push({parent: item.parent, name: item.name})\r\n            }\r\n        })\r\n        this.setState({selectedCopy: newSelectedCopy})\r\n        this.cut = true\r\n    }\r\n\r\n    pasteItem = () => {\r\n        //console.log('this.state.selectedCopy: ', this.state.selectedCopy)\r\n        //console.log('this.props.fsCurrentList: ', this.props.fsCurrentList)\r\n        this.state.selectedCopy.forEach(async (selected, index) => {\r\n            await fs.files.where({parent: selected.parent, name: selected.name}).first((item) => {\r\n                if (item !== undefined) {\r\n                    //console.log('item: ', item)\r\n                    if (item.type === 'dir') {\r\n                        // create a new name\r\n                        let counter = 0\r\n                        let done = false\r\n                        let newName = item.name\r\n                        do {\r\n                            let filename = newName\r\n                            const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                            if (checkName === undefined) {\r\n                                done = true\r\n                            } else {\r\n                                newName = `${item.name} - Copy`\r\n                                if (counter > 0) newName = `${newName} (${counter})`\r\n                                counter++\r\n                            }\r\n                        } while (!done)   \r\n                        //console.log('this.props.fsCurrentDir: ', this.props.fsCurrentDir)\r\n                        //console.log('newName: ', newName)\r\n                        // copy the folder\r\n                        fs.files.add({\r\n                            parent: this.props.fsCurrentDir,\r\n                            name: newName,\r\n                            type: item.type,\r\n                            size: item.size,\r\n                            data: item.data\r\n                        })   \r\n                        // copy all subdirs and files\r\n                        const oldParent = this.fsBuildParent(item.parent, item.name) \r\n                        const newParent = this.fsBuildParent(this.props.fsCurrentDir, newName) \r\n                        //console.log('oldParent: ', oldParent)\r\n                        //console.log('newParent: ', newParent)\r\n                        let listItems = []\r\n                        fs.files.where('parent').startsWithIgnoreCase(oldParent).each((e) => {\r\n                            listItems.push(e)\r\n                        }).then(() => {\r\n                            listItems.forEach(e => {\r\n                                //console.log('listItems e: ', e)\r\n                                //const parent = e.parent.replace(oldParent, newParent)\r\n                                //console.log('parent: ', parent)\r\n                                fs.files.add({\r\n                                    parent: newParent,\r\n                                    name: e.name,\r\n                                    type: e.type,\r\n                                    size: e.size,\r\n                                    data: e.data\r\n                                })                          \r\n                            })                            \r\n                        })\r\n                    } else { // it's a file\r\n                        const ext = getFileExtReal(item.name)\r\n                        const name = getFileName(item.name)    \r\n                        let newName = name\r\n                        let counter = 0\r\n                        let done = false             \r\n                        do {\r\n                            let filename = ext === '' ? newName : `${newName}.${ext}`\r\n                            const checkName = this.props.fsCurrentList.find(e => e.name === filename)\r\n                            if (checkName === undefined) {\r\n                                fs.transaction('rw', fs.files, async () => {\r\n                                    await fs.files.add({\r\n                                        parent: this.props.fsCurrentDir,\r\n                                        name: filename,\r\n                                        type: item.type,\r\n                                        size: item.size,\r\n                                        data: item.data\r\n                                    })\r\n                                })\r\n                                done = true\r\n                            } else {\r\n                                newName = `${name} - Copy`\r\n                                if (counter > 0) newName = `${newName} (${counter})`\r\n                                counter++\r\n                            }\r\n                        } while (!done)\r\n                    }\r\n                }\r\n            })\r\n            if (index === this.state.selectedCopy.length-1) {\r\n                if (this.cut) {\r\n                    this.state.selectedCopy.forEach((selected) => {\r\n                        fs.files.where({parent: selected.parent, name: selected.name}).delete()\r\n                    })\r\n                    this.setState({selectedCopy: []})\r\n                    this.cut = false                    \r\n                }\r\n                this.fsListDir(this.props.fsCurrentDir)\r\n            }\r\n        })\r\n        this.setState({selected: []})\r\n    }\r\n\r\n    deleteItem = () => {\r\n        this.state.selected.forEach(name => {\r\n            let item = this.props.fsCurrentList.find(e => e.name === name)\r\n            if (item !== undefined) {\r\n                if (item.type === 'dir') { // delete also all subitems\r\n                    fs.files.where('parent').startsWithIgnoreCase(this.fsBuildParent(item.parent, item.name)).delete()\r\n                }\r\n                fs.files.where({parent: item.parent, name: item.name}).delete().then(() => {\r\n                    this.fsListDir(this.props.fsCurrentDir)\r\n                })\r\n            }\r\n        })\r\n        this.setState({selected: []}) \r\n    }\r\n\r\n    showImportExport = () => {\r\n        this.setState({visibleImportExport: !this.state.visibleImportExport})\r\n    }\r\n\r\n    exportItem = () => {\r\n        if (this.state.selected.length === 0) return\r\n        this.setState({visibleOSaveAsDlg: true})\r\n    }\r\n\r\n    itemClick = (e, row) => {\r\n        //console.log('itemClick: ', row.name)\r\n        const selectedIndex = this.state.selected.indexOf(row.name)\r\n        //console.log('selectedIndex: ', selectedIndex)\r\n        let newSelected = []\r\n        if (selectedIndex === -1) {\r\n            newSelected = newSelected.concat(this.state.selected, row.name)\r\n        } else if (selectedIndex >= 0) {\r\n            newSelected = newSelected.concat(\r\n                this.state.selected.slice(0, selectedIndex),\r\n                this.state.selected.slice(selectedIndex + 1),\r\n            )\r\n        }\r\n        this.setState({selected: newSelected}, () => {\r\n        //    console.log('this.state.selected: ', this.state.selected)\r\n        })\r\n    }\r\n\r\n    itemDoubleClick = (e, item) => {\r\n        //console.log('itemDoubleClick: ', item.name)\r\n        if (item.type === 'dir') {\r\n            this.props.setCurrentDir(this.fsBuildParent(item.parent, item.name))\r\n        } else if (item.name === 'DICOMDIR') {\r\n            this.props.onOpenDicomdir(item)\r\n        } else {\r\n            this.props.setSandboxedfileStore(item)\r\n            this.props.onOpen(item)\r\n        }\r\n    }\r\n\r\n    showDeleteDlg = () => {\r\n        this.setState({ visibleDeleteDlg: true })\r\n      }\r\n    \r\n    hideDeleteDlg = () => {\r\n        this.setState({ visibleDeleteDlg: false })\r\n    }\r\n\r\n    confirmDeleteDlg = () => {\r\n        this.hideDeleteDlg()\r\n        this.deleteItem()\r\n    }\r\n\r\n    hideAlreadyExistDlg = () => {\r\n        this.setState({ visibleAlreadyExistDlg: false })\r\n    }  \r\n\r\n    hideSaveAs = () => {\r\n        this.setState({ visibleOSaveAsDlg: false })\r\n    }\r\n\r\n    closeSaveAs = () => {\r\n        const filename = `${this.saveAsField.value}.zip`\r\n        this.setState({ visibleOSaveAsDlg: false },\r\n            () => {\r\n            let zip = new JSZip()\r\n            let listItems = []\r\n            fs.files.where('parent').startsWithIgnoreCase(this.props.fsCurrentDir).each((e) => {\r\n                listItems.push(e)\r\n            }).then(() => {\r\n                listItems.forEach((e) => {\r\n                    if (e.type !== 'dir') {\r\n                        zip.folder(e.parent).file(e.name, e.data)\r\n                    }\r\n                })\r\n                zip.generateAsync({type:\"blob\"}).then(blob => {\r\n                    saveAs(blob, filename)\r\n                })\r\n            })\r\n        })\r\n    }    \r\n\r\n    mouseDown = (e, item) => {\r\n        this.timer = setTimeout(() => { \r\n            this.itemDoubleClick(e, item)\r\n        }, 500)\r\n    }\r\n\r\n    mouseUp = (e) => {\r\n        clearTimeout(this.timer)\r\n    }\r\n\r\n    render() {   \r\n        const { classes } = this.props\r\n        const isSelected = name => this.state.selected.indexOf(name) !== -1\r\n        const visibleTextField = this.state.visibleTextField\r\n        const visibleImportExport = this.state.visibleImportExport\r\n        const visibleDeleteDlg = this.state.visibleDeleteDlg\r\n        const visibleAlreadyExistDlg = this.state.visibleAlreadyExistDlg\r\n        const visibleOSaveAsDlg = this.state.visibleOSaveAsDlg\r\n\r\n        let styleComponent = null\r\n        if (getSettingsFsView() === 'bottom') {\r\n            styleComponent = {marginTop: '0px', height: '275px'}\r\n        } else {\r\n            styleComponent = {marginTop: '48px', width: '350px'}\r\n        }\r\n\r\n        return (\r\n            <div style={styleComponent}>\r\n                { visibleTextField ? \r\n                    <Paper component=\"form\" className={classes.textPaper}>\r\n                        <InputBase\r\n                            autoFocus\r\n                            className={classes.textInput}\r\n                            placeholder={this.state.textFieldLabel}\r\n                            defaultValue={this.state.textFieldValue}\r\n                            onChange={(event) => {\r\n                                this.setState({textFieldValue: event.target.value})\r\n                            }}\r\n                        />\r\n                        <IconButton className={classes.textButton} onClick={this.confirmText}>\r\n                            <Icon path={mdiCheck} size={'1.2rem'} color={this.props.color} />\r\n                        </IconButton>\r\n                        <IconButton className={classes.textButton} onClick={this.cancelDir}>\r\n                            <Icon path={mdiClose} size={'1.2rem'} color={this.props.color} />\r\n                        </IconButton>                        \r\n                    </Paper>\r\n                  : \r\n                    <div>\r\n                        <Toolbar variant=\"dense\">\r\n                            <div className={classes.leftButtons}>\r\n                                <IconButton color=\"inherit\" onClick={this.previousDir} >\r\n                                    <Icon path={mdiChevronLeft} size={'1.2rem'} color={this.props.color} />\r\n                                </IconButton>                            \r\n                            </div>\r\n                            <div className={classes.toolbarButtons}>\r\n                                <Tooltip title=\"Create a new directory\">\r\n                                    <IconButton color=\"inherit\" onClick={this.createDir}>\r\n                                        <Icon path={mdiFolderPlusOutline} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton>\r\n                                </Tooltip>\r\n                                <Tooltip title=\"Rename the last selected item\">\r\n                                    <IconButton color=\"inherit\" onClick={this.renameItem}>\r\n                                        <Icon path={mdiSquareEditOutline} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton> \r\n                                </Tooltip>\r\n                                <Tooltip title=\"Move the selected items to the clipboard\">                          \r\n                                    <IconButton color=\"inherit\" onClick={this.cutItem}>\r\n                                        <Icon path={mdiContentCut} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton> \r\n                                </Tooltip>  \r\n                                <Tooltip title=\"Copy the selected items to the clipboard\">\r\n                                    <IconButton color=\"inherit\" onClick={this.copyItem}>\r\n                                        <Icon path={mdiContentCopy} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton>\r\n                                </Tooltip>\r\n                                <Tooltip title=\"Paste clipboard contents to current location\">                             \r\n                                    <IconButton color=\"inherit\" onClick={this.pasteItem}>\r\n                                        <Icon path={mdiContentPaste} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton>   \r\n                                </Tooltip>  \r\n                                <Tooltip title=\"Delete the selected items\">    \r\n                                    <IconButton color=\"inherit\" onClick={this.showDeleteDlg}>\r\n                                        <Icon path={mdiDeleteOutline} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton>  \r\n                                </Tooltip>\r\n                                <IconButton color=\"inherit\" onClick={this.showImportExport}>\r\n                                    <Icon path={mdiDotsHorizontal} size={'1.2rem'} color={this.props.color} />\r\n                                </IconButton>                           \r\n                            </div>            \r\n                        </Toolbar>\r\n                        { visibleImportExport ?\r\n                            <Toolbar variant=\"dense\">\r\n                                <div className={classes.toolbarButtons}>\r\n                                    <Tooltip title=\"Save the selected image to sandboxed file system\"> \r\n                                        <IconButton color=\"inherit\" onClick={this.saveItem}>\r\n                                            <Icon path={mdiContentSaveOutline} size={'1.2rem'} color={this.props.color} />\r\n                                        </IconButton>      \r\n                                    </Tooltip>\r\n                                    <Tooltip title=\"Export the selected items as zipped archive\">\r\n                                        <IconButton color=\"inherit\" onClick={this.exportItem}>\r\n                                            <Icon path={mdiExportVariant} size={'1.2rem'} color={this.props.color} />\r\n                                        </IconButton>   \r\n                                    </Tooltip>     \r\n                                    {/*<IconButton color=\"inherit\" onClick={this.downloadItem}>\r\n                                        <Icon path={mdiDownload} size={'1.2rem'} color={this.props.color} />\r\n                                    </IconButton>*/}                                     \r\n                                </div>            \r\n                            </Toolbar>\r\n                        : null\r\n                        }\r\n                    </div>\r\n                }\r\n                <div>\r\n                    <TableContainer component={Paper}>\r\n                        <Table className={classes.table} size=\"small\">\r\n                            <TableHead>\r\n                                <TableRow>\r\n                                    <TableCell>Name</TableCell>\r\n                                    <TableCell align=\"left\">Type</TableCell>\r\n                                    <TableCell align=\"left\">Size</TableCell>\r\n                                </TableRow>\r\n                            </TableHead>\r\n                            <TableBody>\r\n                            {this.props.fsCurrentList.map((row) => {\r\n                                const isItemSelected = isSelected(row.name)\r\n                                return (\r\n                                    <TableRow \r\n                                        key={`${row.parent}/${row.name}`} \r\n                                        role='button' \r\n                                        hover\r\n                                        selected={isItemSelected}\r\n                                        onClick={(e) => {this.itemClick(e, row)}}\r\n                                        onDoubleClick={(e) => {this.itemDoubleClick(e, row)}}\r\n                                        onTouchStart={(e) => this.mouseDown(e, row)} \r\n                                        onTouchEnd={(e) => this.mouseUp(e, row)}\r\n                                        onMouseDown={(e) => this.mouseDown(e, row)} \r\n                                        onMouseUp={(e) => this.mouseUp(e, row)}\r\n                                    >\r\n                                        <TableCell component=\"th\" scope=\"row\">\r\n                                            {row.name}\r\n                                        </TableCell>\r\n                                        <TableCell align=\"left\">{row.type}</TableCell>\r\n                                        <TableCell align=\"left\">{formatBytes(row.size)}</TableCell>\r\n                                    </TableRow>\r\n                                )\r\n                            })}\r\n                            </TableBody>\r\n                        </Table>\r\n                    </TableContainer>\r\n                </div>   \r\n\r\n                <Dialog\r\n                    open={visibleDeleteDlg}\r\n                    onClose={this.hideDeleteDlg}\r\n                >\r\n                    <DialogTitle>{\"Are you sure to delete selected items?\"}</DialogTitle>\r\n                    <DialogActions>\r\n                        <Button onClick={this.hideDeleteDlg}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button onClick={this.confirmDeleteDlg} autoFocus>\r\n                            Ok\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>    \r\n\r\n                <Dialog\r\n                    open={visibleAlreadyExistDlg}\r\n                    onClose={this.hideAlreadyExistDlg}\r\n                >\r\n                    <DialogTitle>{\"An item with this name already exists!\"}</DialogTitle>\r\n                    <DialogActions>\r\n                        <Button onClick={this.hideAlreadyExistDlg} autoFocus>\r\n                            Ok\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>    \r\n\r\n                <Dialog\r\n                    open={visibleOSaveAsDlg}\r\n                >\r\n                    <DialogTitle>Export archive</DialogTitle>\r\n                    <DialogContent>\r\n                        <DialogContentText>\r\n                            Specify a file name for the archive:\r\n                        </DialogContentText>\r\n                        <TextField\r\n                            autoFocus\r\n                            margin=\"dense\"\r\n                            id=\"id-open-url\"\r\n                            inputRef={input => (this.saveAsField = input)}\r\n                            fullWidth\r\n                        />\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={() => this.hideSaveAs()} >\r\n                            Cancel\r\n                        </Button>\r\n                        <Button onClick={() => this.closeSaveAs()}>\r\n                            Ok\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>                              \r\n            </div>\r\n        )\r\n    }              \r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      localfileStore: state.localfile,\r\n      fsCurrentDir: state.fsCurrentDir,\r\n      fsCurrentList: state.fsCurrentList,\r\n      fsZippedFile: state.fsZippedFile,\r\n      fsRefresh: state.fsRefresh,\r\n      sandboxedFile: state.sandboxedFile,\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        setCurrentDir: (dir) => dispatch(setFsCurrentDir(dir)),\r\n        setCurrentList: (list) => dispatch(setFsCurrentList(list)),\r\n        setFsZippedFile: (file) => dispatch(setZippedFile(file)),\r\n        setSandboxedfileStore: (file) => dispatch(sandboxedfileStore(file)),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(FsUI))\r\n","import React, { PureComponent } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport axios from 'axios'\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport {\r\n  setZippedFile,\r\n} from '../actions/index'\r\n\r\nconst CancelToken = axios.CancelToken\r\nconst source = CancelToken.source()\r\n\r\nclass DownloadZipDlg extends PureComponent {\r\n\r\n  state = {\r\n    loading: 0\r\n  }\r\n\r\n  componentDidMount(previousProps) {\r\n    this.requestDownloadZip()\r\n  }\r\n\r\n  hide = () => {\r\n    this.props.onClose()\r\n  }\r\n\r\n  cancel = () => {\r\n    source.cancel('Operation canceled by the user.')\r\n    this.hide()\r\n  }\r\n\r\n  requestDownloadZip = () => {\r\n    console.log('this.props.url', this.props.url)\r\n    this.setState({loading: 0})\r\n    axios({\r\n      method: 'get',\r\n      url: this.props.url,\r\n      responseType: 'arraybuffer',\r\n      cancelToken: source.token,\r\n      onDownloadProgress: (progressEvent) => {\r\n        const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n        this.setState({ loading: percentCompleted })\r\n        console.log('loading: ', percentCompleted)\r\n      },\r\n    }).then((response) => {\r\n        console.log('response: ', response)\r\n        this.props.setFsZippedFile(response.data)\r\n        this.hide()\r\n    }).catch((error) => {\r\n      console.log('error: ', error)\r\n    })\r\n  }\r\n  \r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Dialog\r\n            open={true}\r\n            onClose={this.hide}\r\n        >\r\n            <DialogTitle>{\"Downloading zip archive...\"}</DialogTitle>\r\n            <DialogContent>\r\n              <LinearProgress variant=\"determinate\" value={this.state.loading} color='secondary' />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={this.cancel}>\r\n                    Cancel\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setFsZippedFile: (file) => dispatch(setZippedFile(file))\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(DownloadZipDlg)\r\n","import React, { PureComponent } from 'react'\nimport { withStyles } from '@material-ui/core/styles'\nimport {connect} from 'react-redux'\n//import axios from 'axios'\nimport Dicomdir from './components/Dicomdir'\nimport DicomViewer from './components/dicomviewer'\nimport DicomHeader from './components/DicomHeader'\nimport Measurements from './components/Measurements'\nimport Settings from './components/Settings'\nimport AboutDlg from './components/AboutDlg'\nimport Histogram from './components/Histogram'\nimport LayoutTool from './components/LayoutTool'\nimport FsUI from './components/FsUI'\nimport DownloadZipDlg from './components/DownloadZipDlg'\nimport AppBar from '@material-ui/core/AppBar'\nimport Collapse from '@material-ui/core/Collapse'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Divider from '@material-ui/core/Divider'\nimport Drawer from '@material-ui/core/Drawer'\nimport ExpandLess from '@material-ui/icons/ExpandLess'\nimport ExpandMore from '@material-ui/icons/ExpandMore'\nimport Icon from '@mdi/react'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport Popover from '@material-ui/core/Popover'\nimport TextField from '@material-ui/core/TextField'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Typography from '@material-ui/core/Typography'\nimport { \n  isMobile, \n  isTablet,\n} from 'react-device-detect'\nimport {\n  localfileStore,\n  dcmIsOpen,\n  activeDcm,\n  activeDcmIndex,\n  activeMeasurements,\n  setLayout,\n  dcmTool, \n  setDicomdir,\n  setZippedFile,\n} from './actions/index'\nimport { \n  log,\n  getFileNameCorrect,\n  getFileExtReal,\n  isInputDirSupported,\n  getSettingsFsView,\n  getSettingsDicomdirView,\n} from './functions'\nimport { \n  mdiAngleAcute,\n  mdiArrowAll,\n  mdiCamera,\n  mdiChartHistogram,\n  mdiCheckboxIntermediate,\n  mdiContentSaveOutline,   \n  mdiCursorDefault, \n  mdiCursorPointer,\n  mdiDelete,\n  mdiEllipse,\n  mdiEyedropper,\n  mdiFileCabinet,\n  mdiFileDocument, \n  mdiFileCad, \n  mdiFolder,\n  mdiGesture,\n  mdiViewGridPlusOutline,\n  mdiImageEdit,\n  mdiInformationOutline,\n  mdiInvertColors,\n  mdiMagnify,\n  mdiFolderOpen,\n  mdiRefresh,\n  mdiRectangle,\n  mdiRuler,\n  mdiSettings,\n  mdiToolbox,\n  mdiTrashCanOutline, \n  mdiVideo,\n  mdiWeb,\n} from '@mdi/js'\n\nimport './App.css'\n\nlog()\n\n//localStorage.setItem(\"debug\", \"cornerstoneTools\")\n\nconst drawerWidth = 240\nconst iconColor = '#FFFFFF'\nlet iconTool = null\n\nconst styles = theme => ({\n  '@global': {\n    body: {\n        backgroundColor: theme.palette.common.black,\n    },\n  },\n\n  grow: {\n    flexGrow: 1,\n  },\n\n  root: {\n    display: 'flex',\n  },\n\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n\n  title: {\n    flexGrow: 1,\n  },\n\n  appBar: {\n    position: 'relative',\n    zIndex: theme.zIndex.drawer + 1,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n  },\n\n  appBarShift: {\n    marginLeft: drawerWidth,\n    width: `calc(100% - ${drawerWidth}px)`,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n\n  hide: {\n    display: 'none',\n  },\n\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n    whiteSpace: 'nowrap',\n  },\n\n  drawerOpen: {\n    width: drawerWidth,\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n\n  drawerClose: {\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n    overflowX: 'hidden',\n    width: theme.spacing(7) + 1,\n    [theme.breakpoints.up('sm')]: {\n      width: theme.spacing(9) + 1,\n    },\n  },\n\n  // Loads information about the app bar, including app bar height\n  toolbar: theme.mixins.toolbar,\n\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(3),\n  },\n\n  listItemText: {\n    fontSize: '0.85em',\n    marginLeft: '-20px'\n  },\n\n})\n\nclass App extends PureComponent {\n\n  constructor(props) {\n    super(props)\n    this.file = null\n    this.url = null\n\n    this.fileOpen = React.createRef()\n    this.showFileOpen = this.showFileOpen.bind(this)\n\n    this.openDicomdir = React.createRef()\n    this.showOpenDicomdir = this.showOpenDicomdir.bind(this)\n    \n    this.openUrlField = React.createRef()\n    \n    this.dicomViewersRefs = []\n    this.dicomViewers = []\n    for(let i=0; i < 16; i++) {\n      this.dicomViewers.push(this.setDcmViewer(i))\n    }\n  }\n\n  /*menuListSetting = [\n    {\n      key: 'overlay',\n      primaryText: 'Overlay information',\n      onClick: () => {\n        console.log('menu setting overlay ')\n      },\n    }, {\n      key: 'saveas',\n      primaryText: 'Save screenshot as ...',\n      onClick: () => {\n        console.log('menu setting saveas ')\n      },\n    },\n  ]*/\n\n  state = { \n    anchorElLayout: null,    \n    openImageEdit: false,\n    visibleMainMenu: true,\n    visibleHeader: false,\n    visibleSettings: false,\n    visibleToolbar: true,\n    visibleOpenUrl: false,\n    visibleToolbox: false,\n    visibleMeasure: false,\n    visibleClearMeasureDlg: false,\n    visibleAbout: false,\n    visibleDicomdir: false,\n    visibleFileManager: false,\n    visibleZippedFileDlg: false,\n    visibleDownloadZipDlg: false,\n    toolState: 1,\n    //loading: 0,\n  }\n\n  setDcmViewer = (index) => {\n    return (\n      <DicomViewer \n        dcmRef={(ref) => {this.dicomViewersRefs[index] = ref}}\n        index={index}\n        runTool={ref => (this.runTool = ref)} \n        changeTool={ref => (this.changeTool = ref)} \n      />   \n    )\n  }\n\n  getDcmViewerRef = (index) => {\n    return this.dicomViewersRefs[index]\n  }\n\n  getDcmViewer = (index) => {\n    return this.dicomViewers[index]\n  }\n\n  getActiveDcmViewer = () => {\n    return this.dicomViewersRefs[this.props.activeDcmIndex]\n  }  \n  \n  toggleFileManager = () => {\n    if (getSettingsFsView() === 'left') {\n      this.setState({visibleMainMenu: false, visibleFileManager: !this.state.visibleFileManager})\n    } else {\n      this.setState({visibleFileManager: !this.state.visibleFileManager})\n    }\n  }\n  \n  showFileOpen() {\n    this.props.isOpenStore(false)\n    this.fileOpen.current.click()\n  }\n\n  handleOpenFile = (filesSelected) => {\n    //this.hideMainMenu()\n    const file = filesSelected[0]\n    console.log('file: ', file)\n    if (file.type === 'application/x-zip-compressed') {\n      //this.props.setFsZippedFile(file)\n      /*const zip = new JSZip()\n      zip.loadAsync(file).then((contents) => {\n        Object.keys(contents.files).forEach((filename) => {\n            console.log('zip file: ', filename)\n            zip.file(filename).async('nodebuffer').then((content) => {\n              console.log('zip content: ', content)\n            })\n        })\n      })*/\n      this.file = file\n      this.url = null\n      this.setState({visibleZippedFileDlg: true})\n    } else {\n      this.props.setLocalfileStore(file)\n      this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n      this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openfile', file)      \n    }\n  }\n\n  handleOpenFs = (fsItem) => {\n    this.hideMainMenu()\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openfs', fsItem)\n  }\n\n  handleOpenFileDicomdir = (file) => {\n    this.hideMainMenu()\n    this.props.setLocalfileStore(file)\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openfile', file)\n  }\n\n  showOpenDicomdir() {\n    this.openDicomdir.current.click()\n  }\n\n  handleOpenDicomdir(files) {\n    this.setState({ visibleDicomdir: false }, () => {\n      let dicomdir = null\n      let datafiles = []\n      for (let i=0; i < files.length; i++) {\n        if (files[i].webkitRelativePath.includes('DICOMDIR')) {\n          dicomdir = files[i]\n        } else {\n          datafiles.push(files[i])\n        }\n      }\n      if (dicomdir !== null) {\n        this.props.setDicomdirStore({origin: 'local', dicomdir: dicomdir, files: datafiles})\n        this.toggleDicomdir()\n      }\n    })\n  }\n\n  handleOpenFsDicomdir = (fsItem) => {\n    this.props.setDicomdirStore({origin: 'fs', dicomdir: fsItem, files: []})\n    this.toggleDicomdir()\n  }\n\n  componentDidMount() {\n    // Need to set the renderNode since the drawer uses an overlay\n    //this.dialog = document.getElementById('drawer-routing-example-dialog')\n    window.scrollTo(0, 0)\n  }\n\n\n  showAppBar = () => {\n    window.scrollTo(0, 0)\n  }\n  \n\n  toggleMainMenu = () => {\n    const visibleMainMenu = this.state.visibleMainMenu\n    //const visibleFileManager = this.state.visibleFileManager\n    if (getSettingsFsView() === 'left') {\n      this.setState({ visibleMainMenu: !visibleMainMenu, visibleFileManager: false })\n    } else {\n      this.setState({ visibleMainMenu: !visibleMainMenu })\n    }\n  }\n  \n  showMainMenu = () => {\n    this.setState({ visibleMainMenu: true })\n  }\n\n  hideMainMenu = () => {\n    this.setState({ visibleMainMenu: false })\n  }\n\n  handleVisibility = (visibleMainMenu) => {\n    this.setState({ visibleMainMenu })\n  }\n\n\n  toggleHeader = () => {\n    const visible = !this.state.visibleHeader\n    this.setState({ visibleHeader: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleToolbox: false, \n        visibleDicomdir: false, \n        visibleFileManager: false \n      })    \n  }\n\n\n  toggleToolbox = () => {\n    const visible = !this.state.visibleToolbox\n    this.setState({ visibleToolbox: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleHeader: false, \n        visibleDicomdir: false, \n        visibleFileManager: false \n      })\n  }\n\n  saveMeasure = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('savetools')\n  }\n  \n  toggleMeasure = () => {\n    const visible = !this.state.visibleMeasure\n    this.setState({ visibleMeasure: visible })\n    if (visible) \n      this.setState({ \n        visibleToolbox: false, \n        visibleHeader: false, \n        visibleDicomdir: false, \n        visibleFileManager: false \n      })\n  }\n\n  hideMeasure = () => {\n    this.setState({ visibleMeasure: false })\n  }\n\n  handleVisibilityMeasure = (visibleMeasure) => {\n    this.setState({ visibleMeasure })\n  }\n\n\n  toggleDicomdir = () => {\n    const visible = !this.state.visibleDicomdir\n    console.log('toggleDicomdir: ', visible)\n    this.setState({ visibleDicomdir: visible })\n    if (visible) \n      this.setState({ \n        visibleMeasure: false, \n        visibleToolbox: false, \n        visibleHeader: false, \n        visibleFileManager: false\n      })\n  }\n  \n\n  clearMeasure = () => {\n    this.showClearMeasureDlg()\n  }\n\n  showClearMeasureDlg = () => {\n    this.setState({ visibleClearMeasureDlg: true })\n  }\n\n  hideClearMeasureDlg = () => {\n      this.setState({ visibleClearMeasureDlg: false })\n  }\n\n  confirmClearMeasureDlg = () => {\n    this.hideClearMeasureDlg()\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('removetools')\n  }\n\n\n  showZippedFileDlg = () => {\n    this.setState({ visibleZippedFileDlg: true })\n  }  \n\n  hideZippedFileDlg = () => {\n      this.setState({ visibleZippedFileDlg: false })\n  }\n\n  confirmZippedFileDlg = () => {\n    this.hideZippedFileDlg()\n    this.setState({ visibleFileManager: true }, () => {\n      console.log('this.url: ', this.url)\n      if (this.url !== null) {\n        this.setState({visibleDownloadZipDlg: true})\n      } else {\n        this.props.setFsZippedFile(this.file)\n      }\n    })\n  }\n\n\n  showAbout = () => {\n    this.setState({ visibleAbout: !this.state.visibleAbout })\n  }\n  \n  showSettings = () => {\n    this.setState({ \n      visibleMainMenu: false, \n      visibleSettings: true, \n      visibleToolbar: false, \n      position: 'right' \n    })\n  }\n\n  hideSettings = () => {\n    this.setState({ \n      visibleMainMenu: true, \n      visibleSettings: false, \n      visibleToolbar: true,\n      visibleFileManager: false,\n      visibleDicomdir: false, \n    })\n  }\n\n  handleVisibilitySettings = (visibleSettings) => {\n    this.setState({ visibleSettings });\n  }\n\n  hideDownloadZipDlg = () => {\n    this.setState({ visibleDownloadZipDlg: false })\n  }\n\n  showOpenUrl = () => {\n    this.setState({ visibleOpenUrl: true })\n  }\n\n  hideOpenUrl = (openDlg) => {\n    this.setState({ visibleOpenUrl: false },\n      () => {\n        if (openDlg) {\n          this.hideMainMenu()\n          this.file = null\n          this.url = this.openUrlField.value\n          //console.log('this.url :', this.url)\n          //const ext = getFileExtReal(this.url)\n          //console.log('ext :', ext)\n          if (getFileExtReal(this.url) === 'zip') {\n            this.setState({visibleZippedFileDlg: true})\n          } else {\n            return this.dicomViewersRefs[this.props.activeDcmIndex].runTool('openurl', this.openUrlField.value)\n          }\n        } \n    })\n  }\n\n  downloadOpenUrl = () => {\n    this.setState({ visibleOpenUrl: false, visibleToolbar: true })\n  }\n  \n  resetImage = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('reset')\n  }\n  \n  saveShot = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('saveas')\n  }\n\n  cinePlayer = () => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('cine')\n  }\n\n  clear = () => {  \n    this.setState({openImageEdit: false, visibleToolbox: false, visibleMeasure: false, visibleHeader: false, visibleDicomdir: false})\n    this.props.setDicomdirStore(null)\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('clear')\n  }\n\n  handleLayout = (event) => {\n    this.setState({anchorElLayout: event.currentTarget})\n  }\n  \n  closeLayout = () => {\n    this.setState({anchorElLayout: null})\n  }\n\n  changeLayout = (row, col) => {\n    // if reduce the grid clear the unused views\n    if (row < this.props.layout[0] || col < this.props.layout[1]) {\n      this.layoutGridClick(0)\n      for(let i=0; i < 4; i++) {\n        for(let j=0; j < 4; j++) {\n          if ((i+1 > row) || (j+1 > col)) {\n            const index = i*4+j\n            if (this.dicomViewersRefs[index] !== undefined) {  \n              this.dicomViewersRefs[index].runTool('clear')\n             }\n          }\n        }\n      }\n    }\n    this.props.setLayoutStore(row, col)\n  }\n\n  toolExecute = (tool) => {\n    this.hideMainMenu()\n    switch (tool) {\n      case 'notool': \n        iconTool = null\n        this.setState({toolState: null})\n        break\n      case 'Wwwc':\n        iconTool = mdiArrowAll\n        break\n      case 'Pan':\n        iconTool = mdiCursorPointer\n        break        \n      case 'Zoom':\n        iconTool = mdiMagnify\n        break        \n      case 'Length':\n        iconTool = mdiRuler\n        break       \n      case 'Probe':\n        iconTool = mdiEyedropper\n        break    \n      case 'Angle':\n        iconTool = mdiAngleAcute\n        break   \n      case 'EllipticalRoi':\n        iconTool = mdiEllipse\n        break     \n      case 'RectangleRoi':\n        iconTool = mdiRectangle\n        break\n      case 'FreehandRoi':\n        iconTool = mdiGesture\n        break       \n\n      default:\n          break     \n    }\n    this.props.toolStore(tool)\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool(tool)\n  }\n\n  toolChange = () => {\n    const toolState = 1-this.state.toolState\n    this.setState({toolState: toolState}, () => {\n      this.changeTool.changeTool(this.props.tool, toolState)\n    })\n  }\n\n  toolRemove = (index) => {\n    this.dicomViewersRefs[this.props.activeDcmIndex].runTool('removetool', index)\n  }\n\n  toggleImageEdit = () => {\n    this.setState({openImageEdit: !this.state.openImageEdit})\n  }\n \n  layoutGridClick = (index) => {\n    if (isMobile && index === this.props.activeDcmIndex) return\n    //console.log('layoutGridClick: ', index)    \n    this.props.setActiveDcmIndex(index)\n    const dcmViewer = this.getDcmViewerRef(index)\n    this.props.setActiveMeasurements(dcmViewer.measurements)\n    this.props.setActiveDcm({image: dcmViewer.image, element: dcmViewer.dicomImage, isDicom: dcmViewer.isDicom})\n  }\n \n  layoutGridTouch = (index) => {\n    if (!isMobile && index === this.props.activeDcmIndex) return\n    //console.log('layoutGridTouch: ', index)\n    this.props.setActiveDcmIndex(index)\n    const dcmViewer = this.getDcmViewerRef(index)\n    this.props.setActiveMeasurements(dcmViewer.measurements)\n    this.props.setActiveDcm({image: dcmViewer.image, element: dcmViewer.dicomImage, isDicom: dcmViewer.isDicom})   \n  }\n\n  buildLayoutGrid = () => {\n    let dicomviewers = []\n    for(let i=0; i < this.props.layout[0]; i++) {\n      for(let j=0; j < this.props.layout[1]; j++) {\n        const styleLayoutGrid = {\n          border: this.props.layout[0] === 1 && this.props.layout[1] === 1 ? 'solid 1px #000000' : 'solid 1px #444444',\n        }\n        const index = i*4+j\n        dicomviewers.push(\n          <div \n            key={index} \n            style={styleLayoutGrid} \n            onClick={() => this.layoutGridClick(index)} \n            onTouchStart={() => this.layoutGridTouch(index)}\n          >\n            {this.getDcmViewer(index)}\n          </div>        \n        )\n      }\n    }\n\n    return (\n      <div\n        id=\"dicomviewer-grid\"\n        style={{\n          display: 'grid',\n          gridTemplateRows: `repeat(${this.props.layout[0]}, ${100 / this.props.layout[0]}%)`,\n          gridTemplateColumns: `repeat(${this.props.layout[1]}, ${100 / this.props.layout[1]}%)`,\n          height: '100%',\n          width: '100%',\n        }}\n      >\n        {dicomviewers}\n      </div>\n    )\n  }\n\n  getFileName = (dcmViewer) => {\n    if (dcmViewer.fsItem !== null) {\n      return dcmViewer.fsItem.name\n    } else if (dcmViewer.localfile !== null) {\n      return getFileNameCorrect(dcmViewer.localfile.name)\n    } else {\n      return dcmViewer.localurl.substring(dcmViewer.localurl.lastIndexOf('/')+1)\n    }\n  }\n\n  appBarTitle = (classes, isOpen, dcmViewer) => {\n    if (isMobile && !isTablet) {\n      if (isOpen) \n        return null\n      else \n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            <strong>U</strong>niversal <strong>D</strong>icom <strong>V</strong>iewer\n          </Typography>          \n        )\n    } else {\n      if (isOpen) \n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            {this.getFileName(dcmViewer)}\n          </Typography>\n        )\n      else if (this.props.dicomdir !== null) {\n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            {this.props.dicomdir.dicomdir.webkitRelativePath}\n          </Typography>\n        )\n      } else\n        return (\n          <Typography variant=\"overline\" className={classes.title}>\n            <strong>U</strong>niversal <strong>D</strong>icom <strong>V</strong>iewer\n          </Typography>\n        )\n    }\n  }\n\n  render() {\n    //console.log('App render: ')\n\n    const { classes } = this.props\n\n    const primaryClass = {primary:classes.listItemText}\n    const iconSize = '1.2rem'\n    \n    const isOpen = this.props.isOpen[this.props.activeDcmIndex]\n    const isDicomdir = this.props.dicomdir !== null\n\n    const openImageEdit = this.state.openImageEdit\n    const visibleMainMenu = this.state.visibleMainMenu\n    const visibleHeader = this.state.visibleHeader\n    const visibleSettings = this.state.visibleSettings\n    const visibleAbout = this.state.visibleAbout\n    const visibleMeasure = this.state.visibleMeasure\n    const visibleToolbox = this.state.visibleToolbox\n    const visibleDicomdir = this.state.visibleDicomdir\n    const visibleFileManager = this.state.visibleFileManager\n    const visibleClearMeasureDlg = this.state.visibleClearMeasureDlg\n    const visibleZippedFileDlg = this.state.visibleZippedFileDlg \n    const visibleDownloadZipDlg = this.state.visibleDownloadZipDlg\n    const visibleLayout = Boolean(this.state.anchorElLayout)\n\n    let iconToolColor = this.state.toolState === 1 ? '#FFFFFF' : '#999999'\n\n    const dcmViewer = this.getActiveDcmViewer()\n\n    //console.log('this.dicomViewersRefs: ', this.dicomViewersRefs)\n\n    return (\n      <div>\n        <AppBar className={classes.appBar} position='static' elevation={0}>\n          <Toolbar variant=\"dense\">\n            <IconButton edge=\"start\" className={classes.menuButton} color=\"inherit\" aria-label=\"menu\" onClick={this.toggleMainMenu}>\n              <MenuIcon />\n            </IconButton>\n            { this.appBarTitle(classes, isOpen, dcmViewer) }\n            \n            <div className={classes.grow} />\n            { !isOpen && !isDicomdir ? (\n              <IconButton onClick={this.showAbout}>\n                <Icon path={mdiInformationOutline} size={iconSize} color={iconColor} />\n              </IconButton> \n             ) : null\n            }            \n            { iconTool !== null && this.props.tool !== null &&  isOpen ? (\n                <IconButton onClick={this.toolChange}>\n                  <Icon path={iconTool} size={iconSize} color={iconToolColor} />\n                </IconButton>\n              ) : null\n            }\n            { isOpen && dcmViewer.numberOfFrames > 1 &&  isOpen ? (\n                <IconButton onClick={this.cinePlayer}>\n                  <Icon path={mdiVideo} size={iconSize} color={iconColor} />\n                </IconButton> \n              ): null\n            }\n            { isOpen ? (\n              <IconButton onClick={this.resetImage}>\n                <Icon path={mdiRefresh} size={iconSize} color={iconColor} />\n              </IconButton>\n             ) : null\n            }\n            { isOpen ? (\n              <IconButton color=\"inherit\" onClick={this.saveShot}>\n                <Icon path={mdiCamera} size={iconSize} color={iconColor} />\n              </IconButton>\n             ) : null\n            }\n            { isOpen ? (\n              <IconButton color=\"inherit\" onClick={this.toggleToolbox}>\n                <Icon path={mdiToolbox} size={iconSize} color={iconColor} />\n              </IconButton>\n              ) : null\n            }              \n            { isOpen ? (\n              <IconButton color=\"inherit\" onClick={this.toggleMeasure}>\n                <Icon path={mdiFileCad} size={iconSize} color={iconColor} />\n              </IconButton>\n              ) : null\n            }  \n            { isOpen && dcmViewer.isDicom ? (\n              <IconButton color=\"inherit\" onClick={this.toggleHeader}>\n                <Icon path={mdiFileDocument} size={iconSize} color={iconColor} />\n              </IconButton>\n              ) : null\n            }  \n            { isDicomdir ? (\n              <IconButton color=\"inherit\" onClick={this.toggleDicomdir}>\n                <Icon path={mdiFolderOpen} size={iconSize} color={iconColor} />\n              </IconButton>\n              ) : null\n            }    \n            { isOpen ? (\n              <IconButton color=\"inherit\" onClick={this.toggleFileManager}>\n                <Icon path={mdiFileCabinet} size={iconSize} color={iconColor} />\n              </IconButton>\n              ) : null\n            }                        \n          </Toolbar>\n        </AppBar>\n\n        <Drawer \n          variant=\"persistent\"\n          open={visibleMainMenu} \n          style={{position:'relative', zIndex: 1}}\n          onClose={this.toggleMainMenu}\n        >\n          <div className={classes.toolbar}>\n            <List dense={true}>\n              <ListItem button onClick={() => this.showAppBar()}>\n                <ListItemIcon><MenuIcon /></ListItemIcon>\n                <ListItemText primary='Tool Bar' />\n              </ListItem>    \n              <ListItem button onClick={() => this.toggleFileManager()}>\n                <ListItemIcon><Icon path={mdiFileCabinet} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='File Manager ...' />\n              </ListItem>                        \n              <ListItem button onClick={() => this.showFileOpen()}>\n                <ListItemIcon><Icon path={mdiFolder} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Open File ...' />\n              </ListItem>\n              <ListItem button onClick={() => this.showOpenUrl()}>\n                <ListItemIcon><Icon path={mdiWeb} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Open URL ...' />\n              </ListItem>\n              { isInputDirSupported() && !isMobile?\n              <ListItem button onClick={() => this.showOpenDicomdir()}>\n                <ListItemIcon><Icon path={mdiFolderOpen} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Open DICOMDIR ...' />\n              </ListItem>    \n              : null }\n              <ListItem button onClick={() => this.clear()}>\n                <ListItemIcon><Icon path={mdiDelete} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Clear' />\n              </ListItem>  \n              <ListItem button onClick={this.handleLayout}>\n                <ListItemIcon><Icon path={mdiViewGridPlusOutline} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Layout' />              \n              </ListItem>   \n              <ListItem button onClick={() => this.showSettings()}>\n                <ListItemIcon><Icon path={mdiSettings} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Settings' />\n              </ListItem>                \n              <Divider />\n              <ListItem button onClick={() => this.toolExecute('notool')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiCursorDefault} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='No tool' />\n              </ListItem>         \n              <ListItem button onClick={() => this.toolExecute('Wwwc')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiArrowAll} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='WW/WC' />\n              </ListItem>  \n              <ListItem button onClick={() => this.toolExecute('Pan')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiCursorPointer} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Pan' />\n              </ListItem>  \n              <ListItem button onClick={() => this.toolExecute('Zoom')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiMagnify} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Zoom' />\n              </ListItem>      \n              <ListItem button onClick={() => this.toolExecute('Magnify')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiCheckboxIntermediate} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Magnify' />\n              </ListItem>       \n              <ListItem button onClick={() => this.toolExecute('Length')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiRuler} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Length' />\n              </ListItem>        \n              <ListItem button onClick={() => this.toolExecute('Probe')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiEyedropper} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Probe' />\n              </ListItem> \n              <ListItem button onClick={() => this.toolExecute('Angle')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiAngleAcute} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Angle' />\n              </ListItem>  \n              <ListItem button onClick={() => this.toolExecute('EllipticalRoi')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiEllipse} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Elliptical Roi' />\n              </ListItem>     \n              <ListItem button onClick={() => this.toolExecute('RectangleRoi')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiRectangle} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Rectangle Roi' />\n              </ListItem> \n              <ListItem button onClick={() => this.toolExecute('FreehandRoi')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiGesture} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Freehand Roi' />\n              </ListItem> \n              <ListItem button onClick={() => this.toolExecute('Histogram')} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiChartHistogram} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Histogram' />\n              </ListItem>  \n              <ListItem button onClick={() => this.toggleImageEdit()} disabled={!isOpen}>\n                <ListItemIcon><Icon path={mdiImageEdit} size={iconSize} color={iconColor} /></ListItemIcon>\n                <ListItemText classes={primaryClass} primary='Edit' />\n                {openImageEdit ? <ExpandLess /> : <ExpandMore />}\n              </ListItem>          \n              <Collapse in={openImageEdit} timeout=\"auto\" unmountOnExit>\n                <List  dense={true} component=\"div\">\n                  <ListItem button style={{paddingLeft: 30}} onClick={() => this.toolExecute('Invert')}>\n                    <ListItemIcon><Icon path={mdiInvertColors} size={iconSize} color={iconColor} /></ListItemIcon>\n                    <ListItemText classes={primaryClass} primary=\"Invert\" />\n                  </ListItem>\n                </List>\n              </Collapse>\n            </List>\n          </div>\n        </Drawer>       \n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleHeader}\n          onClose={this.toggleHeader}\n        >\n          { visibleHeader ? <DicomHeader dcmViewer={dcmViewer} classes={classes} color={iconColor} /> : null } \n        </Drawer>\n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleMeasure}\n          onClose={this.toggleMeasure}\n        >\n          <div style={{marginTop: '48px'}}>\n            <Toolbar variant=\"dense\">\n              <Typography variant=\"subtitle1\" className={classes.title}>\n                Measurements&nbsp;&nbsp;\n              </Typography>\n              <div className={classes.grow} />\n              <IconButton color=\"inherit\" onClick={this.saveMeasure} edge=\"end\">\n                <Icon path={mdiContentSaveOutline} size={iconSize} color={iconColor} />\n              </IconButton>\n              <IconButton color=\"inherit\" onClick={this.clearMeasure} edge=\"end\">\n                <Icon path={mdiTrashCanOutline} size={iconSize} color={iconColor} />\n              </IconButton>\n            </Toolbar>\n            <div>  \n              { isOpen ? <Measurements dcmViewer={dcmViewer} toolRemove={this.toolRemove} classes={classes} /> : null } \n            </div>\n          </div>\n        </Drawer>  \n\n        <Drawer\n          variant=\"persistent\"\n          anchor='right'\n          open={visibleToolbox}\n          onClose={this.toggleToolbox}\n        >\n          <div style={{marginTop: '48px'}}>\n            <div>  \n              { isOpen ? <Histogram key={this.getFileName(dcmViewer)} /> : null } \n            </div>\n          </div>\n        </Drawer>          \n\n        <Drawer\n          variant=\"persistent\"\n          anchor={getSettingsDicomdirView()}\n          open={visibleDicomdir}\n          onClose={this.toggleDicomdir}\n        >\n          <div>\n            <div>  \n              {visibleDicomdir ? <Dicomdir onOpenFile={this.handleOpenFileDicomdir} onOpenFs={this.handleOpenFs} /> : null} \n            </div>\n          </div>\n        </Drawer>   \n\n        <Drawer\n          variant=\"persistent\"\n          anchor={getSettingsFsView()}\n          open={visibleFileManager}\n          onClose={this.toggleFileManager}\n        >\n          <div>\n            <div>\n              {visibleFileManager ? <FsUI onOpen={this.handleOpenFs} onOpenDicomdir={this.handleOpenFsDicomdir} color={iconColor} /> : null}\n            </div>\n          </div>\n        </Drawer>   \n\n        {visibleSettings ? <Settings onClose={this.hideSettings}/> : null}\n\n        {visibleAbout ? <AboutDlg onClose={this.showAbout}/> : null}\n\n        {visibleDownloadZipDlg ? <DownloadZipDlg onClose={this.hideDownloadZipDlg} url={this.url} /> : null}\n\n        <Dialog\n            open={visibleClearMeasureDlg}\n            onClose={this.hideClearMeasureDlg}\n        >\n            <DialogTitle>{\"Are you sure to remove all the measurements?\"}</DialogTitle>\n            <DialogActions>\n                <Button onClick={this.hideClearMeasureDlg}>\n                    Cancel\n                </Button>\n                <Button onClick={this.confirmClearMeasureDlg} autoFocus>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Dialog\n            open={visibleZippedFileDlg}\n            onClose={this.hideZippedFileDlg}\n        >\n            <DialogTitle>{\"This is a zipped file, would you import into sandboxed file system?\"}</DialogTitle>\n            <DialogActions>\n                <Button onClick={this.hideZippedFileDlg}>\n                    Cancel\n                </Button>\n                <Button onClick={this.confirmZippedFileDlg} autoFocus>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Dialog\n            open={this.state.visibleOpenUrl}\n            aria-labelledby=\"form-dialog-title\"\n        >\n            <DialogTitle id=\"form-dialog-title\">{\"Open URL\"}</DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"alert-dialog-description\">\n                  Insert an URL to download a DICOM or image file:\n                </DialogContentText>\n                <TextField\n                    autoFocus\n                    margin=\"dense\"\n                    id=\"id-open-url\"\n                    inputRef={input => (this.openUrlField = input)}\n                    fullWidth\n                />\n              </DialogContent>\n            <DialogActions>\n                <Button onClick={() => this.hideOpenUrl(false)} >\n                    Cancel\n                </Button>\n                <Button onClick={() => this.hideOpenUrl(true)} autoFocus>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n\n        <Popover\n          id={'id-layout'}\n          open={visibleLayout}\n          anchorEl={this.state.anchorElLayout}\n          onClose={this.closeLayout}\n          anchorOrigin={{\n            vertical: 'center',\n            horizontal: 'right',\n          }}\n          transformOrigin={{\n            vertical: 'center',\n            horizontal: 'left',\n          }}\n        >\n          <LayoutTool \n            row={this.props.layout[0]-1} \n            col={this.props.layout[1]-1}\n            onChange={this.changeLayout}\n          />  \n        </Popover>        \n\n        <div style={{height: 'calc(100vh - 48px)'}}>\n          {this.buildLayoutGrid()}  \n        </div>\n\n        <div>\n          <input\n            type=\"file\"\n            id=\"file_open\"\n            style={{ display: \"none\" }}\n            ref={this.fileOpen}\n            onChange={e => this.handleOpenFile(e.target.files)}\n          />\n        </div>\n\n        <div>\n          <input\n            type=\"file\"\n            id=\"file_dicomdir\"\n            style={{ display: \"none\" }}\n            ref={this.openDicomdir}\n            onChange={e => this.handleOpenDicomdir(e.target.files)}\n            webkitdirectory=\"\" mozdirectory=\"\" directory=\"\" multiple\n          />\n        </div>\n    \n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    localfileStore: state.localfileStore,\n    isOpen: state.isOpen,\n    tool: state.tool,\n    activeDcmIndex: state.activeDcmIndex,\n    measurements: state.measurements,\n    layout: state.layout,\n    dicomdir: state.dicomdir,\n    fsZippedFile: state.fsZippedFile,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    setLocalfileStore: (file) => dispatch(localfileStore(file)),\n    toolStore: (tool) => dispatch(dcmTool(tool)),\n    isOpenStore: (value) => dispatch(dcmIsOpen(value)),\n    setActiveDcm: (dcm) => dispatch(activeDcm(dcm)),\n    setActiveDcmIndex: (index) => dispatch(activeDcmIndex(index)),\n    setActiveMeasurements: (measurements) => dispatch(activeMeasurements(measurements)),\n    setLayoutStore: (row, col) => dispatch(setLayout(row, col)),\n    setDicomdirStore: (dicomdir) => dispatch(setDicomdir(dicomdir)),\n    setFsZippedFile: (file) => dispatch(setZippedFile(file))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(App))\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import {createStore} from 'redux'\r\nimport storeReducer from '../reducers/index'\r\n\r\nlet initialState = {\r\n    localfile: null,\r\n    isOpen: new Array(16).fill(false),\r\n    tool: null,\r\n    activeDcmIndex: 0,\r\n    activeDcm: null,\r\n    images: [],\r\n    measurements: [],\r\n    layout: [1,1], // first element represents the rows, second the columns\r\n    dicomdir: null,\r\n    fsCurrentDir: '',\r\n    fsCurrentList: [],\r\n    fsZippedFile: null,\r\n    fsRefresh: false,\r\n    sandboxedFile: null,\r\n}\r\n\r\nconst store = createStore(storeReducer, initialState,\r\n    window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__())\r\n\r\nexport default store\r\n","import {\r\n  CLEAR_STORE, \r\n  LOCALFILE_STORE,\r\n  DCM_IS_OPEN, \r\n  DCM_TOOL, \r\n  ACTIVE_DCM_INDEX, \r\n  ACTIVE_DCM, \r\n  DCM_IMAGE,\r\n  ACTIVE_MEASUREMENTS,\r\n  LAYOUT,\r\n  DICOMDIR,\r\n  FSCURRENTDIR,\r\n  FSCURRENTLIST,\r\n  FSZIPPEDFILE,\r\n  FSREFRESH,\r\n  SANDBOXEDFILE_STORE,\r\n} from '../actions'\r\n\r\nexport default function storeReducer(state={}, action) {\r\n    //console.log('storeReducer: ', action)\r\n    switch(action.type) {\r\n      \r\n      case CLEAR_STORE:\r\n        return {\r\n          localfile: state.localfile,\r\n          isOpen: state.isOpen.map((el, i) => i === state.activeDcmIndex ? false : el),\r\n          tool: null,\r\n          activeDcmIndex: state.activeDcmIndex,\r\n          activeDcm: state.activeDcm,\r\n          images: [],\r\n          measurements: null,\r\n          layout: state.layout,\r\n          dicomdir: state.dicomdir, \r\n          fsCurrentDir: state.fsCurrentDir,\r\n          fsCurrentList: state.fsCurrentList,\r\n          fsZippedFile: null,\r\n          fsRefresh: state.fsRefresh,\r\n          sandboxedFile: state.sandboxedFile,\r\n        }    \r\n\r\n      case LOCALFILE_STORE:\r\n          return {\r\n            ...state,\r\n            localfile: action.localfile,     \r\n            sandboxedFile: null,   \r\n          } \r\n\r\n      case DCM_IS_OPEN:\r\n          return {\r\n            ...state,\r\n            isOpen: state.isOpen.map((el, i) => i === state.activeDcmIndex ? action.value : el),\r\n            images: [\r\n              ...state.images\r\n            ],            \r\n            measurements: state.measurements,\r\n            layout: state.layout,    \r\n            dicomdir: state.dicomdir,    \r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,            \r\n          }    \r\n\r\n      case DCM_TOOL:\r\n          return {\r\n            ...state,\r\n            tool: action.tool,\r\n            images: [\r\n              ...state.images\r\n            ],  \r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          }  \r\n\r\n      case ACTIVE_DCM_INDEX:\r\n          return {\r\n            ...state,\r\n            activeDcmIndex: action.activeDcmIndex,\r\n            images: [\r\n              ...state.images\r\n            ],  \r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          }  \r\n\r\n      case ACTIVE_DCM:\r\n          return {\r\n            ...state,\r\n            activeDcm: action.activeDcm,\r\n            images: [\r\n              ...state.images\r\n            ],  \r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          }            \r\n\r\n      case DCM_IMAGE:\r\n          return {\r\n            ...state,\r\n            images: [\r\n              ...state.images,\r\n              action.images,\r\n            ],  \r\n            measurements: state.measurements,\r\n            layout: state.layout,\r\n            dicomdir: state.dicomdir,\r\n            fsCurrentDir: state.fsCurrentDir,\r\n            fsCurrentList: state.fsCurrentList,  \r\n          } \r\n\r\n      case ACTIVE_MEASUREMENTS:\r\n        return {\r\n          ...state,\r\n          measurements: [...action.measurements],\r\n        }             \r\n\r\n      case LAYOUT:\r\n            return {\r\n              ...state,\r\n              images: [...state.images],\r\n              measurements: state.measurements,\r\n              layout: action.layout,\r\n              dicomdir: state.dicomdir,\r\n              fsCurrentDir: state.fsCurrentDir,\r\n              fsCurrentList: state.fsCurrentList,  \r\n            }  \r\n\r\n      case DICOMDIR:\r\n            return {\r\n              ...state,\r\n              dicomdir: action.dicomdir\r\n            }  \r\n\r\n      case FSCURRENTDIR:\r\n            return {\r\n              ...state,\r\n              fsCurrentDir: action.fsCurrentDir\r\n            }  \r\n\r\n      case FSCURRENTLIST:\r\n            return {\r\n              ...state,\r\n              fsCurrentList: [...action.fsCurrentList]\r\n            }  \r\n\r\n      case FSZIPPEDFILE:\r\n            return {\r\n              ...state,\r\n              fsZippedFile: action.fsZippedFile\r\n            }  \r\n\r\n      case FSREFRESH:\r\n            return {\r\n              ...state,\r\n              fsRefresh: !state.fsRefresh\r\n            }  \r\n\r\n      case SANDBOXEDFILE_STORE:\r\n        return {\r\n          ...state,\r\n          localfile: null,\r\n          sandboxedFile: action.sandboxedFile,        \r\n        } \r\n\r\n      default:\r\n          return state\r\n    }\r\n  }\r\n  ","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\nimport WebFontLoader from 'webfontloader'\nimport {Provider} from 'react-redux'\nimport store from './store'\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles'\n\nWebFontLoader.load({\n    google: {\n        families: ['Roboto:300,400,500,700', 'Material Icons'],\n    },\n})\n\n//store.subscribe(() => console.log('store updated:', store.getState()));\n\nconst theme = createMuiTheme({\n    overrides: {\n        MuiFormControlLabel: {\n            label: {\n                fontSize: '0.85em'\n            },\n        },\n        MuiFormLabel: {\n            root: { \n                '&$focused': {\n                    color:'#CCCCCC',\n                },   \n            }\n         \n        }\n    },\n    palette: {\n        primary: {\n            main: '#004d40',\n        },\n        secondary: {\n            main: '#888888',\n        },\n        type: 'dark',\n    },\n  })\n\n  \nReactDOM.render(\n    <Provider store={store}>\n        <MuiThemeProvider theme = { theme }>\n            <App />\n        </MuiThemeProvider>\n    </Provider>, \n    document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n "],"sourceRoot":""}